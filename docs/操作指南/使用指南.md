# StockWhisperer 使用指南

## 目录

1. [安装教程](#安装教程)
2. [配置说明](#配置说明)
3. [使用教程](#使用教程)
4. [API Key 获取指南](#api-key-获取指南)
5. [常见问题](#常见问题)
6. [最佳实践](#最佳实践)

## 安装教程

### 步骤1: 安装 Tampermonkey

Tampermonkey 是一个流行的用户脚本管理器，支持 Chrome、Firefox、Edge、Safari 等主流浏览器。

#### Chrome/Edge 用户

1. 访问 [Chrome Web Store](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
2. 点击 "添加至 Chrome" 按钮
3. 在弹出框中点击 "添加扩展程序"
4. 等待安装完成，浏览器工具栏会出现 Tampermonkey 图标

#### Firefox 用户

1. 访问 [Firefox 附加组件](https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/)
2. 点击 "添加到 Firefox" 按钮
3. 在弹出框中点击 "添加"
4. 等待安装完成

#### Safari 用户

1. 在 App Store 中搜索 "Tampermonkey"
2. 下载并安装
3. 在 Safari 设置中启用扩展

### 步骤2: 安装 StockWhisperer 脚本

#### 方法1: 手动安装（推荐）

1. 下载 `stockwhisperer.user.js` 文件
2. 点击浏览器工具栏的 Tampermonkey 图标
3. 选择 "管理面板"
4. 点击左侧的 "+" 号（新建脚本）
5. 删除编辑器中的默认内容
6. 将 `stockwhisperer.user.js` 的内容复制粘贴到编辑器
7. 按 `Ctrl+S`（Mac: `Cmd+S`）保存
8. 看到提示 "保存成功" 即完成安装

#### 方法2: 拖拽安装

1. 下载 `stockwhisperer.user.js` 文件到本地
2. 直接将文件拖拽到浏览器窗口
3. Tampermonkey 会弹出安装确认框
4. 点击 "安装" 按钮

### 步骤3: 验证安装

1. 访问 [东方财富](https://quote.eastmoney.com/)
2. 点击任意股票，例如：https://quote.eastmoney.com/SZ000001.html
3. 等待页面加载完成
4. 页面右侧应该会出现 "AI预测分析" 面板

## 配置说明

### 配置 API Key

首次使用时，需要配置 AI API 的 Key。

#### 1. 访问设置

- 方式1: 在 AI 预测面板中点击 "⚙️ 设置" 按钮
- 方式2: 如果没有配置 API Key，会自动弹出设置对话框

#### 2. 选择 API 提供商

**推荐：DeepSeek（高性价比）**

- 优点：中文理解强、价格便宜、响应快速
- 缺点：知名度相对较低
- 价格：约 ¥0.14/1M tokens
- 月均成本：¥2-4

**备选：OpenAI GPT-4**

- 优点：功能强大、生态完善
- 缺点：价格较贵、国内访问可能需要代理
- 价格：约 ¥18/1M tokens
- 月均成本：¥270-540

#### 3. 输入 API Key

将获取到的 API Key 粘贴到输入框中（详见 [API Key 获取指南](#api-key-获取指南)）

#### 4. 保存配置

点击 "保存" 按钮，配置会安全地保存在本地浏览器中。

## 使用教程

### 基本使用

1. **访问股票页面**

   访问东方财富任意股票详情页，例如：
   - https://quote.eastmoney.com/SZ000001.html（平安银行）
   - https://quote.eastmoney.com/SH600036.html（招商银行）

2. **等待分析完成**

   页面加载后，AI 会自动开始分析，通常需要 3-10 秒。

3. **查看预测结果**

   预测面板会显示以下信息：

   - **当前价格**: 股票的实时价格
   - **预测价格**: AI 预测的 1-3 天目标价格
   - **涨跌幅**: 预测的涨跌百分比
   - **置信区间**: 预测价格的可能波动范围
   - **走势原因分析**:
     - 📊 技术面：技术指标分析（MACD、RSI、均线等）
     - 📊 基本面：行业和公司分析
     - 📊 情绪面：市场情绪和资金流向分析
   - **投资建议**: 🟢 买入 / 🟡 持有 / 🔴 卖出
   - **置信度**: AI 对预测的可信程度（0-100%）

### 面板操作

#### 刷新预测

点击面板顶部的 "🔄 刷新" 按钮，可以重新运行 AI 分析。

**何时使用**：
- 股票价格发生较大变化
- 需要获取最新预测
- 之前的预测失败

#### 修改设置

点击 "⚙️ 设置" 按钮可以：
- 切换 API 提供商
- 更新 API Key

#### 关闭面板

点击 "×" 按钮关闭预测面板。如需重新显示，刷新页面即可。

### 理解预测结果

#### 趋势类型

- **📈 上涨 (UP)**: AI 认为股价大概率会上涨
- **📉 下跌 (DOWN)**: AI 认为股价大概率会下跌
- **➡️ 中性 (NEUTRAL)**: AI 认为股价会横盘整理

#### 投资建议

- **🟢 买入 (BUY)**: 建议考虑买入该股票
- **🟡 持有 (HOLD)**: 建议继续持有，观望
- **🔴 卖出 (SELL)**: 建议考虑卖出

#### 置信度

- **80-100%**: AI 非常确定
- **60-80%**: AI 比较确定（常见范围）
- **40-60%**: AI 不太确定
- **0-40%**: AI 非常不确定

⚠️ **注意**: 即使置信度很高，也不代表预测 100% 准确！

## API Key 获取指南

### DeepSeek API Key（推荐）

#### 步骤

1. **注册账号**

   访问 [DeepSeek 官网](https://www.deepseek.com/)
   - 点击右上角 "注册"
   - 使用手机号或邮箱注册
   - 完成实名认证（可能需要）

2. **获取 API Key**

   - 登录后，点击右上角头像
   - 选择 "API Keys"
   - 点击 "创建 API Key" 按钮
   - 输入名称（如：StockWhisperer）
   - 点击 "确认"
   - **立即复制 API Key**（只显示一次！）

3. **充值（可选）**

   - 新用户通常有免费额度
   - 免费用完后，需要充值才能继续使用
   - 充值金额：建议先充值 ¥10 测试

4. **配置到脚本**

   - 将复制的 API Key 粘贴到设置对话框
   - 点击保存

#### 费用说明

- 定价：¥0.14 / 1M tokens
- 单次预测：约 500-1000 tokens
- 100 次预测：约 ¥0.07-0.14
- **月均成本（每天100次）：¥2-4**

### OpenAI API Key

#### 步骤

1. **注册账号**

   访问 [OpenAI Platform](https://platform.openai.com/)
   - 点击 "Sign up"
   - 使用邮箱或 Google/Microsoft 账号注册
   - 验证手机号

2. **获取 API Key**

   - 登录后，点击左侧 "API keys"
   - 点击 "+ Create new secret key"
   - 输入名称（如：StockWhisperer）
   - 点击 "Create secret key"
   - **立即复制 API Key**（只显示一次！）

3. **充值**

   - OpenAI 采用预付费模式
   - 需要先充值才能使用
   - 最低充值金额：$5 USD

4. **配置到脚本**

   - 将复制的 API Key 粘贴到设置对话框
   - 点击保存

#### 费用说明

- 定价：约 $2.5 / 1M tokens（GPT-4）
- 单次预测：约 500-1000 tokens
- 100 次预测：约 $0.00125-0.0025
- **月均成本（每天100次）：$5-10（约 ¥35-70）**

⚠️ **注意**: 国内访问 OpenAI API 可能需要代理。

## 常见问题

### Q1: 脚本安装后没有反应？

**原因**：脚本未启用或页面不匹配

**解决方案**：

1. 检查 Tampermonkey 图标，确认脚本已启用（彩色）
2. 确认访问的是东方财富股票详情页（URL 格式：`quote.eastmoney.com/SZ000001.html`）
3. 刷新页面
4. 打开浏览器控制台（F12），查看是否有错误信息

### Q2: 提示 "无法获取股票数据"？

**原因**：数据提取失败

**解决方案**：

1. 确认页面完全加载（等待 2-3 秒）
2. 刷新页面重试
3. 检查 URL 是否正确（必须是股票详情页）
4. 尝试访问其他股票页面

### Q3: API 调用失败？

**原因**：API Key 无效或网络问题

**解决方案**：

1. 检查 API Key 是否正确
2. 确认 API 账户余额充足
3. 检查网络连接
4. 如果使用 OpenAI，确认能访问 OpenAI API（可能需要代理）
5. 尝试切换 API 提供商

### Q4: AI 分析很慢？

**原因**：API 响应慢

**正常情况**：

- DeepSeek：通常 3-10 秒
- OpenAI：通常 5-15 秒

**如果超过 30 秒**：

1. 检查网络连接
2. 刷新页面重试
3. 尝试切换 API 提供商

### Q5: 预测结果不合理？

**说明**：

- AI 预测基于历史数据和有限信息，不可能 100% 准确
- 当前版本使用基础 Prompt，未引入专业金融数据
- 股市受多种因素影响，AI 无法预测突发事件

**建议**：

- 仅作为参考，不要完全依赖
- 结合自己的判断
- 多次预测，观察趋势
- 关注置信度指标

### Q6: API 费用太高？

**优化建议**：

1. 使用 DeepSeek 而非 OpenAI（成本降低 99%）
2. 避免频繁刷新（预测结果缓存 5 分钟）
3. 只在需要时预测（不要每天预测几百次）

### Q7: 可以预测港股/美股吗？

**当前版本**：仅支持 A 股（深圳/上海）

**未来计划**：

- v1.2 版本计划支持港股
- v2.0 版本计划支持美股

### Q8: 数据安全吗？

**安全保障**：

- ✅ API Key 存储在本地浏览器，不上传服务器
- ✅ 所有数据处理在本地完成
- ✅ 仅股票代码和价格发送给 AI API
- ✅ 不收集任何用户个人信息

## 最佳实践

### 1. 合理使用 AI 预测

- ✅ 将 AI 预测作为辅助工具
- ✅ 结合自己的技术分析
- ✅ 关注置信度指标
- ❌ 不要完全依赖 AI 预测
- ❌ 不要忽视风险

### 2. 控制使用频率

- 建议：每天每只股票预测 1-2 次
- 避免频繁刷新（浪费 API 调用）
- 利用 5 分钟缓存机制

### 3. 多维度分析

- 查看 AI 的原因分析（技术面/基本面/情绪面）
- 结合 K 线图、成交量等技术指标
- 关注新闻和市场热点
- 考虑大盘走势

### 4. 风险管理

- 设置止损点
- 分散投资
- 不要投入超出风险承受能力的资金

### 5. 持续优化

- 关注版本更新
- 提供反馈帮助改进
- 尝试不同的 API 提供商

## 进阶使用

### 自定义 Prompt（高级用户）

脚本中的 Prompt 可以根据需要调整：

1. 打开 Tampermonkey 管理面板
2. 找到 `APIModule.generatePrompt` 函数
3. 修改 Prompt 内容
4. 保存并刷新页面测试

**注意**: 修改前请备份原始脚本！

### 查看原始数据

1. 打开浏览器控制台（F12）
2. 切换到 "Console" 标签
3. 查找 `[StockWhisperer]` 开头的日志
4. 可以看到股票数据和预测结果

### 调试问题

如果遇到问题：

1. 打开浏览器控制台（F12）
2. 查看 "Console" 中的错误信息
3. 截图并提交 Issue

## 版本历史

### v1.0.0 (2026-01-29)

- ✨ 首次发布
- ✅ 支持 A 股实时预测
- ✅ 集成 DeepSeek 和 OpenAI API
- ✅ 多维度分析（技术/基本面/情绪面）
- ✅ 现代化 UI 设计
- ✅ 本地配置管理

## 获取帮助

- 📖 查看 [README.md](./README.md)
- 🐛 提交 [GitHub Issue](https://github.com/your-repo/issues)
- 📧 联系作者: your-email@example.com

---

**祝投资顺利！** 📈

⚠️ **再次提醒**: AI 预测仅供参考，不构成投资建议。股市有风险，投资需谨慎！
