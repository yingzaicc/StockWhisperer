Index: README.md
===================================================================
diff --git a/README.md b/README.md
deleted file mode 100644
--- a/README.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,320 +0,0 @@
-# StockWhisperer (股语者)
-
-🤖 AI驱动的股票走势预测工具 - 倾听股市，洞见未来
-
-![Version](https://img.shields.io/badge/version-1.0.2-blue)
-![License](https://img.shields.io/badge/license-MIT-green)
-
-## ⚠️ 当前版本状态 (v1.0.2)
-
-**最新更新**: 2026-01-30
-
-### ✅ 已修复
-- ✅ 数据确认界面 - 用户可验证数据后再调用AI
-- ✅ 可调整大小侧边栏 - 拖动调整面板宽度
-- ✅ 个股价格提取 - 支持科创板(688981)等
-- ✅ 涨跌幅提取 - 正确提取-4.78%等涨跌幅
-
-### ⚠️ 已知问题
-- ⚠️ **成交量提取暂未修复** - 显示为0,不影响主要功能
-- ⚠️ 部分A股可能需要调整选择器
-
-### 📚 文档索引
-- [使用指南](./docs/使用指南.md) - 详细使用说明
-- [调试指南](./docs/调试指南.md) - 问题排查
-- [开发日志](./docs/开发日志.md) - 版本更新记录
-- [需求分析](./docs/需求分析与功能点.md) - 功能设计
-- [技术方案](./docs/技术方案对比分析_v2.0.md) - 技术选型
-
----
-
-## 项目简介
-
-StockWhisperer 是一个基于 AI 大语言模型的股票预测助手，通过油猴脚本(tampermonkey userscript)的方式在东方财富网页上实时展示 AI 预测分析和投资建议。
-
-### 核心特点
-
-- ⚡ **即插即用**: 单文件油猴脚本，安装即可使用
-- 🤖 **AI 驱动**: 使用 DeepSeek/GPT-4 等大模型进行智能分析
-- 📊 **多维分析**: 技术面 + 基本面 + 情绪面综合分析
-- 💰 **成本低廉**: 按 API 调用付费，月均 50-200 元
-- 🎨 **界面精美**: 现代化 UI 设计，响应式布局
-- 🔒 **数据安全**: API Key 本地存储，不上传服务器
-
-### 功能展示
-
-- ✅ 实时股票数据提取
-- ✅ AI 走势预测（1-3天）
-- ✅ 投资建议（买入/持有/卖出）
-- ✅ 原因分析（技术/基本面/情绪面）
-- ✅ 置信度评估
-- ✅ 自选股管理
-- ✅ 预测结果缓存
-
-## 快速开始
-
-### 1. 安装浏览器插件
-
-首先需要安装 Tampermonkey 浏览器扩展：
-
-- **Chrome/Edge**: [Chrome 商店链接](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
-- **Firefox**: [Firefox 附加组件](https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/)
-- **Safari**: [App Store](https://apps.apple.com/us/app/tampermonkey/id1482490089)
-
-### 2. 安装油猴脚本
-
-有两种安装方式：
-
-#### 方式1: 从文件安装（推荐）
-
-1. 下载 [`stockwhisperer.user.js`](./stockwhisperer.user.js) 文件
-2. 点击 Tampermonkey 图标 → "管理面板"
-3. 点击 "+" 号创建新脚本
-4. 将下载的文件内容复制粘贴到编辑器
-5. 按 `Ctrl+S` 保存
-
-#### 方式2: 自动安装（需要托管）
-
-点击以下链接（需先安装 Tampermonkey）：
-```
-(即将上线)
-```
-
-### 3. 配置 API Key
-
-1. 访问 [东方财富](https://quote.eastmoney.com/) 任意股票页面
-2. 页面右侧会自动弹出 "AI预测分析" 面板
-3. 点击面板上的 "⚙️ 设置" 按钮
-4. 选择 API 提供商并输入 API Key
-
-#### 获取 API Key
-
-**推荐使用 DeepSeek（高性价比）**:
-
-1. 访问 [DeepSeek 官网](https://www.deepseek.com/)
-2. 注册/登录账号
-3. 进入 "API Keys" 页面
-4. 创建新的 API Key
-5. 复制 Key 并粘贴到设置对话框
-
-**或使用 OpenAI GPT-4**:
-
-1. 访问 [OpenAI Platform](https://platform.openai.com/)
-2. 注册/登录账号
-3. 进入 "API keys" 页面
-4. 创建新的 API Key
-5. 复制 Key 并粘贴到设置对话框
-
-### 4. 开始使用
-
-配置完成后，刷新页面，AI 会自动分析当前股票并展示预测结果！
-
-## 使用说明
-
-### 基本使用
-
-1. 访问东方财富股票详情页，例如：
-   - **A股**: https://quote.eastmoney.com/SZ000001.html（平安银行）
-   - **A股**: https://quote.eastmoney.com/SH600000.html（浦发银行）
-   - **科创板**: https://quote.eastmoney.com/kcb/688981.html
-   - **港股**: https://quote.eastmoney.com/hk/00981.html
-
-2. 页面右侧会自动显示 AI 预测面板
-
-3. 面板包含以下信息：
-   - **当前价格**: 股票实时价格
-   - **预测价格**: AI 预测的1-3天目标价格
-   - **置信区间**: 预测价格的可能范围
-   - **走势原因分析**:
-     - 技术面分析（MACD、RSI、均线等）
-     - 基本面分析（行业、公司业绩等）
-     - 情绪面分析（市场情绪、资金流向等）
-   - **投资建议**: 买入/持有/卖出
-   - **置信度**: 预测的可信度（0-100%）
-
-### 面板操作
-
-- **🔄 刷新**: 重新运行 AI 分析
-- **⚙️ 设置**: 修改 API 配置
-- **× 关闭**: 关闭预测面板
-
-### 自选股管理
-
-（即将推出）
-
-## 成本估算
-
-### API 调用成本
-
-#### DeepSeek（推荐）
-
-- 定价：约 ¥0.14 / 1M tokens
-- 单次预测：约 500-1000 tokens
-- 每天预测100次：约 ¥0.07-0.14/天
-- **月均成本：¥2-4** ⭐
-
-#### OpenAI GPT-4
-
-- 定价：约 ¥18 / 1M tokens
-- 单次预测：约 500-1000 tokens
-- 每天预测100次：约 ¥9-18/天
-- **月均成本：¥270-540**
-
-**结论**: 推荐使用 DeepSeek，成本极低且中文理解能力强。
-
-## 架构设计
-
-### 技术栈
-
-- **前端**: JavaScript ES6+ + Tampermonkey API
-- **AI**: DeepSeek API / OpenAI API
-- **数据源**: 东方财富网页 DOM 提取
-- **存储**: 本地浏览器存储（GM_setValue/GM_getValue）
-
-### 模块结构
-
-```
-stockwhisperer.user.js
-├── 常量配置 (CONFIG)
-├── 工具函数模块 (Utils)
-├── 错误处理模块 (ErrorHandler)
-├── 本地存储模块 (StorageModule)
-├── API调用模块 (APIModule)
-├── UI渲染模块 (UIModule)
-├── 数据提取模块 (DataExtractor)
-└── 业务逻辑层 (App)
-```
-
-### 数据流
-
-```
-用户访问股票页面
-    ↓
-页面检测与数据提取
-    ↓
-调用 LLM API 分析
-    ↓
-解析预测结果
-    ↓
-渲染 UI 面板
-```
-
-## 常见问题
-
-### Q1: 脚本无法运行？
-
-**解决方案**:
-
-1. 确认已安装 Tampermonkey 扩展
-2. 确认脚本已启用（Tampermonkey 管理面板中查看）
-3. 刷新页面
-4. 检查浏览器控制台是否有错误信息
-
-### Q2: 提示 "无法获取股票数据"？
-
-**解决方案**:
-
-1. 确认访问的是东方财富股票详情页（URL 格式：`quote.eastmoney.com/SZ000001.html`）
-2. 等待页面完全加载后再查看
-3. 刷新页面重试
-
-### Q3: API 调用失败？
-
-**解决方案**:
-
-1. 检查 API Key 是否正确
-2. 检查网络连接
-3. 确认 API 账户余额充足
-4. 尝试切换 API 提供商
-
-### Q4: 预测结果准确吗？
-
-**重要提示**:
-
-- ⚠️ AI 预测仅供参考，不构成投资建议
-- 股市有风险，投资需谨慎
-- AI 预测并非 100% 准确
-- 建议结合自己的判断和其他分析工具
-
-### Q5: 如何提高预测准确率？
-
-当前版本使用基础 Prompt，后续会持续优化：
-
-- 增加更多历史数据
-- 优化 Prompt 工程
-- 引入新闻情感分析
-- 结合技术指标计算
-
-## 开发路线
-
-### ✅ 已完成（v1.0）
-
-- [x] 基础油猴脚本框架
-- [x] 数据提取模块
-- [x] UI 渲染模块
-- [x] LLM API 集成
-- [x] 配置管理
-- [x] 错误处理
-
-### 🚀 即将推出（v1.1）
-
-- [ ] 自选股管理功能
-- [ ] 历史预测记录
-- [ ] 准确率统计
-- [ ] 新闻情感分析
-- [ ] 批量分析功能
-
-### 📋 规划中（v2.0）
-
-- [ ] Chrome 插件版本
-- [ ] 本地 Python 后端支持
-- [ ] 更多数据源
-- [ ] 技术指标自动计算
-- [ ] 移动端适配
-
-## 免责声明
-
-⚠️ **重要提示**:
-
-1. 本工具提供的预测仅供参考，不构成任何投资建议
-2. 股市有风险，投资需谨慎
-3. AI 预测并非 100% 准确，请理性对待
-4. 任何投资决策请基于自己的判断
-5. 使用本工具即表示您同意自行承担投资风险
-
-开发团队不对任何投资损失负责。
-
-## 贡献指南
-
-欢迎提交 Issue 和 Pull Request！
-
-### 开发环境
-
-无需任何开发环境，直接编辑 `stockwhisperer.user.js` 文件即可。
-
-### 测试
-
-1. 修改脚本文件
-2. 在 Tampermonkey 中更新脚本
-3. 刷新测试页面查看效果
-
-## 许可证
-
-MIT License
-
-## 联系方式
-
-- GitHub Issues: [提交问题](https://github.com/your-repo/issues)
-- Email: your-email@example.com
-
-## 鸣谢
-
-- [DeepSeek](https://www.deepseek.com/) - 提供高性价比的 AI API
-- [Tampermonkey](https://www.tampermonkey.net/) - 强大的油猴脚本管理器
-- [东方财富](https://www.eastmoney.com/) - 股票数据来源
-
----
-
-**Star ⭐ if you like this project!**
-
-🤖 **StockWhisperer** - 倾听股市，洞见未来
Index: docs/文档整理计划.md
===================================================================
diff --git a/docs/文档整理计划.md b/docs/文档整理计划.md
deleted file mode 100644
--- a/docs/文档整理计划.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,141 +0,0 @@
-# 文档整理计划
-
-**日期**: 2026-01-30
-**目的**: 合并冗余文档,优化文档结构
-
----
-
-## 当前文档列表
-
-### 核心设计文档 (保留)
-1. ✅ `初始需求.md` (5行) - 保留
-2. ✅ `需求分析与功能点.md` (418行) - 保留
-3. ✅ `技术方案对比分析_v2.0.md` (1106行) - 保留
-4. ✅ `油猴脚本方案架构设计_v1.0.md` (2125行) - 保留
-5. ✅ `项目命名方案_v1.0.md` (231行) - 保留
-
-### 操作指南文档 (保留并更新)
-6. ✅ `使用指南.md` (428行) - 保留并更新
-7. ✅ `调试指南.md` (379行) - 保留并更新
-
-### 历史/冗余文档 (需要整理)
-8. ❌ `Bug修复报告_v1.0.1.md` (313行) - **合并到开发日志**
-9. ❌ `紧急修复指南.md` (225行) - **合并到调试指南**
-10. ❌ `功能优化说明_v1.0.2.md` (460行) - **合并到开发日志**
-11. ❌ `数据提取优化说明_v1.0.2.md` (240行) - **合并到开发日志**
-
----
-
-## 整理方案
-
-### 方案1: 创建合并文档
-
-#### 新文档: `开发日志.md`
-合并以下文档的内容:
-- `Bug修复报告_v1.0.1.md`
-- `功能优化说明_v1.0.2.md`
-- `数据提取优化说明_v1.0.2.md`
-
-**结构**:
-```markdown
-# 开发日志
-
-## v1.0.2 (2026-01-30)
-### 功能优化
-- [数据提取优化内容]
-- [功能优化内容]
-
-### Bug修复
-- [Bug修复报告内容]
-```
-
-#### 更新: `调试指南.md`
-合并 `紧急修复指南.md` 的内容
-
-**新增章节**:
-```markdown
-## 紧急问题修复流程
-1. 问题诊断
-2. 临时解决方案
-3. 根本原因分析
-4. 永久修复方案
-```
-
-### 方案2: 删除冗余文档
-
-删除以下文档(内容已合并):
-- `Bug修复报告_v1.0.1.md`
-- `紧急修复指南.md`
-- `功能优化说明_v1.0.2.md`
-- `数据提取优化说明_v1.0.2.md`
-
-### 方案3: 更新主文档
-
-#### 更新 `README.md`
-添加:
-- 当前版本信息
-- 已知问题列表
-- 快速开始指南
-- 文档索引
-
-#### 更新 `CLAUDE.md`
-添加:
-- 当前数据提取策略说明
-- 已知问题(成交量提取)
-- 调试技巧
-
----
-
-## 最终文档结构
-
-```
-StockWhisperer/
-├── README.md                          # 主文档(项目介绍、快速开始)
-├── CLAUDE.md                          # Claude开发指南
-├── stockwhisperer.user.js            # 主脚本
-│
-└── docs/
-    ├── 核心设计文档/
-    │   ├── 初始需求.md
-    │   ├── 需求分析与功能点.md
-    │   ├── 技术方案对比分析_v2.0.md
-    │   ├── 油猴脚本方案架构设计_v1.0.md
-    │   └── 项目命名方案_v1.0.md
-    │
-    ├── 操作指南/
-    │   ├── 使用指南.md
-    │   └── 调试指南.md
-    │
-    └── 开发日志.md                    # 新建:合并所有历史更新
-```
-
----
-
-## 执行步骤
-
-1. ✅ 创建 `开发日志.md`,合并3个优化/修复文档
-2. ✅ 更新 `调试指南.md`,合并 `紧急修复指南.md`
-3. ✅ 更新 `README.md`,添加已知问题和文档索引
-4. ✅ 更新 `CLAUDE.md`,添加当前状态和已知问题
-5. ✅ 删除4个冗余文档
-6. ✅ 清理脚本文件(debug/test)
-
----
-
-## 注意事项
-
-- ⚠️ 删除前确保内容已完整合并
-- ⚠️ 保留历史版本的git记录
-- ⚠️ 更新文档间的交叉引用
-- ⚠️ 更新主README中的文档链接
-
----
-
-## 执行状态
-
-- [ ] 创建 `开发日志.md`
-- [ ] 更新 `调试指南.md`
-- [ ] 更新 `README.md`
-- [ ] 更新 `CLAUDE.md`
-- [ ] 删除冗余文档
-- [ ] 验证文档完整性
Index: docs/开发日志.md
===================================================================
diff --git a/docs/开发日志.md b/docs/开发日志.md
deleted file mode 100644
--- a/docs/开发日志.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,198 +0,0 @@
-# 开发日志
-
-记录 StockWhisperer 的开发历程、版本更新和重要变更。
-
----
-
-## v1.0.2 (2026-01-30)
-
-### 📊 数据提取重构
-
-#### 问题
-- 价格提取错误,经常获取到大盘指数价格(4157.98)而非个股价格(122.40)
-- 多策略回退机制导致逻辑复杂,难以维护
-- 数据准确性要求高,宁可报错也不能返回错误数据
-
-#### 解决方案
-
-**1. 精确定位策略**
-```
-科创板 (688981):
-  容器: .zs_brief 或 .zsquote3l
-  ├─ 当前价格: .price_down / .price_up
-  ├─ 涨跌幅: .zd
-  └─ 成交量: .price_draw.blinkgreen
-```
-
-**2. 严格验证机制**
-- 找不到元素 → 抛出错误
-- 价格格式不正确 → 抛出错误
-- 价格 <= 0 → 抛出错误
-- 价格 >= 1000 且是整数 → 抛出错误(疑似大盘指数)
-
-**3. 简化代码结构**
-- 移除5个策略的多层回退逻辑
-- 使用单一可靠的容器定位策略
-- 每个市场类型使用专门的提取逻辑
-
-#### 已知问题
-- ⚠️ 成交量提取仍有问题(暂停修复)
-
----
-
-## v1.0.2 (2026-01-29)
-
-### ✨ 功能优化
-
-#### 1. 数据确认界面
-
-**新增工作流程**:
-```
-页面加载 → 提取数据 → 【显示确认界面】 → 用户确认 → AI预测
-```
-
-**新增功能**:
-- 数据确认界面,显示提取的完整股票数据
-- 用户验证后才调用AI API
-- 避免错误数据浪费API调用
-
-**技术实现**:
-- 新增 `showDataConfirmation()` 函数
-- 新增 `stockwhisperer-data-confirmed` 事件
-- 数据提取与AI预测解耦
-
-#### 2. 可调整大小侧边栏
-
-**功能**:
-- 拖动左侧边缘调整面板宽度(300px-800px)
-- 使用 `GM_setValue` 持久化保存用户设置
-- 下次访问自动恢复上次宽度
-
-**实现细节**:
-- 添加 `.resize-handle` 调整手柄
-- 监听 `mousedown`/`mousemove`/`mouseup` 事件
-- 实时更新 `panel.style.width`
-
-#### 3. 最小化功能
-
-**功能**:
-- 点击最小化按钮 `-` 收缩面板
-- 只显示标题栏,节省屏幕空间
-- 点击 `+` 恢复完整面板
-
----
-
-## v1.0.1 (2026-01-29)
-
-### 🐛 Bug修复
-
-#### Bug #1: 科创板术语错误
-
-**问题**: `kcb` 被误标注为"可转债"
-
-**修复**:
-- 修改为"科创板"(STAR Market)
-- 更新所有相关注释和文档
-- 类型标识从 `'bond'` 改为 `'kcb_stock'`
-
-#### Bug #2: 价格提取错误
-
-**问题**: 提取到大盘指数价格而非个股价格
-
-**原因**: 价格验证逻辑不正确:
-```javascript
-// 错误的逻辑
-if (price < 1000 || price % 1 !== 0) {
-    return price;  // 4157.98 % 1 !== 0,会被接受
-}
-```
-
-**修复**: 使用3类价格分类系统:
-```javascript
-if (price < 1000) {
-    // 肯定是个股
-} else if (price % 1 !== 0) {
-    // 高价股（有小数）
-} else {
-    // 大盘指数（整数）→ 跳过
-}
-```
-
-#### Bug #3: 策略3提取错误
-
-**问题**: 查找包含股票代码的父容器策略容易提取错误价格
-
-**修复**: 禁用策略3,使用更可靠的容器定位策略
-
----
-
-## 技术决策记录
-
-### 为什么移除多策略回退?
-
-**之前**: 5个策略依次尝试,找到就返回
-- 问题: 无法保证数据准确性
-- 问题: 第一个策略可能返回错误数据
-- 问题: 调试困难
-
-**现在**: 单一可靠策略 + 严格验证
-- 优势: 数据准确性高
-- 优势: 找不到就报错,不会返回错误数据
-- 优势: 代码简单易维护
-
-### 为什么添加数据确认界面?
-
-**原因**:
-1. 数据准确性要求高
-2. 避免浪费API调用
-3. 用户可以验证提取的数据
-
-**效果**:
-- 用户满意度提升
-- API成本降低
-- 调试更容易
-
----
-
-## 开发规范
-
-### 代码规范
-
-1. **数据提取**: 宁可报错,不错返回
-2. **错误处理**: 抛出明确的错误信息
-3. **日志记录**: 每个步骤都有清晰日志
-4. **验证机制**: 严格的数据验证
-
-### Git提交规范
-
-```
-feat: 新功能
-fix: Bug修复
-refactor: 重构
-docs: 文档更新
-perf: 性能优化
-```
-
----
-
-## 下一步计划
-
-### 短期 (v1.0.3)
-- [ ] 修复成交量提取问题
-- [ ] 支持更多市场类型
-- [ ] 优化错误提示信息
-
-### 中期 (v1.1)
-- [ ] 增加历史准确率统计
-- [ ] 支持自定义主题
-- [ ] 批量分析功能
-
-### 长期 (v2.0)
-- [ ] 升级为Chrome插件
-- [ ] 开发独立Web应用
-- [ ] 支持多市场
-
----
-
-**维护者**: StockWhisperer Team
-**最后更新**: 2026-01-30
Index: docs/操作指南/调试指南.md
===================================================================
diff --git a/docs/操作指南/调试指南.md b/docs/操作指南/调试指南.md
deleted file mode 100644
--- a/docs/操作指南/调试指南.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,604 +0,0 @@
-# StockWhisperer 调试指南
-
-**版本**: v1.0.1
-**更新日期**: 2026-01-29
-
----
-
-## 🔧 问题诊断流程
-
-### 步骤1: 检查脚本是否加载
-
-打开浏览器控制台（按 `F12`），切换到 `Console` 标签，刷新页面。
-
-**预期看到**:
-```
-[StockWhisperer] 开始启动脚本...
-[StockWhisperer] 当前页面URL: https://quote.eastmoney.com/SZ000001.html
-[StockWhisperer] 页面状态: complete
-[StockWhisperer] StockWhisperer v1.0.1 - 倾听股市，洞见未来
-```
-
-**如果看不到以上日志**:
-- ❌ 脚本未加载
-- 检查 Tampermonkey 是否启用
-- 检查脚本是否已安装并启用
-- 检查 `@match` 规则是否匹配当前 URL
-
----
-
-### 步骤2: 检查页面类型检测
-
-继续查看控制台日志：
-
-**预期看到**:
-```
-[StockWhisperer] ==================== 脚本初始化开始 ====================
-[StockWhisperer] 脚本已加载
-[StockWhisperer] Tampermonkey API 可用: true
-[StockWhisperer] 当前URL: https://quote.eastmoney.com/SZ000001.html
-[StockWhisperer] 检测到股票详情页
-[StockWhisperer] 确认为股票详情页，继续执行
-```
-
-**如果看到 "非股票详情页，跳过"**:
-- ❌ 页面类型检测失败
-- 原因：URL 格式不匹配
-- 解决方案：见下面的 "常见问题" 部分
-
----
-
-### 步骤3: 检查 API 配置
-
-继续查看控制台：
-
-**预期看到**:
-```
-[StockWhisperer] API提供商: deepseek
-[StockWhisperer] API配置存在: true
-[StockWhisperer] API Key存在: true
-```
-
-**如果看到 "API Key存在: false"**:
-- ⚠️ 未配置 API Key
-- 页面右上角会弹出 AI 预测面板
-- 面板中会显示错误："请先配置API Key才能使用AI预测功能"
-- 点击面板的 "⚙️ 设置" 按钮配置 API Key
-
----
-
-### 步骤4: 检查数据提取
-
-**预期看到**:
-```
-[StockWhisperer] 提取股票数据...
-[DataExtractor] 提取的数据: {
-    code: "000001",
-    name: "平安银行",
-    market: "SZ",
-    currentPrice: 15.23,
-    changePercent: 1.19,
-    volume: 1234567,
-    timestamp: 1706500000000
-}
-[StockWhisperer] 股票数据: {...}
-```
-
-**如果 currentPrice 为 0**:
-- ❌ 数据提取失败
-- 检查 DOM 选择器是否匹配页面结构
-- 见下面的 "数据提取调试" 部分
-
----
-
-### 步骤5: 检查 AI 预测
-
-**预期看到**:
-```
-[StockWhisperer] 开始AI预测...
-[StockWhisperer] 预测结果: {
-    predictPrice: 15.68,
-    changePercent: 3.0,
-    trend: "UP",
-    suggestion: "BUY",
-    confidence: 75,
-    ...
-}
-[StockWhisperer] 预测结果: {...}
-```
-
-**如果看到 API 调用错误**:
-- ❌ API 调用失败
-- 检查 API Key 是否有效
-- 检查网络连接
-- 检查 API 余额是否充足
-
----
-
-## 🐛 常见问题诊断
-
-### 问题1: 脚本完全不运行
-
-**症状**: 控制台没有任何 `[StockWhisperer]` 日志
-
-**诊断步骤**:
-
-1. **检查 Tampermonkey**
-   - 打开 Tampermonkey 管理面板
-   - 确认脚本在列表中
-   - 确认脚本旁边的开关是打开的（彩色）
-
-2. **检查 URL 匹配**
-   - 脚本头部有 `@match` 规则：
-     ```javascript
-     // @match        https://quote.eastmoney.com/*
-     // @match        https://emweb.eastmoney.com/*
-     ```
-   - 当前 URL 必须匹配这些规则
-   - 测试 URL：`https://quote.eastmoney.com/SZ000001.html`
-
-3. **重新安装脚本**
-   - 删除旧脚本
-   - 重新粘贴代码
-   - 保存
-
----
-
-### 问题2: 页面类型检测失败
-
-**症状**: 控制台显示 "非股票详情页，跳过" 或 "未知页面类型"
-
-**原因**: URL 格式不匹配
-
-**诊断步骤**:
-
-1. **查看当前 URL**
-   ```
-   [StockWhisperer] 当前URL: https://quote.eastmoney.com/SZ000001.html
-   ```
-
-2. **验证 URL 格式**
-   - 正确格式：`quote.eastmoney.com/SZ000001.html`
-   - 正确格式：`quote.eastmoney.com/SH600000.html`
-   - 错误格式：`quote.eastmoney.com/sz000001` (小写)
-   - 错误格式：`quote.eastmoney.com/` (首页)
-
-3. **测试其他股票**
-   - 尝试访问：
-     - https://quote.eastmoney.com/SZ000001.html (平安银行)
-     - https://quote.eastmoney.com/SH600000.html (浦发银行)
-     - https://quote.eastmoney.com/SZ000002.html (万科A)
-
----
-
-### 问题3: 数据提取失败
-
-**症状**: `currentPrice` 为 0，或看到错误 "无法获取股票数据"
-
-**诊断步骤**:
-
-1. **查看提取的数据**
-   ```
-   [DataExtractor] 提取的数据: {
-       code: "000001",
-       name: "平安银行",
-       currentPrice: 0,  // ← 这里是0
-       ...
-   }
-   ```
-
-2. **检查页面 DOM**
-   - 打开控制台
-   - 切换到 `Elements` 标签
-   - 搜索价格相关的元素：
-     - 使用 `Ctrl+F` 搜索 "price"
-     - 查看实际的类名和 ID
-
-3. **手动提取测试**
-   - 在控制台运行：
-     ```javascript
-     // 测试价格选择器
-     document.querySelectorAll('[class*="price"]')
-     document.querySelector('.current-price')
-
-     // 测试名称选择器
-     document.querySelector('h1').textContent
-     document.title
-     ```
-
-4. **报告问题**
-   - 截图 DOM 结构
-   - 记录实际页面的 URL
-   - 提交 Issue
-
----
-
-### 问题4: API 调用失败
-
-**症状**: 看到 "API调用失败" 或 "请求超时"
-
-**诊断步骤**:
-
-1. **检查 API Key**
-   - 打开设置对话框
-   - 确认 API Key 已填写
-   - 尝试重新输入
-
-2. **测试 API**
-   - 使用 curl 测试（替换 YOUR_API_KEY）：
-     ```bash
-     curl https://api.deepseek.com/v1/chat/completions \
-       -H "Authorization: Bearer YOUR_API_KEY" \
-       -H "Content-Type: application/json" \
-       -d '{
-         "model": "deepseek-chat",
-         "messages": [{"role": "user", "content": "Hello"}]
-       }'
-     ```
-
-3. **检查网络**
-   - 打开控制台 `Network` 标签
-   - 刷新页面
-   - 查找对 `api.deepseek.com` 的请求
-   - 查看请求状态码和响应
-
-4. **检查余额**
-   - 登录 DeepSeek 控制台
-   - 查看账户余额
-   - 查看使用记录
-
----
-
-### 问题5: 面板不显示
-
-**症状**: 脚本运行正常，但没有看到预测面板
-
-**诊断步骤**:
-
-1. **检查面板元素**
-   - 在控制台运行：
-     ```javascript
-     document.getElementById('stockwhisperer-panel')
-     ```
-
-2. **检查 z-index**
-   - 面板可能被其他元素覆盖
-   - 在控制台运行：
-     ```javascript
-     const panel = document.getElementById('stockwhisperer-panel');
-     if (panel) {
-         panel.style.zIndex = '99999';
-         panel.style.display = 'block';
-     }
-     ```
-
-3. **检查面板位置**
-   - 面板应该在页面右侧
-   - 如果屏幕太小，可能被挤出视口
-   - 滚动页面或调整窗口大小
-
----
-
-## 🔍 高级调试技巧
-
-### 1. 手动触发初始化
-
-在控制台运行：
-```javascript
-App.init();
-```
-
-### 2. 手动触发数据提取
-
-```javascript
-DataExtractor.smartExtractStockData().then(data => {
-    console.log('提取的数据:', data);
-});
-```
-
-### 3. 手动触发 UI 渲染
-
-```javascript
-UIModule.createPredictionPanel();
-UIModule.showPredictionResult(
-    { code: '000001', name: '平安银行', currentPrice: 15.23 },
-    {
-        predictPrice: 15.68,
-        changePercent: 3.0,
-        trend: 'UP',
-        suggestion: 'BUY',
-        confidence: 75,
-        reason: {
-            technical: '测试技术面',
-            fundamental: '测试基本面',
-            sentiment: '测试情绪面'
-        }
-    }
-);
-```
-
-### 4. 查看存储的数据
-
-```javascript
-// 查看 API 配置
-GM_getValue('api_configs');
-GM_getValue('current_provider');
-
-// 清除所有数据（重置脚本）
-GM_deleteValue('api_configs');
-GM_deleteValue('current_provider');
-// 然后刷新页面
-```
-
-### 5. 启用详细日志
-
-在脚本开头添加：
-```javascript
-localStorage.setItem('stockwhisperer_debug', 'true');
-```
-
----
-
-## 📋 调试检查清单
-
-使用此清单逐项检查：
-
-- [ ] Tampermonkey 已安装
-- [ ] 脚本已添加到 Tampermonkey
-- [ ] 脚本已启用（开关是彩色的）
-- [ ] 访问的是正确的 URL 格式
-- [ ] 控制台显示 `[StockWhisperer]` 日志
-- [ ] 检测到股票详情页
-- [ ] API Key 已配置
-- [ ] 数据提取成功（currentPrice > 0）
-- [ ] API 调用成功
-- [ ] 预测面板显示在页面上
-
----
-
-## 🆘 获取帮助
-
-如果以上步骤都无法解决问题：
-
-1. **收集调试信息**
-   - 截图控制台日志
-   - 记录访问的 URL
-   - 记录浏览器版本
-
-2. **创建 Issue**
-   - GitHub: [提交问题](https://github.com/your-repo/issues)
-   - 描述问题
-   - 附上截图和日志
-
-3. **联系开发者**
-   - Email: your-email@example.com
-   - 提供详细的复现步骤
-
----
-
-**调试愉快！** 🔧
-# 🔧 脚本未执行问题 - 紧急修复指南
-
-## 问题诊断
-
-根据你的反馈：
-- ✅ URL 匹配成功
-- ❌ 控制台没有 `[StockWhisperer]` 日志
-- 🖥️ 使用的是 **Tauri 应用程序**（从 `file://blob:http://tauri.localhost/` 判断）
-
-**核心问题**: 脚本完全没有执行！
-
----
-
-## 🎯 立即测试方案
-
-### 方案1: 使用测试版脚本（最简单）
-
-我创建了一个超简单的测试脚本，**会显示明显的红色横幅**。
-
-**操作步骤**:
-
-1. 打开 Tampermonkey 管理面板
-2. 点击 "+" 创建新脚本
-3. 删除所有内容
-4. 复制以下文件内容：
-   - 文件名：`stockwhisperer-test.user.js`
-   - 位置：E:\project\golang\private\StockWhisperer\stockwhisperer-test.user.js
-5. 保存
-6. 刷新股票页面
-
-**预期结果**:
-- ✅ 页面顶部出现红色横幅："✅ StockWhisperer 脚本正在运行！"
-- ✅ 页面标题临时改为："🤖 ✅ StockWhisperer 脚本已加载！"
-- ✅ 弹出 alert 对话框
-- ✅ 控制台显示日志
-
----
-
-### 方案2: 检查当前安装
-
-**在控制台运行以下代码**:
-
-```javascript
-// 检查是否有其他脚本冲突
-console.log('页面上的脚本:', document.scripts.length);
-console.log('Tampermonkey:', typeof GM_xmlhttpRequest);
-console.log('当前URL:', window.location.href);
-
-// 检查是否在iframe中
-console.log('在iframe中:', window !== window.top);
-console.log('iframe URL:', window.location.href);
-
-// 检查是否有CSP限制
-const metaCSP = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
-console.log('CSP策略:', metaCSP ? metaCSP.getAttribute('content') : '无');
-```
-
----
-
-### 方案3: 环境问题排查
-
-根据你的 Tauri 环境，可能的问题：
-
-#### 问题 A: Tauri 不支持 Tampermonkey
-
-**解决方案**: 使用普通浏览器测试
-
-1. **Chrome/Edge**
-   - 直接访问：https://quote.eastmoney.com/SZ000001.html
-   - 不是通过 Tauri 应用
-
-2. **Firefox**
-   - 访问相同 URL
-
-3. **验证脚本在普通浏览器中工作**
-
-#### 问题 B: 脚本安装不完整
-
-**解决步骤**:
-
-1. 打开 Tampermonkey 管理面板
-2. 删除所有 StockWhisperer 相关脚本
-3. 重新创建脚本
-4. **确保复制了完整的文件内容**：
-   ```javascript
-   // ==UserScript==
-   // @name         ...
-   // ...所有内容...
-   // ==/UserScript==
-
-   (function() {
-       'use strict';
-       // ...代码...
-   })();
-   ```
-5. 检查最后是否有 `})();`
-
-#### 问题 C: @match 规则问题
-
-当前规则：
-```javascript
-// @match        https://quote.eastmoney.com/*
-// @match        https://emweb.eastmoney.com/*
-```
-
-**测试**: 在控制台运行
-```javascript
-/https:\/\/quote\.eastmoney\.com\/.*/.test(window.location.href)
-```
-
-如果返回 `false`，说明 URL 不匹配。
-
----
-
-## 🚀 最可能的解决方案
-
-### 原因分析
-
-从你的截图看，URL 是 `file://blob:http://tauri.localhost/...`，这说明：
-
-1. **你使用的是 Tauri 应用程序**，不是普通浏览器
-2. **Tampermonkey 可能无法在 Tauri 中正常工作**
-3. **或者脚本被某种方式拦截了**
-
-### 立即尝试
-
-#### 步骤1: 使用普通浏览器（Chrome/Edge）
-
-1. **关闭 Tauri 应用**
-2. **打开普通 Chrome 浏览器**
-3. **访问**: https://quote.eastmoney.com/SZ000001.html
-4. **检查 Tampermonkey 图标**：
-   - 图标上应该有数字 "1"
-   - 图标应该是彩色的
-5. **查看控制台是否有日志**
-
-#### 步骤2: 如果普通浏览器也不行
-
-**使用测试脚本**:
-
-1. 只安装 `stockwhisperer-test.user.js`（测试版）
-2. 访问股票页面
-3. 应该会看到：
-   - 红色横幅
-   - Alert 弹窗
-   - 控制台日志
-
-#### 步骤3: 检查 Tampermonkey 权限
-
-1. 点击 Tampermonkey 图标
-2. 点击 "管理面板"
-3. 点击每个脚本旁边的 "详细信息"
-4. 检查权限设置，确保：
-   - ✅ 脚本已启用
-   - ✅ 有访问页面的权限
-
----
-
-## 📋 请提供以下信息
-
-为了更好地帮你解决问题，请告诉我：
-
-1. **使用的浏览器**:
-   - [ ] Chrome
-   - [ ] Edge
-   - [ ] Firefox
-   - [ ] Tauri 应用
-   - [ ] 其他：___
-
-2. **测试脚本的显示**（如果安装了 test 版本）:
-   - [ ] 看到红色横幅
-   - [ ] 看到 Alert 弹窗
-   - [ ] 控制台有日志
-   - [ ] 以上都没有
-
-3. **Tampermonkey 状态**:
-   - [ ] 图标有数字
-   - [ ] 脚本列表中显示 "东方财富AI预测助手"
-   - [ ] 脚本开关是彩色的（开启状态）
-
-4. **尝试普通浏览器了吗？**
-   - [ ] 是的，普通浏览器也不行
-   - [ ] 否，只用 Tauri
-
----
-
-## 🔄 临时解决方案
-
-如果油猴脚本确实无法在你的环境中运行，我们可以：
-
-### 方案 A: 改为浏览器扩展
-
-开发一个真正的 Chrome 扩展（不是油猴脚本），兼容性更好。
-
-### 方案 B: 改为独立应用
-
-开发一个独立的桌面应用程序。
-
-### 方案 C: 使用在线版本
-
-我可以在服务器上部署一个在线版本，你只需访问网页即可使用。
-
----
-
-## ✅ 下一步行动
-
-**请立即执行以下操作**:
-
-1. **打开普通 Chrome 浏览器**（不是 Tauri）
-2. **安装测试脚本**: `stockwhisperer-test.user.js`
-3. **访问**: https://quote.eastmoney.com/SZ000001.html
-4. **告诉我是否看到红色横幅或 Alert**
-
-这样我们就能确定问题出在哪里了！
-
----
-
-**补充说明**:
-
-你的环境（Tauri）可能是一个打包的桌面应用。这种情况下：
-- Tampermonkey 可能无法正常工作
-- 需要使用普通浏览器测试
-- 或者我们需要换一种技术方案
-
-请先在**普通 Chrome/Edge 浏览器**中测试，然后告诉我结果！
Index: docs/独立应用架构设计_v2.0.md
===================================================================
diff --git a/docs/独立应用架构设计_v2.0.md b/docs/独立应用架构设计_v2.0.md
deleted file mode 100644
--- a/docs/独立应用架构设计_v2.0.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,945 +0,0 @@
-# 独立应用架构设计方案
-
-**版本**: v2.0.0
-**日期**: 2026-01-30
-**目标**: 从油猴脚本升级为独立应用(Chrome插件/Web应用)
-
----
-
-## 📋 目录
-
-1. [方案对比](#方案对比)
-2. [推荐方案: Chrome插件](#推荐方案chrome插件)
-3. [系统架构设计](#系统架构设计)
-4. [技术栈选型](#技术栈选型)
-5. [数据库设计](#数据库设计)
-6. [API设计](#api设计)
-7. [部署方案](#部署方案)
-8. [开发路线图](#开发路线图)
-
----
-
-## 方案对比
-
-### 方案1: Chrome插件 (推荐⭐)
-
-**优势**:
-- ✅ 用户体验最佳 - 无需额外浏览器,即装即用
-- ✅ 权限管理完善 - Chrome权限体系成熟
-- ✅ 分发渠道完善 - Chrome Web Store
-- ✅ 可 monetization - 支持收费/付费
-- ✅ 离线功能支持 - Service Worker + LocalStorage
-- ✅ 自动更新 - Chrome Web Store自动推送
-
-**劣势**:
-- ⚠️ 需要通过商店审核
-- ⚠️ 审核周期1-2周
-- ⚠️ 需要支付开发者费用($5一次性)
-
-**适合**: 正式产品,面向广大用户
-
-### 方案2: 独立Web应用
-
-**优势**:
-- ✅ 完全自主,无审核限制
-- ✅ 可使用任何前端框架
-- ✅ SEO友好
-- ✅ 多端支持(PC/Mobile)
-
-**劣势**:
-- ⚠️ 用户需要手动访问网站
-- ⚠️ 无法注入到东方财富页面
-- ⚠️ 需要用户手动输入股票代码
-
-**适合**: 辅助工具,数据分析平台
-
-### 方案3: 混合方案
-
-**优势**:
-- ✅ Chrome插件负责页面注入和数据采集
-- ✅ Web应用负责数据分析和可视化
-- ✅ 两者通过API通信
-
-**劣势**:
-- ⚠️ 开发成本高
-- ⚠️ 需要维护两套系统
-- ⚠️ 数据同步复杂
-
-**适合**: 大型生态,数据平台
-
----
-
-## 推荐方案: Chrome插件
-
-### 📦 应用结构
-
-```
-stockwhisperer-chrome-extension/
-├── manifest.json                 # Chrome插件配置文件
-├── public/                       # 静态资源
-│   ├── icons/                   # 图标
-│   └── popup/                   # 弹窗页面
-│       ├── index.html
-│       ├── popup.js
-│       └── popup.css
-│
-├── src/
-│   ├── background/              # 后台脚本(Service Worker)
-│   │   ├── index.js            # 后台主逻辑
-│   │   ├── apiClient.js        # LLM API调用
-│   │   ├── storageManager.js   # 本地存储管理
-│   │   └── scheduler.js        # 定时任务
-│   │
-│   ├── content/                # 内容脚本(注入到网页)
-│   │   ├── inject.js           # 主注入脚本
-│   │   ├── dataExtractor.js    # 数据提取模块
-│   │   ├── domObserver.js      # DOM监听
-│   │   └── uiRenderer.js       # UI渲染
-│   │
-│   ├── components/             # 共享组件
-│   │   ├── PredictionPanel.js  # 预测面板组件
-│   │   ├── ConfirmDialog.js    # 数据确认对话框
-│   │   ├── SettingsPage.js     # 设置页面
-│   │   └── Chart.js            # 图表组件
-│   │
-│   ├── utils/                  # 工具函数
-│   │   ├── logger.js           # 日志工具
-│   │   ├── sanitizer.js        # XSS防护
-│   │   ├── formatter.js        # 数据格式化
-│   │   └── validator.js        # 数据验证
-│   │
-│   ├── api/                    # API层
-│   │   ├── deepseek.js         # DeepSeek API
-│   │   ├── openai.js           # OpenAI API
-│   │   └── base.js            # 基础API类
-│   │
-│   └── store/                  # 状态管理
-│       ├── store.js            # 主store
-│       ├── modules/
-│       │   ├── stock.js        # 股票数据
-│       │   ├── prediction.js   # 预测结果
-│       │   └── settings.js     # 设置
-│       └── actions.js          # Actions
-│
-├── options/                    # 选项页面
-│   ├── index.html
-│   ├── options.js
-│   └── options.css
-│
-├── dev/                        # 开发工具
-│   └── webpack.config.js       # Webpack配置
-│
-├── tests/                      # 测试
-│   ├── unit/
-│   ├── e2e/
-│   └── fixtures/
-│
-└── package.json
-```
-
----
-
-## 系统架构设计
-
-### 架构图
-
-```
-┌─────────────────────────────────────────────────────────────┐
-│                        用户浏览器                              │
-└─────────────────────────────────────────────────────────────┘
-                          │
-                          ▼
-┌─────────────────────────────────────────────────────────────┐
-│  Chrome Extension (StockWhisperer)                          │
-├─────────────────────────────────────────────────────────────┤
-│                                                               │
-│  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐  │
-│  │ Content Script│  │   Popup UI    │  │ Options Page │  │
-│  │ (注入到网页)   │  │  (用户点击图标) │  │  (设置页面)    │  │
-│  └──────────────┘  └───────────────┘  └──────────────┘  │
-│         │                    │                     │           │
-│         ▼                    ▼                     ▼           │
-│  ┌────────────────────────────────────────────────────────┐ │
-│  │              Background Service Worker               │ │
-│  │  - API调用                                             │ │
-│  │  - 数据存储                                             │ │
-│  │  - 消息路由                                             │ │
-│  └────────────────────────────────────────────────────────┘ │
-│         │                                                    │
-│         ▼                                                    │
-│  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐  │
-│  │ Chrome Storage│  │ IndexedDB     │  │ Cache API    │  │
-│  │ (设置/缓存)   │  │ (历史数据)    │  │ (请求缓存)   │  │
-│  └──────────────┘  └───────────────┘  └──────────────┘  │
-└─────────────────────────────────────────────────────────────┘
-                          │
-                          ▼
-┌─────────────────────────────────────────────────────────────┐
-│                    LLM API (外部)                             │
-├─────────────────────────────────────────────────────────────┤
-│  DeepSeek API  │  OpenAI GPT-4  │  文心一言  │  通义千问   │
-└─────────────────────────────────────────────────────────────┘
-```
-
-### 模块说明
-
-#### 1. Content Script (内容脚本)
-
-**职责**:
-- 注入到东方财富网页
-- 提取股票数据
-- 渲染预测面板
-- 监听页面变化
-
-**关键文件**:
-- `inject.js` - 主入口
-- `dataExtractor.js` - 数据提取
-- `uiRenderer.js` - UI渲染
-
-**权限需求**:
-```json
-{
-  "permissions": [
-    "activeTab",
-    "storage",
-    "scripting"
-  ],
-  "host_permissions": [
-    "https://quote.eastmoney.com/*",
-    "https://api.deepseek.com/*",
-    "https://api.openai.com/*"
-  ]
-}
-```
-
-#### 2. Background Service Worker
-
-**职责**:
-- LLM API调用
-- 数据存储管理
-- 跨域请求处理
-- 定时任务调度
-
-**关键功能**:
-```javascript
-// API调用示例
-async function predictStock(stockData) {
-  const apiConfig = await getApiConfig();
-  const response = await fetch(apiConfig.endpoint, {
-    method: 'POST',
-    headers: {
-      'Content-Type': 'application/json',
-      'Authorization': `Bearer ${apiConfig.apiKey}`
-    },
-    body: JSON.stringify(stockData)
-  });
-  return response.json();
-}
-```
-
-#### 3. Popup UI (弹窗界面)
-
-**职责**:
-- 快速访问常用功能
-- 显示预测历史
-- 快速配置API Key
-
-**组件结构**:
-```
-popup/
-├── index.html          # 主页面
-├── popup.js            # 逻辑
-└── components/
-    ├── QuickPredict.js     # 快速预测
-    ├── HistoryList.js      # 历史记录
-    └── SettingsBtn.js      # 设置按钮
-```
-
-#### 4. Options Page (设置页面)
-
-**职责**:
-- API Key配置
-- 显示设置
-- 数据管理
-- 高级设置
-
----
-
-## 技术栈选型
-
-### 前端技术栈
-
-| 技术 | 版本 | 用途 |
-|------|------|------|
-| **JavaScript** | ES2022+ | 主要开发语言 |
-| **Chrome Extension API** | Manifest V3 | 插件API |
-| **React** | 18.x | UI框架(可选) |
-| **Vue.js** | 3.x | UI框架(可选,推荐) |
-| **Webpack** | 5.x | 打包工具 |
-| **Babel** | 7.x | JavaScript编译 |
-| **TypeScript** | 5.x | 类型检查(推荐) |
-
-### 推荐方案
-
-#### 方案A: Vue.js 3 (推荐⭐)
-
-**优势**:
-- 学习曲线平缓
-- 文档完善(中文友好)
-- 单文件组件
-- 响应式系统
-- Chrome插件生态好
-
-**示例代码**:
-```vue
-<!-- PredictionPanel.vue -->
-<template>
-  <div class="prediction-panel">
-    <h3>AI预测分析</h3>
-    <div class="price-card">
-      <span>当前价格: {{ stockData.currentPrice }}</span>
-      <span>预测价格: {{ prediction.predictPrice }}</span>
-    </div>
-    <button @click="confirm">确认</button>
-  </div>
-</template>
-
-<script>
-export default {
-  props: ['stockData'],
-  data() {
-    return {
-      prediction: null
-    }
-  },
-  methods: {
-    async confirm() {
-      this.prediction = await callAI(this.stockData);
-    }
-  }
-}
-</script>
-```
-
-#### 方案B: React 18
-
-**优势**:
-- 生态最丰富
-- 就业市场需求大
-- TypeScript支持完善
-
-**示例代码**:
-```tsx
-import React, { useState } from 'react';
-
-export const PredictionPanel: React.FC<Props> = ({ stockData }) => {
-  const [prediction, setPrediction] = useState(null);
-
-  const handleConfirm = async () => {
-    const result = await callAI(stockData);
-    setPrediction(result);
-  };
-
-  return (
-    <div className="prediction-panel">
-      <h3>AI预测分析</h3>
-      <button onClick={handleConfirm}>确认</button>
-    </div>
-  );
-};
-```
-
-#### 方案C: Vanilla JS (无框架)
-
-**优势**:
-- 无构建步骤
-- 包体积最小
-- 学习成本低
-
-**适合**: MVP版本
-
-### 状态管理
-
-#### 方案A: Pinia (Vue推荐)
-
-```javascript
-// store/stock.js
-import { defineStore } from 'pinia';
-
-export const useStockStore = defineStore('stock', {
-  state: () => ({
-    currentStock: null,
-    predictions: []
-  }),
-  actions: {
-    setStock(stock) {
-      this.currentStock = stock;
-    },
-    addPrediction(prediction) {
-      this.predictions.push(prediction);
-    }
-  }
-});
-```
-
-#### 方案B: Zustand (React推荐)
-
-```javascript
-import { create } from 'zustand';
-
-export const useStockStore = create((set) => ({
-  currentStock: null,
-  predictions: [],
-  setStock: (stock) => set({ currentStock: stock }),
-  addPrediction: (prediction) => set((state) => ({
-    predictions: [...state.predictions, prediction]
-  }))
-}));
-```
-
----
-
-## 数据库设计
-
-### Chrome Storage (键值存储)
-
-**用途**: API配置、用户设置、简单缓存
-
-**数据结构**:
-```javascript
-// Settings
-{
-  apiKey: 'sk-xxx',
-  apiProvider: 'deepseek',
-  autoPredict: true,
-  theme: 'dark'
-}
-
-// Cache
-{
-  'stock_688981': {
-    data: {...},
-    timestamp: 1706600000000
-  }
-}
-```
-
-### IndexedDB (结构化存储)
-
-**用途**: 历史预测数据、统计分析
-
-**数据库Schema**:
-```javascript
-// Database: StockWhispererDB
-
-// ObjectStore: predictions
-{
-  keyPath: 'id',
-  autoIncrement: true,
-  indexes: {
-    stockCode: 'stockCode',
-    timestamp: 'timestamp',
-    accuracy: 'accuracy'
-  }
-}
-
-// 示例记录
-{
-  id: 1,
-  stockCode: '688981',
-  stockName: '中芯国际',
-  currentPrice: 122.40,
-  predictedPrice: 125.50,
-  actualPrice: 126.00,
-  trend: 'UP',
-  confidence: 75,
-  timestamp: 1706600000000,
-  reason: {
-    technical: '技术面分析...',
-    fundamental: '基本面分析...',
-    sentiment: '情绪面分析...'
-  }
-}
-
-// ObjectStore: statistics
-{
-  stockCode: '688981',
-  totalPredictions: 100,
-  accurateCount: 75,
-  accuracy: 0.75,
-  avgConfidence: 72,
-  lastUpdated: 1706600000000
-}
-```
-
----
-
-## API设计
-
-### Chrome插件API设计
-
-#### 1. Background API
-
-**调用方式**: `chrome.runtime.sendMessage`
-
-```javascript
-// Content Script调用
-chrome.runtime.sendMessage(
-  {
-    type: 'PREDICT_STOCK',
-    data: stockData
-  },
-  (response) => {
-    console.log('预测结果:', response);
-  }
-);
-
-// Background监听
-chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
-  if (message.type === 'PREDICT_STOCK') {
-    predictStock(message.data).then(sendResponse);
-    return true; // 异步响应
-  }
-});
-```
-
-#### 2. Storage API
-
-```javascript
-// 保存设置
-await chrome.storage.local.set({ apiKey: 'sk-xxx' });
-
-// 读取设置
-const result = await chrome.storage.local.get(['apiKey']);
-console.log(result.apiKey);
-
-// 监听变化
-chrome.storage.onChanged.addListener((changes, areaName) => {
-  if (areaName === 'local' && changes.apiKey) {
-    console.log('API Key已更新');
-  }
-});
-```
-
-#### 3. Tab API
-
-```javascript
-// 注入内容脚本
-chrome.tabs.query({active: true, currentWindow: true}, (tabs) => {
-  chrome.scripting.executeScript({
-    target: { tabId: tabs[0].id },
-    files: ['src/content/inject.js']
-  });
-});
-```
-
----
-
-## 部署方案
-
-### 开发环境
-
-```bash
-# 安装依赖
-npm install
-
-# 开发模式(热重载)
-npm run dev
-
-# 构建生产版本
-npm run build
-
-# 打包成zip(上传到Chrome Web Store)
-npm run package
-```
-
-### package.json
-
-```json
-{
-  "name": "stockwhisperer-extension",
-  "version": "2.0.0",
-  "description": "AI驱动的股票预测Chrome插件",
-  "scripts": {
-    "dev": "webpack --mode development --watch",
-    "build": "webpack --mode production",
-    "package": "zip -r dist.zip dist",
-    "test": "jest"
-  },
-  "devDependencies": {
-    "webpack": "^5.89.0",
-    "webpack-cli": "^5.1.4",
-    "babel-loader": "^9.1.3",
-    "copy-webpack-plugin": "^12.0.2"
-  },
-  "dependencies": {
-    "vue": "^3.3.4",
-    "pinia": "^2.1.7"
-  }
-}
-```
-
-### 生产环境
-
-#### 方式1: Chrome Web Store (推荐)
-
-**步骤**:
-1. 注册Chrome开发者账号($5)
-2. 创建开发者账号
-3. 上传插件包
-4. 填写商店信息
-5. 等待审核(1-2周)
-
-#### 方式2: 自托管
-
-**步骤**:
-1. 打包成zip文件
-2. 在GitHub Releases发布
-3. 用户下载zip安装
-
----
-
-## 开发路线图
-
-### Phase 1: 基础迁移 (1-2周)
-
-**目标**: 从油猴脚本迁移到Chrome插件
-
-- [ ] 创建Chrome插件基础结构
-- [ ] 迁移数据提取模块
-- [ ] 迁移UI渲染模块
-- [ ] 迁移API调用模块
-- [ ] 实现本地存储
-- [ ] 基础测试
-
-### Phase 2: 功能增强 (2-3周)
-
-**目标**: 增加Chrome插件特有功能
-
-- [ ] Popup快速访问
-- [ ] Options设置页面
-- [ ] 右键菜单集成
-- [ ] 历史记录功能
-- [ ] 数据统计面板
-- [ ] 导出功能(CSV/Excel)
-
-### Phase 3: UI优化 (1-2周)
-
-**目标**: 现代化UI设计
-
-- [ ] 使用Vue.js重构UI
-- [ ] 添加动画效果
-- [ ] 响应式设计
-- [ ] 主题切换
-- [ ] 图表可视化
-
-### Phase 4: 高级功能 (2-3周)
-
-**目标**: 增加高级分析功能
-
-- [ ] 历史准确率统计
-- [ ] 批量预测功能
-- [ ] 自定义指标
-- [ ] 策略回测
-- [ ] 预警功能
-
-### Phase 5: 发布准备 (1周)
-
-**目标**: 准备Chrome Web Store发布
-
-- [ ] 应用图标设计
-- [ ] 商店页面素材
-- [ ] 隐私政策
-- [ ] 用户协议
-- [ ] 审核提交
-
----
-
-## 核心代码示例
-
-### manifest.json (MV3)
-
-```json
-{
-  "manifest_version": 3,
-  "name": "StockWhisperer - AI股票预测",
-  "version": "2.0.0",
-  "description": "基于AI的智能股票走势预测工具",
-  "permissions": [
-    "activeTab",
-    "storage",
-    "scripting"
-  ],
-  "host_permissions": [
-    "https://quote.eastmoney.com/*",
-    "https://api.deepseek.com/*",
-    "https://api.openai.com/*"
-  ],
-  "background": {
-    "service_worker": "src/background/index.js"
-  },
-  "content_scripts": [
-    {
-      "matches": ["https://quote.eastmoney.com/*"],
-      "js": ["src/content/inject.js"],
-      "run_at": "document_idle"
-    }
-  ],
-  "action": {
-    "default_popup": "public/popup/index.html",
-    "default_icon": {
-      "16": "public/icons/icon16.png",
-      "48": "public/icons/icon48.png",
-      "128": "public/icons/icon128.png"
-    }
-  },
-  "options_page": "options/index.html",
-  "icons": {
-    "16": "public/icons/icon16.png",
-    "48": "public/icons/icon48.png",
-    "128": "public/icons/icon128.png"
-  }
-}
-```
-
-### Background Service Worker
-
-```javascript
-// src/background/index.js
-
-// API调用
-async function predictStock(stockData) {
-  const { apiKey, apiProvider } = await getApiConfig();
-
-  const endpoints = {
-    deepseek: 'https://api.deepseek.com/v1/chat/completions',
-    openai: 'https://api.openai.com/v1/chat/completions'
-  };
-
-  const response = await fetch(endpoints[apiProvider], {
-    method: 'POST',
-    headers: {
-      'Content-Type': 'application/json',
-      'Authorization': `Bearer ${apiKey}`
-    },
-    body: JSON.stringify({
-      model: apiProvider === 'deepseek' ? 'deepseek-chat' : 'gpt-4',
-      messages: [
-        {
-          role: 'system',
-          content: '你是一个专业的股票分析师...'
-        },
-        {
-          role: 'user',
-          content: `请分析股票: ${JSON.stringify(stockData)}`
-        }
-      ],
-      temperature: 0.7
-    })
-  });
-
-  return response.json();
-}
-
-// 消息监听
-chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
-  console.log('[Background] 收到消息:', message);
-
-  if (message.type === 'PREDICT_STOCK') {
-    predictStock(message.data)
-      .then(result => sendResponse({ success: true, data: result }))
-      .catch(error => sendResponse({ success: false, error: error.message }));
-    return true;
-  }
-
-  if (message.type === 'SAVE_SETTINGS') {
-    chrome.storage.local.set(message.data)
-      .then(() => sendResponse({ success: true }))
-      .catch(error => sendResponse({ success: false, error: error.message }));
-    return true;
-  }
-});
-```
-
-### Content Script
-
-```javascript
-// src/content/inject.js
-
-console.log('[Content Script] StockWhisperer 注入成功');
-
-// 数据提取
-async function extractStockData() {
-  const stockInfo = extractStockCodeFromURL();
-  const container = document.querySelector('.zs_brief');
-
-  if (!container) {
-    throw new Error('未找到股票数据容器');
-  }
-
-  const priceEl = container.querySelector('.price_down, .price_up');
-  const changeEl = container.querySelector('.zd');
-
-  return {
-    code: stockInfo.code,
-    name: document.title.split('(')[0].trim(),
-    currentPrice: parseFloat(priceEl.textContent),
-    changePercent: parseFloat(changeEl.textContent.match(/([+-]?\d+\.?\d*)%/)[1]),
-    timestamp: Date.now()
-  };
-}
-
-// UI渲染
-function renderPredictionPanel(stockData, prediction) {
-  const panel = document.createElement('div');
-  panel.className = 'stockwhisperer-panel';
-  panel.innerHTML = `
-    <div class="panel-header">
-      <h3>AI预测分析</h3>
-      <button class="btn-close">×</button>
-    </div>
-    <div class="panel-content">
-      <div class="price-card">
-        <p>当前价格: ${stockData.currentPrice}</p>
-        <p>预测价格: ${prediction.predictPrice}</p>
-        <p>置信度: ${prediction.confidence}%</p>
-      </div>
-      <div class="reason-analysis">
-        <h4>分析原因</h4>
-        <p>${prediction.reason}</p>
-      </div>
-    </div>
-  `;
-
-  document.body.appendChild(panel);
-}
-
-// 主逻辑
-async function main() {
-  try {
-    const stockData = await extractStockData();
-
-    // 显示确认界面
-    showConfirmDialog(stockData);
-
-    // 监听确认事件
-    document.addEventListener('stockwhisperer-confirm', async () => {
-      const result = await chrome.runtime.sendMessage({
-        type: 'PREDICT_STOCK',
-        data: stockData
-      });
-
-      if (result.success) {
-        renderPredictionPanel(stockData, result.data);
-      }
-    });
-
-  } catch (error) {
-    console.error('[Content Script] 错误:', error);
-  }
-}
-
-// 启动
-main();
-```
-
----
-
-## 与油猴脚本版本对比
-
-| 特性 | 油猴脚本 | Chrome插件 |
-|------|-----------|-------------|
-| **安装方式** | 手动安装脚本 | Chrome Web Store一键安装 |
-| **权限管理** | 基础 | 成熟的系统权限 |
-| **数据存储** | GM_setValue | Chrome Storage + IndexedDB |
-| **后台任务** | 无法实现 | Service Worker |
-| **自动更新** | 手动更新 | Chrome Web Store自动推送 |
-| **分发渠道** | GitHub文件 | Chrome Web Store |
-| **用户体验** | 需要安装Tampermonkey | 开箱即用 |
-| **审核要求** | 无 | 需要商店审核 |
-| **盈利模式** | 困难 | 可收费/订阅 |
-| **开发难度** | 低 | 中 |
-
----
-
-## 预估工作量
-
-### 人力需求
-
-- **前端工程师**: 1人 (全职)
-- **测试**: 0.5人 (兼职)
-- **设计**: 0.5人 (兼职)
-
-### 时间估算
-
-| 阶段 | 工作量 | 时间 |
-|------|--------|------|
-| 基础迁移 | 5-7天 | 1-2周 |
-| 功能增强 | 10-14天 | 2-3周 |
-| UI优化 | 5-7天 | 1-2周 |
-| 高级功能 | 10-14天 | 2-3周 |
-| 测试调试 | 3-5天 | 1周 |
-| 审核发布 | 7-14天 | 1-2周 |
-| **总计** | **40-60天** | **8-12周** |
-
----
-
-## 投资回报分析
-
-### 成本估算
-
-**一次性成本**:
-- Chrome开发者账号: $5
-- 图标设计: ¥500-1000
-- 审核时间: 人力成本
-
-**运营成本**:
-- API费用: 50-200元/月
-- 服务器: 0元(无后端)
-- CDN: 0元(使用GitHub)
-
-### 收入预期
-
-**免费版**:
-- 基础功能
-- 每日10次预测
-- 广告收入
-
-**付费版**:
-- 无限预测
-- 高级功能
-- 订阅制: ¥9.9/月 或 ¥99/年
-
-**预期**:
-- 第1年: 100-500用户
-- 第2年: 1000-5000用户
-- 月收入: ¥1000-50000
-
----
-
-## 下一步行动
-
-### 立即可做
-
-1. ✅ 创建GitHub仓库分支
-2. ⬜ 初始化Chrome插件项目结构
-3. ⬜ 迁移核心功能
-4. ⬜ 本地测试
-
-### 本周目标
-
-1. 完成基础迁移
-2. 实现核心功能
-3. 内部测试
-
-### 本月目标
-
-1. 完成所有功能开发
-2. 准备商店素材
-3. 提交审核
-
----
-
-**文档作者**: StockWhisperer Team
-**最后更新**: 2026-01-30
-**版本**: v2.0.0
Index: stockwhisperer-debug.user.js
===================================================================
diff --git a/stockwhisperer-debug.user.js b/stockwhisperer-debug.user.js
deleted file mode 100644
--- a/stockwhisperer-debug.user.js	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,303 +0,0 @@
-// ==UserScript==
-// @name         StockWhisperer DOM 调试工具
-// @namespace    http://tampermonkey.net/
-// @version      1.0.0
-// @description  辅助调试东方财富页面DOM结构
-// @author       StockWhisperer
-// @match        https://quote.eastmoney.com/*
-// @match        https://emweb.eastmoney.com/*
-// @grant        none
-// @run-at       document-idle
-// ==/UserScript==
-
-(function() {
-    'use strict';
-
-    console.log('========================================');
-    console.log('🔧 StockWhisperer DOM 调试工具已启动');
-    console.log('========================================');
-
-    // 等待页面加载完成
-    function initWhenReady() {
-        if (document.readyState === 'complete') {
-            setTimeout(analyzeDOM, 2000);
-        } else {
-            window.addEventListener('load', () => {
-                setTimeout(analyzeDOM, 2000);
-            });
-        }
-    }
-
-    function analyzeDOM() {
-        console.log('\n📊 DOM 结构分析开始...\n');
-
-        // 1. 分析页面标题
-        console.log('1️⃣ 页面标题:');
-        console.log('   标题文本:', document.title);
-
-        // 从标题提取股票代码和价格
-        const titleCode = document.title.match(/(\d{6})/);
-        const titlePrice = document.title.match(/(\d+\.\d+)/);
-        const titlePercent = document.title.match(/([+-]?\d+\.?\d*)%/);
-
-        console.log('   股票代码:', titleCode ? titleCode[1] : '未找到');
-        console.log('   价格:', titlePrice ? titlePrice[1] : '未找到');
-        console.log('   涨跌幅:', titlePercent ? titlePercent[1] + '%' : '未找到');
-
-        // 2. 查找所有包含价格的元素
-        console.log('\n2️⃣ 价格元素分析:');
-        const priceElements = document.querySelectorAll('[class*="price"], [id*="price"]');
-        console.log(`   找到 ${priceElements.length} 个包含"price"的元素`);
-
-        const relevantPrices = [];
-        priceElements.forEach((el, index) => {
-            const text = el.textContent.trim();
-            const priceMatch = text.match(/(\d+\.?\d*)/);
-
-            if (priceMatch) {
-                const price = parseFloat(priceMatch[1]);
-
-                // 只显示合理的股票价格（0.1 - 1000）
-                if (price > 0.1 && price < 1000) {
-                    relevantPrices.push({
-                        index,
-                        price,
-                        tag: el.tagName,
-                        class: el.className,
-                        id: el.id,
-                        text: text.substring(0, 50)
-                    });
-                }
-            }
-        });
-
-        if (relevantPrices.length > 0) {
-            console.log('   所有找到的价格元素:');
-            relevantPrices.forEach(item => {
-                const isIndex = item.price >= 1000 && item.price % 1 === 0;
-                const typeLabel = isIndex ? '🔴 大盘指数(跳过)' : '🟢 个股价格';
-                console.log(`   [${item.index}] ${typeLabel}`);
-                console.log(`       价格: ${item.price}`);
-                console.log(`       标签: ${item.tag}`);
-                console.log(`       Class: ${item.class || '无'}`);
-                console.log(`       ID: ${item.id || '无'}`);
-                console.log(`       文本: ${item.text}`);
-                console.log('');
-            });
-        } else {
-            console.log('   ⚠️ 未找到合理的价格元素');
-        }
-
-        // 特别检查：大盘指数
-        const indexPrices = relevantPrices.filter(item =>
-            item.price >= 1000 && item.price % 1 === 0
-        );
-        if (indexPrices.length > 0) {
-            console.log('   ⚠️ 发现大盘指数元素（应排除）:');
-            indexPrices.forEach(item => {
-                console.log(`       价格: ${item.price}, Class: ${item.class || '无'}`);
-            });
-        }
-
-        // 个股价格
-        const stockPrices = relevantPrices.filter(item =>
-            item.price < 1000 || (item.price >= 1000 && item.price % 1 !== 0)
-        );
-        if (stockPrices.length > 0) {
-            console.log('   ✅ 发现个股价格元素:');
-            stockPrices.forEach(item => {
-                console.log(`       价格: ${item.price}, Class: ${item.class || '无'}`);
-            });
-        }
-
-        // 3. 查找涨跌幅元素
-        console.log('\n3️⃣ 涨跌幅元素分析:');
-        const changeElements = document.querySelectorAll('[class*="change"], [class*="percent"], [id*="change"]');
-        console.log(`   找到 ${changeElements.length} 个包含"change/percent"的元素`);
-
-        const relevantChanges = [];
-        changeElements.forEach((el, index) => {
-            const text = el.textContent.trim();
-            const match = text.match(/([+-]?\d+\.?\d*)/);
-
-            if (match) {
-                const change = parseFloat(match[1]);
-                // 合理的涨跌幅范围：-20 到 +20
-                if (change >= -20 && change <= 20 && change !== 0) {
-                    relevantChanges.push({
-                        index,
-                        change,
-                        tag: el.tagName,
-                        class: el.className,
-                        id: el.id,
-                        text: text.substring(0, 50)
-                    });
-                }
-            }
-        });
-
-        if (relevantChanges.length > 0) {
-            console.log('   合理的涨跌幅元素:');
-            relevantChanges.forEach(item => {
-                console.log(`   [${item.index}] 涨跌幅: ${item.change}%`);
-                console.log(`       标签: ${item.tag}`);
-                console.log(`       Class: ${item.class || '无'}`);
-                console.log(`       ID: ${item.id || '无'}`);
-                console.log(`       文本: ${item.text}`);
-                console.log('');
-            });
-        } else {
-            console.log('   ⚠️ 未找到合理的涨跌幅元素');
-        }
-
-        // 4. 查找股票名称
-        console.log('\n4️⃣ 股票名称元素分析:');
-        const nameSelectors = ['h1', 'h2', '.stock-name', '.name', '[class*="title"]'];
-        let foundName = false;
-
-        nameSelectors.forEach(selector => {
-            const elements = document.querySelectorAll(selector);
-            elements.forEach(el => {
-                const text = el.textContent.trim();
-                if (text && text.length < 30 && text.length > 0) {
-                    console.log(`   选择器 "${selector}":`);
-                    console.log(`     文本: ${text}`);
-                    console.log(`     Class: ${el.className}`);
-                    foundName = true;
-                }
-            });
-        });
-
-        if (!foundName) {
-            console.log('   ⚠️ 未找到明显的股票名称元素');
-        }
-
-        // 5. 创建可视化调试面板
-        createDebugPanel(relevantPrices, relevantChanges, titleCode);
-
-        console.log('\n✅ DOM 分析完成！');
-        console.log('💡 提示: 查看页面右上角的调试面板以获取可视化信息');
-    }
-
-    function createDebugPanel(prices, changes, titleCode) {
-        const panel = document.createElement('div');
-        panel.id = 'stockwhisperer-debug-panel';
-        panel.style.cssText = `
-            position: fixed;
-            top: 10px;
-            right: 10px;
-            width: 350px;
-            max-height: 80vh;
-            overflow-y: auto;
-            background: rgba(0, 0, 0, 0.95);
-            color: #00ff00;
-            padding: 15px;
-            border-radius: 8px;
-            font-family: 'Consolas', 'Monaco', monospace;
-            font-size: 12px;
-            z-index: 999999;
-            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
-        `;
-
-        let html = `
-            <div style="border-bottom: 1px solid #00ff00; padding-bottom: 10px; margin-bottom: 10px;">
-                <strong style="font-size: 16px;">🔧 StockWhisperer 调试面板</strong>
-                <button onclick="this.parentElement.parentElement.remove()" style="float: right; background: #ff4444; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px;">关闭</button>
-            </div>
-
-            <div style="margin-bottom: 15px;">
-                <div style="color: #ffff00; font-weight: bold; margin-bottom: 5px;">📋 页面信息</div>
-                <div>URL: ${window.location.href.substring(0, 50)}...</div>
-                <div>标题: ${document.title.substring(0, 40)}...</div>
-                <div>股票代码: ${titleCode ? titleCode[1] : '未找到'}</div>
-            </div>
-
-            <div style="margin-bottom: 15px;">
-                <div style="color: #00ffff; font-weight: bold; margin-bottom: 5px;">💰 找到的价格 (${prices.length}个)</div>
-        `;
-
-        if (prices.length > 0) {
-            // 分类显示
-            const stockPrices = prices.filter(p => p.price < 1000 || (p.price >= 1000 && p.price % 1 !== 0));
-            const indexPrices = prices.filter(p => p.price >= 1000 && p.price % 1 === 0);
-
-            html += '<div style="max-height: 200px; overflow-y: auto;">';
-
-            // 个股价格（绿色）
-            if (stockPrices.length > 0) {
-                html += '<div style="margin-bottom: 10px;"><span style="color: #00ff00;">✅ 个股价格 (' + stockPrices.length + '个):</span></div>';
-                stockPrices.forEach((item, i) => {
-                    html += `
-                        <div style="padding: 5px; margin: 3px 0; background: rgba(0, 255, 0, 0.1); border-radius: 4px;">
-                            <div style="color: #00ff00;"><strong>#${i + 1} 价格: ${item.price}</strong></div>
-                            <div style="font-size: 10px; color: #aaaaaa;">
-                                Class: <code style="background: rgba(255,255,255,0.1); padding: 2px 4px; border-radius: 2px;">${item.class || '无'}</code>
-                            </div>
-                        </div>
-                    `;
-                });
-            }
-
-            // 大盘指数（红色警告）
-            if (indexPrices.length > 0) {
-                html += '<div style="margin-bottom: 10px; margin-top: 15px;"><span style="color: #ff4444;">⚠️ 大盘指数 (应排除) (' + indexPrices.length + '个):</span></div>';
-                indexPrices.forEach((item, i) => {
-                    html += `
-                        <div style="padding: 5px; margin: 3px 0; background: rgba(255, 68, 68, 0.1); border: 1px solid #ff4444; border-radius: 4px;">
-                            <div style="color: #ff4444;"><strong>#${i + 1} 价格: ${item.price}</strong> 🔴</div>
-                            <div style="font-size: 10px; color: #aaaaaa;">
-                                Class: <code style="background: rgba(255,255,255,0.1); padding: 2px 4px; border-radius: 2px;">${item.class || '无'}</code>
-                            </div>
-                        </div>
-                    `;
-                });
-            }
-
-            html += '</div>';
-        } else {
-            html += '<div style="color: #ff4444;">⚠️ 未找到任何价格元素</div>';
-        }
-
-        html += `
-            </div>
-
-            <div style="margin-bottom: 15px;">
-                <div style="color: #ff00ff; font-weight: bold; margin-bottom: 5px;">📈 找到的涨跌幅 (${changes.length}个)</div>
-        `;
-
-        if (changes.length > 0) {
-            html += '<div style="max-height: 150px; overflow-y: auto;">';
-            changes.forEach((item, i) => {
-                const color = item.change >= 0 ? '#00ff00' : '#ff4444';
-                html += `
-                    <div style="padding: 5px; margin: 3px 0; background: rgba(255, 255, 255, 0.1); border-radius: 4px;">
-                        <div style="color: ${color};"><strong>#${i + 1} ${item.change >= 0 ? '+' : ''}${item.change}%</strong></div>
-                        <div style="font-size: 10px; color: #aaaaaa;">
-                            Class: <code style="background: rgba(255,255,255,0.1); padding: 2px 4px; border-radius: 2px;">${item.class || '无'}</code>
-                        </div>
-                    </div>
-                `;
-            });
-            html += '</div>';
-        } else {
-            html += '<div style="color: #ff4444;">⚠️ 未找到合理的涨跌幅元素</div>';
-        }
-
-        html += `
-            </div>
-
-            <div style="border-top: 1px solid #00ff00; padding-top: 10px; margin-top: 10px;">
-                <div style="color: #ffff00; font-size: 11px;">
-                    💡 提示: 查看控制台获取更详细的分析结果
-                </div>
-            </div>
-        `;
-
-        panel.innerHTML = html;
-        document.body.appendChild(panel);
-    }
-
-    // 启动
-    initWhenReady();
-
-})();
Index: docs/文档整理完成报告.md
===================================================================
diff --git a/docs/文档整理完成报告.md b/docs/文档整理完成报告.md
deleted file mode 100644
--- a/docs/文档整理完成报告.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,156 +0,0 @@
-# 文档整理完成报告
-
-**日期**: 2026-01-30
-**版本**: v1.0.2
-
----
-
-## ✅ 已完成的整理
-
-### 1. 创建新文档
-
-#### 📄 `开发日志.md` (新建)
-- 合并了 `Bug修复报告_v1.0.1.md`
-- 合并了 `功能优化说明_v1.0.2.md`
-- 合并了 `数据提取优化说明_v1.0.2.md`
-- 记录所有版本更新和技术决策
-
-#### 📄 `文档整理计划.md` (新建)
-- 记录整理过程和决策依据
-- 保留作为未来参考
-
-### 2. 合并文档
-
-#### 📄 `调试指南.md` (更新)
-- 追加了 `紧急修复指南.md` 的内容
-- 成为完整的调试和故障排除手册
-
-### 3. 更新主文档
-
-#### 📄 `README.md` (更新)
-- 版本号更新为 v1.0.2
-- 添加"当前版本状态"章节
-- 列出已修复功能和已知问题
-- 添加文档索引,方便查找
-
-### 4. 删除冗余文档
-
-已删除以下4个文档(内容已合并):
-- ❌ `Bug修复报告_v1.0.1.md`
-- ❌ `紧急修复指南.md`
-- ❌ `功能优化说明_v1.0.2.md`
-- ❌ `数据提取优化说明_v1.0.2.md`
-
----
-
-## 📁 最终文档结构
-
-```
-StockWhisperer/
-├── README.md                          # ✅ 主文档(已更新)
-├── CLAUDE.md                          # Claude开发指南
-├── stockwhisperer.user.js            # 主脚本 (88KB)
-├── stockwhisperer-debug.user.js      # 调试脚本 (保留)
-├── stockwhisperer-test.user.js       # 测试脚本 (保留)
-│
-└── docs/
-    ├── 核心设计文档/
-    │   ├── 初始需求.md                 (460字节)
-    │   ├── 需求分析与功能点.md         (12KB)
-    │   ├── 技术方案对比分析_v2.0.md    (35KB)
-    │   ├── 油猴脚本方案架构设计_v1.0.md (64KB)
-    │   └── 项目命名方案_v1.0.md        (5.9KB)
-    │
-    ├── 操作指南/
-    │   ├── 使用指南.md                (11KB)
-    │   └── 调试指南.md                (14KB, 已合并)
-    │
-    ├── 开发日志.md                    (4.2KB, 新建)
-    └── 文档整理计划.md                (3.4KB, 新建)
-```
-
-**文档总数**: 11个 → 9个 (减少2个)
-
-**总大小**: 约 160KB → 150KB (减少约10KB)
-
----
-
-## 📊 文档分类
-
-### 按用途分类
-
-| 类型 | 文档 | 用途 |
-|------|------|------|
-| **主文档** | README.md | 项目介绍、快速开始 |
-| **开发指南** | CLAUDE.md | AI辅助开发说明 |
-| **核心设计** | 5个文档 | 需求、技术方案、架构设计 |
-| **操作指南** | 2个文档 | 使用和调试 |
-| **历史记录** | 开发日志.md | 版本更新历史 |
-
-### 按读者分类
-
-| 读者 | 推荐文档 |
-|------|---------|
-| **新用户** | README.md → 使用指南.md |
-| **开发者** | CLAUDE.md → 油猴脚本方案架构设计_v1.0.md |
-| **调试人员** | 调试指南.md → 开发日志.md |
-| **决策者** | 技术方案对比分析_v2.0.md → 需求分析与功能点.md |
-
----
-
-## 🎯 整理效果
-
-### 优化前
-- 11个文档
-- 内容分散,难以查找
-- 存在重复内容
-- 版本信息混乱
-
-### 优化后
-- 9个文档
-- 结构清晰,分类明确
-- 无重复内容
-- 版本信息统一
-
-### 改进点
-
-1. ✅ **快速查找**: 通过README的文档索引快速定位
-2. ✅ **版本追踪**: 开发日志统一记录所有更新
-3. ✅ **减少维护**: 删除冗余文档,降低维护成本
-4. ✅ **用户友好**: 明确标注当前版本状态和已知问题
-
----
-
-## 🔄 后续维护建议
-
-### 文档更新流程
-
-1. **功能更新** → 更新 `开发日志.md`
-2. **新Bug修复** → 更新 `开发日志.md`
-3. **版本发布** → 更新 `README.md` 版本号
-4. **新功能** → 更新 `使用指南.md`
-5. **新问题** → 更新 `调试指南.md`
-
-### 版本管理
-
-```markdown
-## 版本命名规则
-- v1.0.x: 功能更新和Bug修复
-- v1.x.0: 新增功能
-- v2.0.0: 重大架构变更
-
-## 文档版本
-每个文档顶部标注:
-- **创建日期**: YYYY-MM-DD
-- **最后更新**: YYYY-MM-DD
-- **适用版本**: v1.0.2
-```
-
----
-
-## ✅ 整理完成
-
-所有文档已整理完成,结构清晰,易于查找和维护。
-
-**维护者**: StockWhisperer Team
-**整理日期**: 2026-01-30
Index: docs/操作指南/使用指南.md
===================================================================
diff --git a/docs/操作指南/使用指南.md b/docs/操作指南/使用指南.md
deleted file mode 100644
--- a/docs/操作指南/使用指南.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,428 +0,0 @@
-# StockWhisperer 使用指南
-
-## 目录
-
-1. [安装教程](#安装教程)
-2. [配置说明](#配置说明)
-3. [使用教程](#使用教程)
-4. [API Key 获取指南](#api-key-获取指南)
-5. [常见问题](#常见问题)
-6. [最佳实践](#最佳实践)
-
-## 安装教程
-
-### 步骤1: 安装 Tampermonkey
-
-Tampermonkey 是一个流行的用户脚本管理器，支持 Chrome、Firefox、Edge、Safari 等主流浏览器。
-
-#### Chrome/Edge 用户
-
-1. 访问 [Chrome Web Store](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
-2. 点击 "添加至 Chrome" 按钮
-3. 在弹出框中点击 "添加扩展程序"
-4. 等待安装完成，浏览器工具栏会出现 Tampermonkey 图标
-
-#### Firefox 用户
-
-1. 访问 [Firefox 附加组件](https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/)
-2. 点击 "添加到 Firefox" 按钮
-3. 在弹出框中点击 "添加"
-4. 等待安装完成
-
-#### Safari 用户
-
-1. 在 App Store 中搜索 "Tampermonkey"
-2. 下载并安装
-3. 在 Safari 设置中启用扩展
-
-### 步骤2: 安装 StockWhisperer 脚本
-
-#### 方法1: 手动安装（推荐）
-
-1. 下载 `stockwhisperer.user.js` 文件
-2. 点击浏览器工具栏的 Tampermonkey 图标
-3. 选择 "管理面板"
-4. 点击左侧的 "+" 号（新建脚本）
-5. 删除编辑器中的默认内容
-6. 将 `stockwhisperer.user.js` 的内容复制粘贴到编辑器
-7. 按 `Ctrl+S`（Mac: `Cmd+S`）保存
-8. 看到提示 "保存成功" 即完成安装
-
-#### 方法2: 拖拽安装
-
-1. 下载 `stockwhisperer.user.js` 文件到本地
-2. 直接将文件拖拽到浏览器窗口
-3. Tampermonkey 会弹出安装确认框
-4. 点击 "安装" 按钮
-
-### 步骤3: 验证安装
-
-1. 访问 [东方财富](https://quote.eastmoney.com/)
-2. 点击任意股票，例如：https://quote.eastmoney.com/SZ000001.html
-3. 等待页面加载完成
-4. 页面右侧应该会出现 "AI预测分析" 面板
-
-## 配置说明
-
-### 配置 API Key
-
-首次使用时，需要配置 AI API 的 Key。
-
-#### 1. 访问设置
-
-- 方式1: 在 AI 预测面板中点击 "⚙️ 设置" 按钮
-- 方式2: 如果没有配置 API Key，会自动弹出设置对话框
-
-#### 2. 选择 API 提供商
-
-**推荐：DeepSeek（高性价比）**
-
-- 优点：中文理解强、价格便宜、响应快速
-- 缺点：知名度相对较低
-- 价格：约 ¥0.14/1M tokens
-- 月均成本：¥2-4
-
-**备选：OpenAI GPT-4**
-
-- 优点：功能强大、生态完善
-- 缺点：价格较贵、国内访问可能需要代理
-- 价格：约 ¥18/1M tokens
-- 月均成本：¥270-540
-
-#### 3. 输入 API Key
-
-将获取到的 API Key 粘贴到输入框中（详见 [API Key 获取指南](#api-key-获取指南)）
-
-#### 4. 保存配置
-
-点击 "保存" 按钮，配置会安全地保存在本地浏览器中。
-
-## 使用教程
-
-### 基本使用
-
-1. **访问股票页面**
-
-   访问东方财富任意股票详情页，例如：
-   - https://quote.eastmoney.com/SZ000001.html（平安银行）
-   - https://quote.eastmoney.com/SH600036.html（招商银行）
-
-2. **等待分析完成**
-
-   页面加载后，AI 会自动开始分析，通常需要 3-10 秒。
-
-3. **查看预测结果**
-
-   预测面板会显示以下信息：
-
-   - **当前价格**: 股票的实时价格
-   - **预测价格**: AI 预测的 1-3 天目标价格
-   - **涨跌幅**: 预测的涨跌百分比
-   - **置信区间**: 预测价格的可能波动范围
-   - **走势原因分析**:
-     - 📊 技术面：技术指标分析（MACD、RSI、均线等）
-     - 📊 基本面：行业和公司分析
-     - 📊 情绪面：市场情绪和资金流向分析
-   - **投资建议**: 🟢 买入 / 🟡 持有 / 🔴 卖出
-   - **置信度**: AI 对预测的可信程度（0-100%）
-
-### 面板操作
-
-#### 刷新预测
-
-点击面板顶部的 "🔄 刷新" 按钮，可以重新运行 AI 分析。
-
-**何时使用**：
-- 股票价格发生较大变化
-- 需要获取最新预测
-- 之前的预测失败
-
-#### 修改设置
-
-点击 "⚙️ 设置" 按钮可以：
-- 切换 API 提供商
-- 更新 API Key
-
-#### 关闭面板
-
-点击 "×" 按钮关闭预测面板。如需重新显示，刷新页面即可。
-
-### 理解预测结果
-
-#### 趋势类型
-
-- **📈 上涨 (UP)**: AI 认为股价大概率会上涨
-- **📉 下跌 (DOWN)**: AI 认为股价大概率会下跌
-- **➡️ 中性 (NEUTRAL)**: AI 认为股价会横盘整理
-
-#### 投资建议
-
-- **🟢 买入 (BUY)**: 建议考虑买入该股票
-- **🟡 持有 (HOLD)**: 建议继续持有，观望
-- **🔴 卖出 (SELL)**: 建议考虑卖出
-
-#### 置信度
-
-- **80-100%**: AI 非常确定
-- **60-80%**: AI 比较确定（常见范围）
-- **40-60%**: AI 不太确定
-- **0-40%**: AI 非常不确定
-
-⚠️ **注意**: 即使置信度很高，也不代表预测 100% 准确！
-
-## API Key 获取指南
-
-### DeepSeek API Key（推荐）
-
-#### 步骤
-
-1. **注册账号**
-
-   访问 [DeepSeek 官网](https://www.deepseek.com/)
-   - 点击右上角 "注册"
-   - 使用手机号或邮箱注册
-   - 完成实名认证（可能需要）
-
-2. **获取 API Key**
-
-   - 登录后，点击右上角头像
-   - 选择 "API Keys"
-   - 点击 "创建 API Key" 按钮
-   - 输入名称（如：StockWhisperer）
-   - 点击 "确认"
-   - **立即复制 API Key**（只显示一次！）
-
-3. **充值（可选）**
-
-   - 新用户通常有免费额度
-   - 免费用完后，需要充值才能继续使用
-   - 充值金额：建议先充值 ¥10 测试
-
-4. **配置到脚本**
-
-   - 将复制的 API Key 粘贴到设置对话框
-   - 点击保存
-
-#### 费用说明
-
-- 定价：¥0.14 / 1M tokens
-- 单次预测：约 500-1000 tokens
-- 100 次预测：约 ¥0.07-0.14
-- **月均成本（每天100次）：¥2-4**
-
-### OpenAI API Key
-
-#### 步骤
-
-1. **注册账号**
-
-   访问 [OpenAI Platform](https://platform.openai.com/)
-   - 点击 "Sign up"
-   - 使用邮箱或 Google/Microsoft 账号注册
-   - 验证手机号
-
-2. **获取 API Key**
-
-   - 登录后，点击左侧 "API keys"
-   - 点击 "+ Create new secret key"
-   - 输入名称（如：StockWhisperer）
-   - 点击 "Create secret key"
-   - **立即复制 API Key**（只显示一次！）
-
-3. **充值**
-
-   - OpenAI 采用预付费模式
-   - 需要先充值才能使用
-   - 最低充值金额：$5 USD
-
-4. **配置到脚本**
-
-   - 将复制的 API Key 粘贴到设置对话框
-   - 点击保存
-
-#### 费用说明
-
-- 定价：约 $2.5 / 1M tokens（GPT-4）
-- 单次预测：约 500-1000 tokens
-- 100 次预测：约 $0.00125-0.0025
-- **月均成本（每天100次）：$5-10（约 ¥35-70）**
-
-⚠️ **注意**: 国内访问 OpenAI API 可能需要代理。
-
-## 常见问题
-
-### Q1: 脚本安装后没有反应？
-
-**原因**：脚本未启用或页面不匹配
-
-**解决方案**：
-
-1. 检查 Tampermonkey 图标，确认脚本已启用（彩色）
-2. 确认访问的是东方财富股票详情页（URL 格式：`quote.eastmoney.com/SZ000001.html`）
-3. 刷新页面
-4. 打开浏览器控制台（F12），查看是否有错误信息
-
-### Q2: 提示 "无法获取股票数据"？
-
-**原因**：数据提取失败
-
-**解决方案**：
-
-1. 确认页面完全加载（等待 2-3 秒）
-2. 刷新页面重试
-3. 检查 URL 是否正确（必须是股票详情页）
-4. 尝试访问其他股票页面
-
-### Q3: API 调用失败？
-
-**原因**：API Key 无效或网络问题
-
-**解决方案**：
-
-1. 检查 API Key 是否正确
-2. 确认 API 账户余额充足
-3. 检查网络连接
-4. 如果使用 OpenAI，确认能访问 OpenAI API（可能需要代理）
-5. 尝试切换 API 提供商
-
-### Q4: AI 分析很慢？
-
-**原因**：API 响应慢
-
-**正常情况**：
-
-- DeepSeek：通常 3-10 秒
-- OpenAI：通常 5-15 秒
-
-**如果超过 30 秒**：
-
-1. 检查网络连接
-2. 刷新页面重试
-3. 尝试切换 API 提供商
-
-### Q5: 预测结果不合理？
-
-**说明**：
-
-- AI 预测基于历史数据和有限信息，不可能 100% 准确
-- 当前版本使用基础 Prompt，未引入专业金融数据
-- 股市受多种因素影响，AI 无法预测突发事件
-
-**建议**：
-
-- 仅作为参考，不要完全依赖
-- 结合自己的判断
-- 多次预测，观察趋势
-- 关注置信度指标
-
-### Q6: API 费用太高？
-
-**优化建议**：
-
-1. 使用 DeepSeek 而非 OpenAI（成本降低 99%）
-2. 避免频繁刷新（预测结果缓存 5 分钟）
-3. 只在需要时预测（不要每天预测几百次）
-
-### Q7: 可以预测港股/美股吗？
-
-**当前版本**：仅支持 A 股（深圳/上海）
-
-**未来计划**：
-
-- v1.2 版本计划支持港股
-- v2.0 版本计划支持美股
-
-### Q8: 数据安全吗？
-
-**安全保障**：
-
-- ✅ API Key 存储在本地浏览器，不上传服务器
-- ✅ 所有数据处理在本地完成
-- ✅ 仅股票代码和价格发送给 AI API
-- ✅ 不收集任何用户个人信息
-
-## 最佳实践
-
-### 1. 合理使用 AI 预测
-
-- ✅ 将 AI 预测作为辅助工具
-- ✅ 结合自己的技术分析
-- ✅ 关注置信度指标
-- ❌ 不要完全依赖 AI 预测
-- ❌ 不要忽视风险
-
-### 2. 控制使用频率
-
-- 建议：每天每只股票预测 1-2 次
-- 避免频繁刷新（浪费 API 调用）
-- 利用 5 分钟缓存机制
-
-### 3. 多维度分析
-
-- 查看 AI 的原因分析（技术面/基本面/情绪面）
-- 结合 K 线图、成交量等技术指标
-- 关注新闻和市场热点
-- 考虑大盘走势
-
-### 4. 风险管理
-
-- 设置止损点
-- 分散投资
-- 不要投入超出风险承受能力的资金
-
-### 5. 持续优化
-
-- 关注版本更新
-- 提供反馈帮助改进
-- 尝试不同的 API 提供商
-
-## 进阶使用
-
-### 自定义 Prompt（高级用户）
-
-脚本中的 Prompt 可以根据需要调整：
-
-1. 打开 Tampermonkey 管理面板
-2. 找到 `APIModule.generatePrompt` 函数
-3. 修改 Prompt 内容
-4. 保存并刷新页面测试
-
-**注意**: 修改前请备份原始脚本！
-
-### 查看原始数据
-
-1. 打开浏览器控制台（F12）
-2. 切换到 "Console" 标签
-3. 查找 `[StockWhisperer]` 开头的日志
-4. 可以看到股票数据和预测结果
-
-### 调试问题
-
-如果遇到问题：
-
-1. 打开浏览器控制台（F12）
-2. 查看 "Console" 中的错误信息
-3. 截图并提交 Issue
-
-## 版本历史
-
-### v1.0.0 (2026-01-29)
-
-- ✨ 首次发布
-- ✅ 支持 A 股实时预测
-- ✅ 集成 DeepSeek 和 OpenAI API
-- ✅ 多维度分析（技术/基本面/情绪面）
-- ✅ 现代化 UI 设计
-- ✅ 本地配置管理
-
-## 获取帮助
-
-- 📖 查看 [README.md](./README.md)
-- 🐛 提交 [GitHub Issue](https://github.com/your-repo/issues)
-- 📧 联系作者: your-email@example.com
-
----
-
-**祝投资顺利！** 📈
-
-⚠️ **再次提醒**: AI 预测仅供参考，不构成投资建议。股市有风险，投资需谨慎！
Index: stockwhisperer.user.js
===================================================================
diff --git a/stockwhisperer.user.js b/stockwhisperer.user.js
deleted file mode 100644
--- a/stockwhisperer.user.js	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,2365 +0,0 @@
-// ==UserScript==
-// @name         东方财富AI预测助手 (StockWhisperer)
-// @namespace    http://tampermonkey.net/
-// @version      1.0.1
-// @description  AI驱动的股票走势预测和原因分析 - 倾听股市，洞见未来
-// @author       StockWhisperer
-// @match        https://quote.eastmoney.com/*
-// @match        https://emweb.eastmoney.com/*
-// @grant        GM_xmlhttpRequest
-// @grant        GM_setValue
-// @grant        GM_getValue
-// @grant        GM_deleteValue
-// @grant        GM_addStyle
-// @connect      api.deepseek.com
-// @connect      api.openai.com
-// @run-at       document-idle
-// ==/UserScript==
-
-(function () {
-    'use strict';
-
-    // ==================== 常量配置 ====================
-    const CONFIG = {
-        DEFAULT_TIMEOUT: 10000,
-        CACHE_DURATION: 5 * 60 * 1000, // 5分钟
-        VERSION: '1.0.0',
-        PANEL_WIDTH: 360,
-        API_ENDPOINTS: {
-            DEEPSEEK: 'https://api.deepseek.com/v1/chat/completions',
-            OPENAI: 'https://api.openai.com/v1/chat/completions'
-        }
-    };
-
-    // ==================== 工具函数模块 ====================
-    const Utils = {
-        // 格式化数字
-        formatNumber(num, decimals = 2) {
-            if (num === null || num === undefined || isNaN(num)) return '-';
-            return parseFloat(num).toFixed(decimals);
-        },
-
-        // 格式化百分比
-        formatPercent(num) {
-            if (num === null || num === undefined || isNaN(num)) return '-';
-            const sign = num >= 0 ? '+' : '';
-            return `${sign}${parseFloat(num).toFixed(2)}%`;
-        },
-
-        // 格式化时间
-        formatTime(timestamp) {
-            if (!timestamp) return '-';
-            return new Date(timestamp).toLocaleString('zh-CN');
-        },
-
-        // 防抖
-        debounce(func, wait) {
-            let timeout;
-            return function executedFunction(...args) {
-                const later = () => {
-                    clearTimeout(timeout);
-                    func.apply(this, args);
-                };
-                clearTimeout(timeout);
-                timeout = setTimeout(later, wait);
-            };
-        },
-
-        // 节流
-        throttle(func, limit) {
-            let inThrottle;
-            return function (...args) {
-                if (!inThrottle) {
-                    func.apply(this, args);
-                    inThrottle = true;
-                    setTimeout(() => inThrottle = false, limit);
-                }
-            };
-        },
-
-        // XSS防护
-        sanitizeHTML(str) {
-            const div = document.createElement('div');
-            div.textContent = str;
-            return div.innerHTML;
-        },
-
-        // 生成缓存键
-        generateCacheKey(stockCode, timestamp) {
-            return `predict_${stockCode}_${Math.floor(timestamp / CONFIG.CACHE_DURATION)}`;
-        }
-    };
-
-    // ==================== 错误处理模块 ====================
-    const ErrorHandler = {
-        // 错误类型
-        ErrorTypes: {
-            EXTRACTION_FAILED: '数据提取失败',
-            API_CALL_FAILED: 'API调用失败',
-            INVALID_DATA: '数据无效',
-            NETWORK_ERROR: '网络错误',
-            TIMEOUT: '请求超时',
-            PARSE_ERROR: '数据解析失败'
-        },
-
-        // 处理错误
-        handle(error, context = {}) {
-            console.error('[StockWhisperer Error]', context, error);
-
-            // 用户友好提示
-            const message = this.getUserMessage(error);
-            this.showErrorNotification(message);
-
-            // 错误上报（可选）
-            this.report(error, context);
-        },
-
-        // 获取用户友好的错误信息
-        getUserMessage(error) {
-            const errorMap = {
-                [this.ErrorTypes.EXTRACTION_FAILED]: '无法获取股票数据，请刷新页面重试',
-                [this.ErrorTypes.API_CALL_FAILED]: '预测服务暂时不可用，请稍后重试',
-                [this.ErrorTypes.INVALID_DATA]: '股票数据异常',
-                [this.ErrorTypes.NETWORK_ERROR]: '网络连接失败',
-                [this.ErrorTypes.TIMEOUT]: '请求超时，请稍后重试',
-                [this.ErrorTypes.PARSE_ERROR]: '数据解析失败'
-            };
-
-            return errorMap[error.message] || error.message || '发生未知错误';
-        },
-
-        // 显示错误通知
-        showErrorNotification(message) {
-            const notification = document.createElement('div');
-            notification.style.cssText = `
-                position: fixed;
-                top: 20px;
-                right: 20px;
-                background: #f8d7da;
-                color: #721c24;
-                border: 1px solid #f5c6cb;
-                border-radius: 8px;
-                padding: 16px 20px;
-                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
-                z-index: 10001;
-                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
-                font-size: 14px;
-                display: flex;
-                align-items: center;
-                gap: 12px;
-                animation: slideInNotification 0.3s ease-out;
-            `;
-
-            notification.innerHTML = `
-                <span style="font-size: 18px;">⚠️</span>
-                <span>${Utils.sanitizeHTML(message)}</span>
-            `;
-
-            document.body.appendChild(notification);
-
-            // 3秒后自动消失
-            setTimeout(() => {
-                notification.style.animation = 'slideOutNotification 0.3s ease-out';
-                setTimeout(() => notification.remove(), 300);
-            }, 3000);
-
-            // 添加通知动画样式（如果不存在）
-            if (!document.getElementById('stockwhisperer-notification-animations')) {
-                const style = document.createElement('style');
-                style.id = 'stockwhisperer-notification-animations';
-                style.textContent = `
-                    @keyframes slideInNotification {
-                        from {
-                            transform: translateX(100%);
-                            opacity: 0;
-                        }
-                        to {
-                            transform: translateX(0);
-                            opacity: 1;
-                        }
-                    }
-                    @keyframes slideOutNotification {
-                        from {
-                            transform: translateX(0);
-                            opacity: 1;
-                        }
-                        to {
-                            transform: translateX(100%);
-                            opacity: 0;
-                        }
-                    }
-                `;
-                document.head.appendChild(style);
-            }
-        },
-
-        // 错误上报
-        report(error, context) {
-            // 可以发送到日志服务
-            console.log('[Error Report]', { error, context, timestamp: Date.now() });
-        }
-    };
-
-    // ==================== 本地存储模块 ====================
-    const StorageModule = {
-        // 保存数据
-        async set(key, value) {
-            return new Promise((resolve) => {
-                try {
-                    GM_setValue(key, JSON.stringify(value));
-                    resolve(true);
-                } catch (error) {
-                    console.error('[Storage] 保存失败:', error);
-                    resolve(false);
-                }
-            });
-        },
-
-        // 获取数据
-        async get(key, defaultValue = null) {
-            return new Promise((resolve) => {
-                try {
-                    const value = GM_getValue(key);
-                    // 修复：空字符串检查
-                    if (value === undefined || value === null || value === '') {
-                        resolve(defaultValue);
-                    } else {
-                        resolve(JSON.parse(value));
-                    }
-                } catch (error) {
-                    console.error('[Storage] 读取失败:', error);
-                    resolve(defaultValue);
-                }
-            });
-        },
-
-        // 删除数据
-        async remove(key) {
-            return new Promise((resolve) => {
-                try {
-                    GM_deleteValue(key);
-                    resolve(true);
-                } catch (error) {
-                    console.error('[Storage] 删除失败:', error);
-                    resolve(false);
-                }
-            });
-        },
-
-        // 自选股管理
-        watchlist: {
-            // 添加自选股
-            async add(stock) {
-                const list = await StorageModule.get('watchlist', []);
-                if (!list.find(item => item.code === stock.code)) {
-                    list.push({
-                        ...stock,
-                        addTime: Date.now()
-                    });
-                    await StorageModule.set('watchlist', list);
-                    return true;
-                }
-                return false;
-            },
-
-            // 删除自选股
-            async remove(code) {
-                const list = await StorageModule.get('watchlist', []);
-                const filtered = list.filter(item => item.code !== code);
-                await StorageModule.set('watchlist', filtered);
-                return true;
-            },
-
-            // 获取自选股列表
-            async getAll() {
-                return await StorageModule.get('watchlist', []);
-            },
-
-            // 检查是否已存在
-            async exists(code) {
-                const list = await this.getAll();
-                return list.some(item => item.code === code);
-            }
-        },
-
-        // API配置管理
-        config: {
-            // 保存API配置
-            async setApiConfig(provider, apiKey) {
-                const configs = await StorageModule.get('api_configs', {});
-                configs[provider] = {
-                    apiKey,
-                    updateTime: Date.now()
-                };
-                await StorageModule.set('api_configs', configs);
-            },
-
-            // 获取API配置
-            async getApiConfig(provider) {
-                const configs = await StorageModule.get('api_configs', {});
-                return configs[provider] || null;
-            },
-
-            // 获取当前使用的API提供商
-            async getCurrentProvider() {
-                return await StorageModule.get('current_provider', 'deepseek');
-            },
-
-            // 设置当前使用的API提供商
-            async setCurrentProvider(provider) {
-                await StorageModule.set('current_provider', provider);
-            }
-        }
-    };
-
-    // ==================== API调用模块 ====================
-    const APIModule = {
-        // 通用请求方法
-        request(config) {
-            return new Promise((resolve, reject) => {
-                GM_xmlhttpRequest({
-                    method: config.method || 'GET',
-                    url: config.url,
-                    data: config.data ? JSON.stringify(config.data) : undefined,
-                    headers: {
-                        'Content-Type': 'application/json',
-                        ...config.headers
-                    },
-                    timeout: config.timeout || CONFIG.DEFAULT_TIMEOUT,
-                    onload: function (response) {
-                        try {
-                            if (response.status >= 200 && response.status < 300) {
-                                const data = JSON.parse(response.responseText);
-                                resolve(data);
-                            } else {
-                                reject(new Error(`HTTP ${response.status}`));
-                            }
-                        } catch (error) {
-                            // 尝试直接返回文本
-                            resolve(response.responseText);
-                        }
-                    },
-                    onerror: function () {
-                        reject(new Error(ErrorHandler.ErrorTypes.NETWORK_ERROR));
-                    },
-                    ontimeout: function () {
-                        reject(new Error(ErrorHandler.ErrorTypes.TIMEOUT));
-                    }
-                });
-            });
-        },
-
-        // 调用LLM API进行预测
-        async predict(stockData, historyData = []) {
-            try {
-                // 获取API配置
-                const provider = await StorageModule.config.getCurrentProvider();
-                const config = await StorageModule.config.getApiConfig(provider);
-
-                if (!config || !config.apiKey) {
-                    throw new Error('请先配置API Key');
-                }
-
-                // 构建API请求
-                const apiUrl = provider === 'deepseek'
-                    ? CONFIG.API_ENDPOINTS.DEEPSEEK
-                    : CONFIG.API_ENDPOINTS.OPENAI;
-
-                const model = provider === 'deepseek' ? 'deepseek-chat' : 'gpt-4';
-
-                const prompt = this.generatePrompt(stockData, historyData);
-
-                const response = await this.request({
-                    method: 'POST',
-                    url: apiUrl,
-                    headers: {
-                        'Authorization': `Bearer ${config.apiKey}`
-                    },
-                    data: {
-                        model: model,
-                        messages: [
-                            {
-                                role: 'system',
-                                content: `你是一位专业的股票分析师，拥有10年以上的A股市场分析经验。
-
-你的任务是：
-1. 分析股票的技术面、基本面、情绪面
-2. 预测未来1-3天的价格走势
-3. 给出明确的投资建议（买入/持有/卖出）
-4. 解释预测的原因和依据
-
-分析原则：
-- 客观理性，基于数据和事实
-- 明确不确定性，不夸大预测准确性
-- 风险提示，强调投资有风险
-- 多维度分析，综合考虑各种因素
-
-输出要求：
-- 以JSON格式返回结果
-- 原因分析简洁明了，每条不超过50字
-- 预测价格基于当前价格合理波动范围内（±3%）
-- 置信度要客观，通常在50-80%之间`
-                            },
-                            {
-                                role: 'user',
-                                content: prompt
-                            }
-                        ],
-                        temperature: 0.7,
-                        max_tokens: 1000
-                    }
-                });
-
-                // 解析响应
-                const content = response.choices[0].message.content;
-                return this.parseResponse(content);
-
-            } catch (error) {
-                ErrorHandler.handle(error, { context: 'LLM预测' });
-                throw error;
-            }
-        },
-
-        // 生成Prompt
-        generatePrompt(stockData, historyData) {
-            let prompt = `请分析以下股票：
-
-## 基本信息
-- 股票代码：${stockData.code}
-- 股票名称：${stockData.name}
-- 所属市场：${stockData.market === 'SZ' ? '深圳' : '上海'}
-
-## 实时行情
-- 当前价格：${stockData.currentPrice}元
-- 今开：${stockData.openPrice || '暂无'}元
-- 昨收：${stockData.closePrice || '暂无'}元
-- 最高：${stockData.highPrice || '暂无'}元
-- 最低：${stockData.lowPrice || '暂无'}元
-- 涨跌幅：${stockData.changePercent || 0}%
-- 成交量：${stockData.volume ? (stockData.volume / 10000).toFixed(2) + '万手' : '暂无'}`;
-
-            if (historyData && historyData.length > 0) {
-                prompt += `\n\n## 历史数据（最近5天）
-${historyData.slice(0, 5).map((day, i) => {
-                    return `第${i + 1}天：${day.close}元，涨跌${day.changePercent || 0}%`;
-                }).join('\n')}`;
-            }
-
-            prompt += `
-
-请以JSON格式返回分析结果，格式如下：
-{
-    "predictPrice": 预测价格（数字）,
-    "changePercent": 预测涨跌幅（数字，如3.0表示+3%）,
-    "trend": "UP"或"DOWN"或"NEUTRAL",
-    "suggestion": "BUY"或"HOLD"或"SELL",
-    "confidence": 置信度（0-100的数字）,
-    "reason": {
-        "technical": "技术面原因（不超过50字）",
-        "fundamental": "基本面原因（不超过50字）",
-        "sentiment": "情绪面原因（不超过50字）"
-    }
-}`;
-
-            return prompt;
-        },
-
-        // 解析LLM响应
-        parseResponse(content) {
-            try {
-                // 尝试直接解析JSON
-                let result = content;
-
-                // 如果是字符串，尝试提取JSON
-                if (typeof result === 'string') {
-                    // 提取JSON部分
-                    const jsonMatch = result.match(/\{[\s\S]*\}/);
-                    if (jsonMatch) {
-                        result = JSON.parse(jsonMatch[0]);
-                    } else {
-                        throw new Error('无法提取JSON');
-                    }
-                }
-
-                // 验证必需字段
-                const requiredFields = [
-                    'predictPrice',
-                    'changePercent',
-                    'trend',
-                    'suggestion',
-                    'confidence',
-                    'reason'
-                ];
-
-                const missingFields = requiredFields.filter(field => !(field in result));
-                if (missingFields.length > 0) {
-                    throw new Error(`缺少必需字段：${missingFields.join(', ')}`);
-                }
-
-                // 数据类型转换和验证
-                result.predictPrice = parseFloat(result.predictPrice);
-                result.changePercent = parseFloat(result.changePercent);
-                result.confidence = parseInt(result.confidence);
-
-                if (isNaN(result.predictPrice) || isNaN(result.changePercent) || isNaN(result.confidence)) {
-                    throw new Error('数据类型错误');
-                }
-
-                // 趋势归一化
-                result.trend = result.trend.toUpperCase();
-                if (!['UP', 'DOWN', 'NEUTRAL'].includes(result.trend)) {
-                    result.trend = 'NEUTRAL';
-                }
-
-                // 建议归一化
-                result.suggestion = result.suggestion.toUpperCase();
-                if (!['BUY', 'HOLD', 'SELL'].includes(result.suggestion)) {
-                    result.suggestion = 'HOLD';
-                }
-
-                // 置信度范围检查
-                result.confidence = Math.max(0, Math.min(100, result.confidence));
-
-                // 计算预测区间
-                const volatility = Math.abs(result.changePercent) * 0.5;
-                result.lowerBound = result.predictPrice * (1 - volatility / 100);
-                result.upperBound = result.predictPrice * (1 + volatility / 100);
-
-                return result;
-
-            } catch (error) {
-                console.error('[LLM Parser] 解析失败:', error, content);
-                throw new Error(ErrorHandler.ErrorTypes.PARSE_ERROR);
-            }
-        }
-    };
-
-    // ==================== UI渲染模块 ====================
-    const UIModule = {
-        // 已存在的面板
-        currentPanel: null,
-
-        // 创建预测面板
-        createPredictionPanel() {
-            // 如果已存在面板，先移除
-            if (this.currentPanel) {
-                this.currentPanel.remove();
-            }
-
-            const panel = document.createElement('div');
-            panel.id = 'stockwhisperer-panel';
-            panel.className = 'stockwhisperer-panel';
-
-            // 尝试从本地存储加载保存的宽度
-            let savedWidth = CONFIG.PANEL_WIDTH;
-            try {
-                const width = GM_getValue('stockwhisperer-panel-width', CONFIG.PANEL_WIDTH);
-                if (width && typeof width === 'number') {
-                    savedWidth = width;
-                }
-            } catch (err) {
-                console.warn('无法加载保存的面板宽度');
-            }
-
-            panel.style.width = savedWidth + 'px';
-
-            panel.innerHTML = `
-                <div class="panel-header">
-                    <div class="panel-title">
-                        <span class="icon">🤖</span>
-                        <span class="text">AI预测分析</span>
-                        <span class="version">v${CONFIG.VERSION}</span>
-                    </div>
-                    <div class="panel-controls">
-                        <button class="btn-minimize" title="最小化">−</button>
-                        <button class="btn-settings" title="设置">⚙️</button>
-                        <button class="btn-refresh" title="刷新">🔄</button>
-                        <button class="btn-close" title="关闭">×</button>
-                    </div>
-                </div>
-
-                <div class="panel-content">
-                    <div class="loading-container">
-                        <div class="loading-spinner"></div>
-                        <div class="loading-text">正在提取数据...</div>
-                    </div>
-                </div>
-
-                <div class="panel-footer">
-                    <span class="update-time"></span>
-                    <span class="disclaimer">⚠️ 仅供参考，不构成投资建议</span>
-                </div>
-
-                <div class="resize-handle" title="拖动调整大小"></div>
-            `;
-
-            // 注入样式
-            this.injectStyles();
-
-            // 绑定事件
-            this.bindEvents(panel);
-            this.initResizable(panel);
-
-            document.body.appendChild(panel);
-            this.currentPanel = panel;
-
-            return panel;
-        },
-
-        // 显示数据确认界面
-        showDataConfirmation(stockData) {
-            if (!this.currentPanel) {
-                this.createPredictionPanel();
-            }
-
-            const content = this.currentPanel.querySelector('.panel-content');
-            content.innerHTML = `
-                <div class="confirm-container">
-                    <div class="confirm-header">
-                        <div class="confirm-title">📊 提取的股票数据</div>
-                        <div class="confirm-subtitle">请确认以下数据是否正确</div>
-                    </div>
-
-                    <div class="data-display">
-                        <div class="data-row">
-                            <span class="data-label">股票名称</span>
-                            <span class="data-value">${Utils.sanitizeHTML(stockData.name)}</span>
-                        </div>
-                        <div class="data-row">
-                            <span class="data-label">股票代码</span>
-                            <span class="data-value">${Utils.sanitizeHTML(stockData.code)}</span>
-                        </div>
-                        <div class="data-row">
-                            <span class="data-label">所属市场</span>
-                            <span class="data-value">${Utils.sanitizeHTML(stockData.market)}</span>
-                        </div>
-                        <div class="data-row highlight">
-                            <span class="data-label">当前价格</span>
-                            <span class="data-value price-value">${stockData.currentPrice.toFixed(2)} 元</span>
-                        </div>
-                        <div class="data-row">
-                            <span class="data-label">涨跌幅</span>
-                            <span class="data-value ${stockData.changePercent >= 0 ? 'trend-up' : 'trend-down'}">
-                                ${stockData.changePercent >= 0 ? '+' : ''}${stockData.changePercent.toFixed(2)}%
-                            </span>
-                        </div>
-                        <div class="data-row">
-                            <span class="data-label">成交量</span>
-                            <span class="data-value">${stockData.volume ? stockData.volume.toLocaleString() : '暂无'}</span>
-                        </div>
-                    </div>
-
-                    <div class="confirm-actions">
-                        <button class="btn-confirm btn-primary">
-                            <span>✅</span>
-                            <span>数据正确，开始预测</span>
-                        </button>
-                        <button class="btn-confirm btn-secondary">
-                            <span>🔄</span>
-                            <span>重新提取</span>
-                        </button>
-                    </div>
-
-                    <div class="confirm-tip">
-                        💡 提示：如果数据有误，点击"重新提取"或按 F12 查看控制台日志
-                    </div>
-                </div>
-            `;
-
-            // 绑定确认按钮事件
-            const confirmBtn = content.querySelector('.btn-primary');
-            const retryBtn = content.querySelector('.btn-secondary');
-
-            if (confirmBtn) {
-                confirmBtn.addEventListener('click', () => {
-                    window.dispatchEvent(new CustomEvent('stockwhisperer-data-confirmed', { detail: stockData }));
-                });
-            }
-
-            if (retryBtn) {
-                retryBtn.addEventListener('click', () => {
-                    window.dispatchEvent(new CustomEvent('stockwhisperer-refresh'));
-                });
-            }
-        },
-
-        // 初始化可调整大小功能
-        initResizable(panel) {
-            if (!panel) return;
-
-            const resizeHandle = panel.querySelector('.resize-handle');
-            if (!resizeHandle) return;
-
-            let isResizing = false;
-            let startX = 0;
-            let startWidth = 0;
-
-            resizeHandle.addEventListener('mousedown', (e) => {
-                isResizing = true;
-                startX = e.clientX;
-                startWidth = panel.offsetWidth;
-
-                document.addEventListener('mousemove', handleMouseMove);
-                document.addEventListener('mouseup', handleMouseUp);
-
-                e.preventDefault();
-            });
-
-            const handleMouseMove = (e) => {
-                if (!isResizing) return;
-
-                const diff = startX - e.clientX;
-                const newWidth = Math.max(300, Math.min(800, startWidth + diff));
-
-                panel.style.width = newWidth + 'px';
-
-                // 保存到本地存储
-                try {
-                    GM_setValue('stockwhisperer-panel-width', newWidth);
-                } catch (err) {
-                    console.warn('无法保存面板宽度');
-                }
-            };
-
-            const handleMouseUp = () => {
-                isResizing = false;
-                document.removeEventListener('mousemove', handleMouseMove);
-                document.removeEventListener('mouseup', handleMouseUp);
-            };
-        },
-
-        // 渲染价格卡片
-        renderPriceCard(data) {
-            const trendClass = data.trend === 'UP' ? 'trend-up' : data.trend === 'DOWN' ? 'trend-down' : 'trend-neutral';
-            const trendIcon = data.trend === 'UP' ? '📈' : data.trend === 'DOWN' ? '📉' : '➡️';
-
-            return `
-                <div class="price-card">
-                    <div class="price-row">
-                        <span class="label">当前价格</span>
-                        <span class="value">¥${Utils.formatNumber(data.currentPrice)}</span>
-                    </div>
-                    <div class="price-row ${trendClass}">
-                        <span class="label">预测价格</span>
-                        <span class="value">
-                            ${trendIcon} ¥${Utils.formatNumber(data.predictPrice)}
-                            <span class="change">(${Utils.formatPercent(data.changePercent)})</span>
-                        </span>
-                    </div>
-                    <div class="price-row">
-                        <span class="label">置信区间</span>
-                        <span class="value range">
-                            ¥${Utils.formatNumber(data.lowerBound)} - ¥${Utils.formatNumber(data.upperBound)}
-                        </span>
-                    </div>
-                </div>
-            `;
-        },
-
-        // 渲染原因分析
-        renderReasonAnalysis(data) {
-            if (!data.reason) return '';
-
-            return `
-                <div class="reason-analysis">
-                    <div class="analysis-title">
-                        <span class="icon">📊</span>
-                        <span class="text">走势原因分析</span>
-                    </div>
-
-                    ${data.reason.technical ? `
-                    <div class="analysis-item">
-                        <div class="item-header">
-                            <span class="badge technical">技术面</span>
-                        </div>
-                        <div class="item-content">
-                            ${Utils.sanitizeHTML(data.reason.technical)}
-                        </div>
-                    </div>
-                    ` : ''}
-
-                    ${data.reason.fundamental ? `
-                    <div class="analysis-item">
-                        <div class="item-header">
-                            <span class="badge fundamental">基本面</span>
-                        </div>
-                        <div class="item-content">
-                            ${Utils.sanitizeHTML(data.reason.fundamental)}
-                        </div>
-                    </div>
-                    ` : ''}
-
-                    ${data.reason.sentiment ? `
-                    <div class="analysis-item">
-                        <div class="item-header">
-                            <span class="badge sentiment">情绪面</span>
-                        </div>
-                        <div class="item-content">
-                            ${Utils.sanitizeHTML(data.reason.sentiment)}
-                        </div>
-                    </div>
-                    ` : ''}
-
-                    ${data.reason.news && data.reason.news.length > 0 ? `
-                    <div class="analysis-item">
-                        <div class="item-header">
-                            <span class="badge news">相关新闻</span>
-                        </div>
-                        <div class="item-content">
-                            <ul class="news-list">
-                                ${data.reason.news.map(news => `
-                                    <li><a href="${news.url || '#'}" target="_blank">${Utils.sanitizeHTML(news.title || news)}</a></li>
-                                `).join('')}
-                            </ul>
-                        </div>
-                    </div>
-                    ` : ''}
-                </div>
-            `;
-        },
-
-        // 渲染投资建议
-        renderSuggestion(data) {
-            const suggestionConfig = {
-                'BUY': { text: '买入', class: 'suggestion-buy', icon: '🟢' },
-                'HOLD': { text: '持有', class: 'suggestion-hold', icon: '🟡' },
-                'SELL': { text: '卖出', class: 'suggestion-sell', icon: '🔴' }
-            };
-
-            const config = suggestionConfig[data.suggestion] || suggestionConfig['HOLD'];
-
-            return `
-                <div class="suggestion-card">
-                    <div class="suggestion-header ${config.class}">
-                        <span class="icon">${config.icon}</span>
-                        <span class="text">投资建议：${config.text}</span>
-                    </div>
-                    <div class="suggestion-details">
-                        <div class="detail-row">
-                            <span class="label">置信度</span>
-                            <div class="confidence-bar">
-                                <div class="confidence-fill" style="width: ${data.confidence}%"></div>
-                                <span class="confidence-text">${data.confidence}%</span>
-                            </div>
-                        </div>
-                        <div class="detail-row">
-                            <span class="label">预测周期</span>
-                            <span class="value">1-3天</span>
-                        </div>
-                    </div>
-                </div>
-            `;
-        },
-
-        // 显示预测结果
-        showPredictionResult(stockData, predictionResult) {
-            if (!this.currentPanel) {
-                this.createPredictionPanel();
-            }
-
-            const content = this.currentPanel.querySelector('.panel-content');
-            content.innerHTML = `
-                ${this.renderPriceCard({ ...stockData, ...predictionResult })}
-                ${this.renderReasonAnalysis(predictionResult)}
-                ${this.renderSuggestion(predictionResult)}
-            `;
-
-            // 更新时间
-            const timeEl = this.currentPanel.querySelector('.update-time');
-            if (timeEl) {
-                timeEl.textContent = `更新于：${Utils.formatTime(Date.now())}`;
-            }
-        },
-
-        // 显示错误状态
-        // 显示错误状态
-        showError(message) {
-            if (!this.currentPanel) {
-                this.createPredictionPanel();
-            }
-
-            const content = this.currentPanel.querySelector('.panel-content');
-            content.innerHTML = `
-                <div class="error-container">
-                    <div class="error-icon">❌</div>
-                    <div class="error-message">${Utils.sanitizeHTML(message)}</div>
-                    <button class="error-retry">重试</button>
-                </div>
-            `;
-
-            // 绑定重试事件
-            const retryBtn = content.querySelector('.error-retry');
-            if (retryBtn) {
-                retryBtn.addEventListener('click', () => {
-                    window.dispatchEvent(new CustomEvent('stockwhisperer-refresh'));
-                });
-            }
-        },
-
-        // 显示加载状态
-        showLoading() {
-            if (!this.currentPanel) {
-                this.createPredictionPanel();
-            }
-
-            const content = this.currentPanel.querySelector('.panel-content');
-            content.innerHTML = `
-                <div class="loading-container">
-                    <div class="loading-spinner"></div>
-                    <div class="loading-text">AI正在分析中...</div>
-                </div>
-            `;
-        },
-
-        // 注入样式
-        injectStyles() {
-            if (document.getElementById('stockwhisperer-styles')) return;
-
-            const styles = `
-                <style id="stockwhisperer-styles">
-                    /* 主面板样式 */
-                    .stockwhisperer-panel {
-                        position: fixed;
-                        top: 100px;
-                        right: 20px;
-                        width: ${CONFIG.PANEL_WIDTH}px;
-                        max-height: 80vh;
-                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-                        border-radius: 12px;
-                        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
-                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
-                        z-index: 10000;
-                        overflow: hidden;
-                        animation: slideIn 0.3s ease-out;
-                    }
-
-                    @keyframes slideIn {
-                        from {
-                            transform: translateX(400px);
-                            opacity: 0;
-                        }
-                        to {
-                            transform: translateX(0);
-                            opacity: 1;
-                        }
-                    }
-
-                    @keyframes slideOut {
-                        from {
-                            transform: translateX(0);
-                            opacity: 1;
-                        }
-                        to {
-                            transform: translateX(400px);
-                            opacity: 0;
-                        }
-                    }
-
-                    /* 标题栏 */
-                    .panel-header {
-                        background: rgba(255,255,255,0.1);
-                        backdrop-filter: blur(10px);
-                        padding: 12px 16px;
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                        border-bottom: 1px solid rgba(255,255,255,0.1);
-                    }
-
-                    .panel-title {
-                        display: flex;
-                        align-items: center;
-                        gap: 8px;
-                        color: white;
-                        font-weight: 600;
-                        font-size: 14px;
-                    }
-
-                    .panel-version {
-                        font-size: 10px;
-                        opacity: 0.7;
-                    }
-
-                    .panel-controls {
-                        display: flex;
-                        gap: 8px;
-                    }
-
-                    .panel-controls button {
-                        background: rgba(255,255,255,0.2);
-                        border: none;
-                        width: 28px;
-                        height: 28px;
-                        border-radius: 6px;
-                        cursor: pointer;
-                        font-size: 14px;
-                        transition: all 0.2s;
-                        display: flex;
-                        align-items: center;
-                        justify-content: center;
-                    }
-
-                    .panel-controls button:hover {
-                        background: rgba(255,255,255,0.3);
-                        transform: scale(1.1);
-                    }
-
-                    /* 内容区 */
-                    .panel-content {
-                        background: white;
-                        padding: 16px;
-                        max-height: calc(80vh - 120px);
-                        overflow-y: auto;
-                    }
-
-                    /* 加载状态 */
-                    .loading-container {
-                        display: flex;
-                        flex-direction: column;
-                        align-items: center;
-                        justify-content: center;
-                        padding: 40px 20px;
-                        gap: 16px;
-                    }
-
-                    .loading-spinner {
-                        border: 3px solid #f3f3f3;
-                        border-top: 3px solid #667eea;
-                        border-radius: 50%;
-                        width: 30px;
-                        height: 30px;
-                        animation: spin 1s linear infinite;
-                    }
-
-                    @keyframes spin {
-                        0% { transform: rotate(0deg); }
-                        100% { transform: rotate(360deg); }
-                    }
-
-                    .loading-text {
-                        color: #6c757d;
-                        font-size: 14px;
-                    }
-
-                    /* 价格卡片 */
-                    .price-card {
-                        margin-bottom: 16px;
-                        padding: 12px;
-                        background: #f8f9fa;
-                        border-radius: 8px;
-                    }
-
-                    .price-row {
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                        padding: 8px 0;
-                    }
-
-                    .price-row .label {
-                        color: #6c757d;
-                        font-size: 13px;
-                    }
-
-                    .price-row .value {
-                        font-weight: 600;
-                        font-size: 15px;
-                    }
-
-                    .trend-up .value {
-                        color: #dc3545;
-                    }
-
-                    .trend-down .value {
-                        color: #28a745;
-                    }
-
-                    .trend-neutral .value {
-                        color: #6c757d;
-                    }
-
-                    .price-row .change {
-                        font-size: 12px;
-                        margin-left: 4px;
-                    }
-
-                    /* 原因分析 */
-                    .reason-analysis {
-                        margin-bottom: 16px;
-                    }
-
-                    .analysis-title {
-                        display: flex;
-                        align-items: center;
-                        gap: 6px;
-                        font-weight: 600;
-                        margin-bottom: 12px;
-                        color: #212529;
-                        font-size: 14px;
-                    }
-
-                    .analysis-item {
-                        margin-bottom: 12px;
-                        padding: 10px;
-                        background: #f8f9fa;
-                        border-radius: 6px;
-                    }
-
-                    .badge {
-                        display: inline-block;
-                        padding: 2px 8px;
-                        border-radius: 4px;
-                        font-size: 11px;
-                        font-weight: 500;
-                    }
-
-                    .badge.technical {
-                        background: #e7f3ff;
-                        color: #0066cc;
-                    }
-
-                    .badge.fundamental {
-                        background: #fff4e6;
-                        color: #ff6600;
-                    }
-
-                    .badge.sentiment {
-                        background: #e8f5e9;
-                        color: #2e7d32;
-                    }
-
-                    .badge.news {
-                        background: #f3e5f5;
-                        color: #7b1fa2;
-                    }
-
-                    .item-content {
-                        margin-top: 8px;
-                        font-size: 12px;
-                        line-height: 1.6;
-                        color: #495057;
-                    }
-
-                    .news-list {
-                        list-style: none;
-                        padding: 0;
-                        margin: 0;
-                    }
-
-                    .news-list li {
-                        padding: 4px 0;
-                    }
-
-                    .news-list a {
-                        color: #0066cc;
-                        text-decoration: none;
-                        font-size: 12px;
-                    }
-
-                    .news-list a:hover {
-                        text-decoration: underline;
-                    }
-
-                    /* 投资建议 */
-                    .suggestion-card {
-                        background: #f8f9fa;
-                        border-radius: 8px;
-                        padding: 12px;
-                    }
-
-                    .suggestion-header {
-                        display: flex;
-                        align-items: center;
-                        gap: 8px;
-                        font-weight: 600;
-                        margin-bottom: 12px;
-                        padding: 8px;
-                        border-radius: 6px;
-                        font-size: 13px;
-                    }
-
-                    .suggestion-buy {
-                        background: #d4edda;
-                        color: #155724;
-                    }
-
-                    .suggestion-hold {
-                        background: #fff3cd;
-                        color: #856404;
-                    }
-
-                    .suggestion-sell {
-                        background: #f8d7da;
-                        color: #721c24;
-                    }
-
-                    .suggestion-details {
-                        display: flex;
-                        flex-direction: column;
-                        gap: 8px;
-                    }
-
-                    .detail-row {
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                        font-size: 12px;
-                    }
-
-                    .detail-row .label {
-                        color: #6c757d;
-                    }
-
-                    .confidence-bar {
-                        display: flex;
-                        align-items: center;
-                        gap: 8px;
-                        flex: 1;
-                        max-width: 200px;
-                    }
-
-                    .confidence-fill {
-                        height: 6px;
-                        background: linear-gradient(90deg, #ffc107, #28a745);
-                        border-radius: 3px;
-                        transition: width 0.5s ease;
-                    }
-
-                    .confidence-text {
-                        font-size: 11px;
-                        color: #495057;
-                        font-weight: 600;
-                    }
-
-                    /* 错误状态 */
-                    .error-container {
-                        display: flex;
-                        flex-direction: column;
-                        align-items: center;
-                        justify-content: center;
-                        padding: 40px 20px;
-                        gap: 16px;
-                    }
-
-                    .error-icon {
-                        font-size: 48px;
-                    }
-
-                    .error-message {
-                        color: #dc3545;
-                        text-align: center;
-                        font-size: 13px;
-                    }
-
-                    .error-retry {
-                        background: #667eea;
-                        color: white;
-                        border: none;
-                        padding: 8px 24px;
-                        border-radius: 6px;
-                        cursor: pointer;
-                        font-size: 13px;
-                        transition: all 0.2s;
-                    }
-
-                    .error-retry:hover {
-                        background: #5568d3;
-                        transform: scale(1.05);
-                    }
-
-                    /* 底部栏 */
-                    .panel-footer {
-                        background: rgba(255,255,255,0.1);
-                        backdrop-filter: blur(10px);
-                        padding: 10px 16px;
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                        font-size: 10px;
-                        color: rgba(255,255,255,0.8);
-                        flex-wrap: wrap;
-                        gap: 8px;
-                    }
-
-                    /* 滚动条美化 */
-                    .panel-content::-webkit-scrollbar {
-                        width: 6px;
-                    }
-
-                    .panel-content::-webkit-scrollbar-track {
-                        background: #f1f1f1;
-                        border-radius: 3px;
-                    }
-
-                    .panel-content::-webkit-scrollbar-thumb {
-                        background: #888;
-                        border-radius: 3px;
-                    }
-
-                    .panel-content::-webkit-scrollbar-thumb:hover {
-                        background: #555;
-                    }
-
-                    /* 数据确认界面 */
-                    .confirm-container {
-                        padding: 10px 0;
-                    }
-
-                    .confirm-header {
-                        text-align: center;
-                        margin-bottom: 20px;
-                    }
-
-                    .confirm-title {
-                        font-size: 18px;
-                        font-weight: 600;
-                        color: #212529;
-                        margin-bottom: 8px;
-                    }
-
-                    .confirm-subtitle {
-                        font-size: 13px;
-                        color: #6c757d;
-                    }
-
-                    .data-display {
-                        background: #f8f9fa;
-                        border-radius: 8px;
-                        padding: 16px;
-                        margin-bottom: 20px;
-                    }
-
-                    .data-row {
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                        padding: 10px 0;
-                        border-bottom: 1px solid #e9ecef;
-                    }
-
-                    .data-row:last-child {
-                        border-bottom: none;
-                    }
-
-                    .data-row.highlight {
-                        background: #e7f3ff;
-                        margin: 8px -16px;
-                        padding: 12px 16px;
-                        border-radius: 6px;
-                    }
-
-                    .data-label {
-                        font-size: 13px;
-                        color: #6c757d;
-                        font-weight: 500;
-                    }
-
-                    .data-value {
-                        font-size: 14px;
-                        color: #212529;
-                        font-weight: 600;
-                    }
-
-                    .price-value {
-                        font-size: 20px;
-                        color: #667eea;
-                    }
-
-                    .trend-up {
-                        color: #dc3545;
-                    }
-
-                    .trend-down {
-                        color: #28a745;
-                    }
-
-                    .confirm-actions {
-                        display: flex;
-                        flex-direction: column;
-                        gap: 10px;
-                        margin-bottom: 16px;
-                    }
-
-                    .btn-confirm {
-                        display: flex;
-                        align-items: center;
-                        justify-content: center;
-                        gap: 8px;
-                        width: 100%;
-                        padding: 12px 20px;
-                        border: none;
-                        border-radius: 8px;
-                        font-size: 14px;
-                        font-weight: 600;
-                        cursor: pointer;
-                        transition: all 0.2s;
-                    }
-
-                    .btn-primary {
-                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-                        color: white;
-                    }
-
-                    .btn-primary:hover {
-                        transform: translateY(-2px);
-                        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
-                    }
-
-                    .btn-secondary {
-                        background: #f8f9fa;
-                        color: #6c757d;
-                        border: 1px solid #dee2e6;
-                    }
-
-                    .btn-secondary:hover {
-                        background: #e9ecef;
-                        transform: translateY(-1px);
-                    }
-
-                    .confirm-tip {
-                        text-align: center;
-                        font-size: 12px;
-                        color: #6c757d;
-                        padding: 12px;
-                        background: #fff3cd;
-                        border-radius: 6px;
-                        border: 1px solid #ffc107;
-                    }
-
-                    /* 调整大小手柄 */
-                    .resize-handle {
-                        position: absolute;
-                        top: 0;
-                        left: 0;
-                        width: 4px;
-                        height: 100%;
-                        background: rgba(255, 255, 255, 0.1);
-                        cursor: ew-resize;
-                        transition: background 0.2s;
-                    }
-
-                    .resize-handle:hover {
-                        background: rgba(255, 255, 255, 0.3);
-                    }
-
-                    .resize-handle:active {
-                        background: rgba(255, 255, 255, 0.5);
-                    }
-
-                    /* 最小化按钮 */
-                    .btn-minimize {
-                        display: flex;
-                        align-items: center;
-                        justify-content: center;
-                    }
-
-                    .stockwhisperer-panel.minimized {
-                        width: auto !important;
-                    }
-
-                    .stockwhisperer-panel.minimized .panel-content,
-                    .stockwhisperer-panel.minimized .panel-footer,
-                    .stockwhisperer-panel.minimized .resize-handle {
-                        display: none;
-                    }
-
-                    /* 响应式 */
-                    @media (max-width: 768px) {
-                        .stockwhisperer-panel {
-                            width: calc(100vw - 40px) !important;
-                            right: 20px !important;
-                            left: 20px !important;
-                        }
-
-                        .resize-handle {
-                            display: none;
-                        }
-                    }
-
-                    @media (max-width: 480px) {
-                        .stockwhisperer-panel {
-                            top: 60px !important;
-                            width: calc(100vw - 20px) !important;
-                            right: 10px !important;
-                            left: 10px !important;
-                        }
-                    }
-                </style>
-            `;
-
-            document.head.insertAdjacentHTML('beforeend', styles);
-        },
-
-        // 绑定事件
-        bindEvents(panel) {
-            // 关闭按钮
-            const closeBtn = panel.querySelector('.btn-close');
-            closeBtn?.addEventListener('click', () => {
-                panel.style.animation = 'slideOut 0.3s ease-out';
-                setTimeout(() => {
-                    panel.remove();
-                    this.currentPanel = null;
-                }, 300);
-            });
-
-            // 刷新按钮
-            const refreshBtn = panel.querySelector('.btn-refresh');
-            refreshBtn?.addEventListener('click', () => {
-                window.dispatchEvent(new CustomEvent('stockwhisperer-refresh'));
-            });
-
-            // 设置按钮
-            const settingsBtn = panel.querySelector('.btn-settings');
-            settingsBtn?.addEventListener('click', () => {
-                this.showSettingsDialog();
-            });
-
-            // 最小化按钮
-            const minimizeBtn = panel.querySelector('.btn-minimize');
-            minimizeBtn?.addEventListener('click', () => {
-                panel.classList.toggle('minimized');
-                minimizeBtn.textContent = panel.classList.contains('minimized') ? '+' : '−';
-            });
-        },
-
-        // 显示设置对话框
-        showSettingsDialog() {
-            // 移除旧的对话框
-            const oldDialog = document.getElementById('stockwhisperer-settings');
-            if (oldDialog) {
-                oldDialog.remove();
-            }
-
-            const dialog = document.createElement('div');
-            dialog.id = 'stockwhisperer-settings';
-            dialog.innerHTML = `
-                <div class="settings-overlay">
-                    <div class="settings-dialog">
-                        <div class="settings-header">
-                            <h3>⚙️ API设置</h3>
-                            <button class="btn-close">×</button>
-                        </div>
-                        <div class="settings-content">
-                            <div class="setting-group">
-                                <label>API提供商</label>
-                                <select id="provider-select">
-                                    <option value="deepseek">DeepSeek (推荐)</option>
-                                    <option value="openai">OpenAI GPT-4</option>
-                                </select>
-                            </div>
-                            <div class="setting-group">
-                                <label>API Key</label>
-                                <input type="password" id="api-key-input" placeholder="请输入API Key">
-                                <small>您的API Key将安全保存在本地浏览器中</small>
-                            </div>
-                            <div class="setting-help">
-                                <p>📌 获取API Key:</p>
-                                <ul>
-                                    <li><a href="https://www.deepseek.com/" target="_blank">DeepSeek</a> - 高性价比中文模型</li>
-                                    <li><a href="https://platform.openai.com/" target="_blank">OpenAI</a> - GPT-4</li>
-                                </ul>
-                            </div>
-                        </div>
-                        <div class="settings-footer">
-                            <button class="btn-cancel">取消</button>
-                            <button class="btn-save">保存</button>
-                        </div>
-                    </div>
-                </div>
-            `;
-
-            // 注入样式
-            this.injectSettingsStyles();
-
-            // 绑定事件
-            this.bindSettingsEvents(dialog);
-
-            document.body.appendChild(dialog);
-        },
-
-        // 注入设置对话框样式
-        injectSettingsStyles() {
-            if (document.getElementById('stockwhisperer-settings-styles')) return;
-
-            const styles = `
-                <style id="stockwhisperer-settings-styles">
-                    .settings-overlay {
-                        position: fixed;
-                        top: 0;
-                        left: 0;
-                        right: 0;
-                        bottom: 0;
-                        background: rgba(0,0,0,0.5);
-                        display: flex;
-                        align-items: center;
-                        justify-content: center;
-                        z-index: 10002;
-                        animation: fadeIn 0.2s ease-out;
-                    }
-
-                    @keyframes fadeIn {
-                        from { opacity: 0; }
-                        to { opacity: 1; }
-                    }
-
-                    .settings-dialog {
-                        background: white;
-                        border-radius: 12px;
-                        width: 90%;
-                        max-width: 500px;
-                        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
-                        animation: slideUp 0.3s ease-out;
-                    }
-
-                    @keyframes slideUp {
-                        from {
-                            transform: translateY(50px);
-                            opacity: 0;
-                        }
-                        to {
-                            transform: translateY(0);
-                            opacity: 1;
-                        }
-                    }
-
-                    .settings-header {
-                        padding: 20px;
-                        border-bottom: 1px solid #e9ecef;
-                        display: flex;
-                        justify-content: space-between;
-                        align-items: center;
-                    }
-
-                    .settings-header h3 {
-                        margin: 0;
-                        font-size: 18px;
-                        color: #212529;
-                    }
-
-                    .settings-header .btn-close {
-                        background: none;
-                        border: none;
-                        font-size: 24px;
-                        cursor: pointer;
-                        color: #6c757d;
-                        width: 32px;
-                        height: 32px;
-                        display: flex;
-                        align-items: center;
-                        justify-content: center;
-                        border-radius: 6px;
-                        transition: all 0.2s;
-                    }
-
-                    .settings-header .btn-close:hover {
-                        background: #f8f9fa;
-                        color: #212529;
-                    }
-
-                    .settings-content {
-                        padding: 20px;
-                    }
-
-                    .setting-group {
-                        margin-bottom: 20px;
-                    }
-
-                    .setting-group label {
-                        display: block;
-                        margin-bottom: 8px;
-                        font-weight: 600;
-                        color: #495057;
-                        font-size: 14px;
-                    }
-
-                    .setting-group select,
-                    .setting-group input {
-                        width: 100%;
-                        padding: 10px;
-                        border: 1px solid #ced4da;
-                        border-radius: 6px;
-                        font-size: 14px;
-                        box-sizing: border-box;
-                        transition: border-color 0.2s;
-                    }
-
-                    .setting-group select:focus,
-                    .setting-group input:focus {
-                        outline: none;
-                        border-color: #667eea;
-                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
-                    }
-
-                    .setting-group small {
-                        display: block;
-                        margin-top: 4px;
-                        color: #6c757d;
-                        font-size: 11px;
-                    }
-
-                    .setting-help {
-                        background: #f8f9fa;
-                        padding: 12px;
-                        border-radius: 6px;
-                        font-size: 12px;
-                    }
-
-                    .setting-help p {
-                        margin: 0 0 8px 0;
-                        font-weight: 600;
-                        color: #495057;
-                    }
-
-                    .setting-help ul {
-                        margin: 0;
-                        padding-left: 20px;
-                    }
-
-                    .setting-help li {
-                        margin-bottom: 4px;
-                    }
-
-                    .setting-help a {
-                        color: #667eea;
-                        text-decoration: none;
-                    }
-
-                    .setting-help a:hover {
-                        text-decoration: underline;
-                    }
-
-                    .settings-footer {
-                        padding: 16px 20px;
-                        border-top: 1px solid #e9ecef;
-                        display: flex;
-                        justify-content: flex-end;
-                        gap: 12px;
-                    }
-
-                    .settings-footer button {
-                        padding: 10px 24px;
-                        border-radius: 6px;
-                        font-size: 14px;
-                        font-weight: 600;
-                        cursor: pointer;
-                        transition: all 0.2s;
-                        border: none;
-                    }
-
-                    .btn-cancel {
-                        background: #f8f9fa;
-                        color: #6c757d;
-                    }
-
-                    .btn-cancel:hover {
-                        background: #e9ecef;
-                    }
-
-                    .btn-save {
-                        background: #667eea;
-                        color: white;
-                    }
-
-                    .btn-save:hover {
-                        background: #5568d3;
-                        transform: scale(1.05);
-                    }
-                </style>
-            `;
-
-            document.head.insertAdjacentHTML('beforeend', styles);
-        },
-
-        // 绑定设置对话框事件
-        async bindSettingsEvents(dialog) {
-            const overlay = dialog.querySelector('.settings-overlay');
-            const closeBtn = dialog.querySelector('.settings-header .btn-close');
-            const cancelBtn = dialog.querySelector('.btn-cancel');
-            const saveBtn = dialog.querySelector('.btn-save');
-
-            // 加载当前配置
-            const currentProvider = await StorageModule.config.getCurrentProvider();
-            const config = await StorageModule.config.getApiConfig(currentProvider);
-
-            const providerSelect = dialog.querySelector('#provider-select');
-            const apiKeyInput = dialog.querySelector('#api-key-input');
-
-            providerSelect.value = currentProvider;
-            if (config && config.apiKey) {
-                apiKeyInput.value = config.apiKey;
-            }
-
-            // 关闭对话框
-            const closeDialog = () => {
-                overlay.remove();
-            };
-
-            closeBtn.addEventListener('click', closeDialog);
-            cancelBtn.addEventListener('click', closeDialog);
-            overlay.addEventListener('click', (e) => {
-                if (e.target === overlay) {
-                    closeDialog();
-                }
-            });
-
-            // 保存配置
-            saveBtn.addEventListener('click', async () => {
-                const provider = providerSelect.value;
-                const apiKey = apiKeyInput.value.trim();
-
-                if (!apiKey) {
-                    alert('请输入API Key');
-                    return;
-                }
-
-                await StorageModule.config.setApiConfig(provider, apiKey);
-                await StorageModule.config.setCurrentProvider(provider);
-
-                alert('设置已保存');
-
-                closeDialog();
-
-                // 刷新预测
-                window.dispatchEvent(new CustomEvent('stockwhisperer-refresh'));
-            });
-        }
-    };
-
-    // ==================== 数据提取模块 ====================
-    const DataExtractor = {
-        // 从URL提取股票代码
-        extractStockCodeFromURL() {
-            const url = window.location.href;
-
-            // 支持多种东方财富URL格式：
-            // 1. A股: quote.eastmoney.com/SZ000001.html 或 SH600000.html
-            // 2. 科创板: quote.eastmoney.com/kcb/688981.html
-            // 3. 港股: quote.eastmoney.com/hk/00981.html
-
-            // 模式1: A股 (SZ/SH + 6位数字)
-            const aShareMatch = url.match(/\/(SZ|SH)(\d{6})\.html/);
-            if (aShareMatch) {
-                console.log('[DataExtractor] 提取A股代码:', aShareMatch[1], aShareMatch[2]);
-                return {
-                    market: aShareMatch[1], // SZ 或 SH
-                    code: aShareMatch[2],   // 6位数字代码
-                    type: 'stock'           // A股
-                };
-            }
-
-            // 模式2: 科创板 (kcb/ + 6位数字)
-            const kcbMatch = url.match(/\/kcb\/(\d{6})\.html/);
-            if (kcbMatch) {
-                console.log('[DataExtractor] 提取科创板代码:', kcbMatch[1]);
-                return {
-                    market: 'KCB',          // 科创板市场标识
-                    code: kcbMatch[1],      // 6位数字代码
-                    type: 'kcb_stock'       // 科创板
-                };
-            }
-
-            // 模式3: 港股 (hk/ + 5位及以上数字)
-            const hkStockMatch = url.match(/\/hk\/(\d{5,})\.html/);
-            if (hkStockMatch) {
-                console.log('[DataExtractor] 提取港股代码:', hkStockMatch[1]);
-                return {
-                    market: 'HK',           // 港股市场标识
-                    code: hkStockMatch[1],  // 5位及以上数字代码
-                    type: 'hk_stock'        // 港股
-                };
-            }
-
-            // 模式4: 通用格式 (任意路径 + 数字代码)
-            const generalMatch = url.match(/\/.*\/(\d{5,})\.html/);
-            if (generalMatch) {
-                console.log('[DataExtractor] 提取通用代码:', generalMatch[1]);
-                return {
-                    market: 'OTHER',        // 其他市场
-                    code: generalMatch[1],  // 5位及以上数字代码
-                    type: 'other'           // 其他类型
-                };
-            }
-
-            console.warn('[DataExtractor] 无法从URL提取股票代码:', url);
-            return null;
-        },
-
-        // 从DOM提取股票数据 - 严格模式
-        extractStockDataFromDOM() {
-            try {
-                console.log('[DataExtractor] 开始从DOM提取股票数据...');
-
-                const stockInfo = this.extractStockCodeFromURL();
-                if (!stockInfo) {
-                    throw new Error('无法从URL提取股票代码');
-                }
-
-                console.log('[DataExtractor] 股票信息:', stockInfo);
-
-                // ==================== 股票名称提取 ====================
-                let name = '';
-                const titleMatch = document.title.match(/^(.+?)(?:\(|（|\s)/);
-                if (titleMatch) {
-                    name = titleMatch[1].trim();
-                    console.log('[DataExtractor] 从标题提取股票名称:', name);
-                } else {
-                    throw new Error('无法从页面标题提取股票名称');
-                }
-
-                // ==================== 价格提取 - 严格模式 ====================
-                let currentPrice = 0;
-                let changePercent = 0;
-                let volume = 0;
-
-                // 查找价格元素 - 精确定位个股价格
-                const code = stockInfo.code; // 例如: 688981, 603719
-                console.log('[DataExtractor] 查找股票代码', code, '对应的价格元素');
-
-                // 策略1: 科创板使用 .zs_brief 容器
-                let priceEl = null;
-                let containerInfo = '';
-                let priceContainer = null; // 保存容器引用,用于后续查找涨跌幅
-
-                if (stockInfo.market === 'KCB') {
-                    // 科创板: 在 .zs_brief 容器中查找
-                    priceContainer = document.querySelector('.zs_brief, .zsquote3l');
-                    if (priceContainer) {
-                        priceEl = priceContainer.querySelector('.price_up, .price_down, [class*="price_up"], [class*="price_down"]');
-                        if (priceEl) {
-                            containerInfo = '科创板容器: .zs_brief';
-                            console.log('[DataExtractor] 在科创板容器中找到价格元素');
-                        }
-                    }
-                }
-
-                // 策略2: 如果科创板策略失败,尝试通过股票代码容器查找
-                if (!priceEl) {
-                    const possibleContainers = [
-                        `#${code}`,           // 直接使用代码: #688981, #603719
-                        `#sh${code}`,         // 上海前缀: #sh603719
-                        `#sz${code}`,         // 深圳前缀: #sz688981
-                        `#kcb${code}`,        // 科创板前缀: #kcb688981
-                        `[id*="${code}"]`     // 任意包含代码的ID
-                    ];
-
-                    for (const containerSelector of possibleContainers) {
-                        const container = document.querySelector(containerSelector);
-                        if (container) {
-                            console.log('[DataExtractor] 找到容器:', containerSelector);
-                            // 在容器内查找价格元素
-                            priceEl = container.querySelector('.price_up, .price_down, [class*="price_up"], [class*="price_down"]');
-                            if (priceEl) {
-                                containerInfo = `容器: ${containerSelector}`;
-                                priceContainer = container; // 保存容器引用
-                                break;
-                            }
-                        }
-                    }
-                }
-
-                // 策略3: 最后的兜底 - 全局查找(警告可能不准确)
-                if (!priceEl) {
-                    console.warn('[DataExtractor] 在特定容器内未找到价格元素,尝试全局查找(可能不准确)');
-                    const fallbackSelectors = [
-                        '.new_price',
-                        '.price_up',
-                        '.price_down'
-                    ];
-                    for (const selector of fallbackSelectors) {
-                        priceEl = document.querySelector(selector);
-                        if (priceEl) {
-                            containerInfo = `全局查找: ${selector} (警告: 可能不是个股价格)`;
-                            console.warn('[DataExtractor] ⚠️ 使用全局查找,可能提取到错误价格!');
-                            break;
-                        }
-                    }
-                }
-
-                if (priceEl) {
-                    const text = priceEl.textContent.trim();
-                    console.log('[DataExtractor] 找到价格元素, ', containerInfo, '内容:', text);
-
-                    // 提取价格 (格式: "122.40" 或 "122.40-4.78%")
-                    const priceMatch = text.match(/^(\d+\.\d+)/);
-                    if (priceMatch) {
-                        currentPrice = parseFloat(priceMatch[1]);
-                        console.log('[DataExtractor] 提取到价格:', currentPrice);
-                    } else {
-                        throw new Error('价格元素内容格式不正确: ' + text);
-                    }
-                } else {
-                    throw new Error('未找到价格元素');
-                }
-
-                // ==================== 涨跌幅提取 ====================
-                // 在容器内单独查找涨跌幅元素
-                if (priceContainer && changePercent === 0) {
-                    console.log('[DataExtractor] 在容器内查找涨跌幅元素');
-
-                    // 使用 .zd 元素(东方财富标准)
-                    const changeEl = priceContainer.querySelector('.zd');
-                    if (changeEl) {
-                        const text = changeEl.textContent.trim();
-                        console.log('[DataExtractor] 找到.zd元素, 内容:', text);
-
-                        // 提取涨跌幅 (支持整数和小数: -5% 或 -4.78%)
-                        const changeMatch = text.match(/([+-]?\d+\.?\d*)%/);
-                        if (changeMatch) {
-                            changePercent = parseFloat(changeMatch[1]);
-                            console.log('[DataExtractor] ✅ 提取到涨跌幅:', changePercent);
-                        } else {
-                            console.log('[DataExtractor] .zd元素中未找到百分比格式');
-                        }
-                    } else {
-                        console.log('[DataExtractor] 未找到.zd元素');
-                    }
-                }
-
-                // 如果容器内没找到,尝试从价格元素本身提取
-                if (changePercent === 0 && priceEl) {
-                    const text = priceEl.textContent.trim();
-                    const changeMatch = text.match(/([+-]?\d+\.?\d*)%/);
-                    if (changeMatch) {
-                        changePercent = parseFloat(changeMatch[1]);
-                        console.log('[DataExtractor] 从价格元素提取涨跌幅:', changePercent);
-                    }
-                }
-
-                // ==================== 数据验证 ====================
-                // 严格验证价格数据
-                if (!currentPrice || isNaN(currentPrice) || currentPrice <= 0) {
-                    throw new Error('提取的价格无效: ' + currentPrice + ', 价格必须大于0');
-                }
-
-                if (currentPrice >= 1000) {
-                    // 价格 >= 1000 必须有小数部分,否则可能是大盘指数
-                    if (currentPrice % 1 === 0) {
-                        throw new Error('提取的价格 ' + currentPrice + ' 疑似大盘指数(整数且>=1000),请检查页面元素');
-                    }
-                }
-
-                // 涨跌幅验证
-                if (changePercent !== 0 && Math.abs(changePercent) > 25) {
-                    console.warn('[DataExtractor] 警告: 涨跌幅异常 (' + changePercent + '%), 可能不是涨跌幅数据');
-                }
-
-                // ==================== 成交量提取（可选） ====================
-                // 在 .zs_brief 容器中查找 .price_draw 元素(blinkgreen或blinkblue)
-                if (priceContainer) {
-                    // 先尝试 blinkgreen,再尝试 blinkblue
-                    let volumeEl = priceContainer.querySelector('.price_draw.blinkgreen');
-                    if (!volumeEl) {
-                        volumeEl = priceContainer.querySelector('.price_draw.blinkblue');
-                    }
-
-                    if (volumeEl) {
-                        const text = volumeEl.textContent.replace(/,/g, '').trim();
-                        console.log('[DataExtractor] 找到成交量元素, 内容:', text);
-                        // 提取数字(可能包含单位 如"万"、"手"等)
-                        const match = text.match(/(\d+(?:\.\d+)?)/);
-                        if (match) {
-                            volume = parseFloat(match[1]);
-                            console.log('[DataExtractor] ✅ 提取到成交量:', volume);
-                        }
-                    } else {
-                        console.log('[DataExtractor] 在容器内未找到.price_draw元素');
-                    }
-                }
-
-                // 如果上面没找到,尝试通用方法
-                if (volume === 0) {
-                    const volumeEl = document.querySelector('[class*="volume"]');
-                    if (volumeEl) {
-                        const text = volumeEl.textContent.replace(/,/g, '').trim();
-                        const match = text.match(/(\d+(?:\.\d+)?)/);
-                        if (match) {
-                            volume = parseFloat(match[1]);
-                            console.log('[DataExtractor] 通过通用方法提取成交量:', volume);
-                        }
-                    }
-                }
-
-                // ==================== 构建结果 ====================
-                const result = {
-                    code: stockInfo.code,
-                    name: name,
-                    market: stockInfo.market,
-                    currentPrice: currentPrice,
-                    openPrice: 0,
-                    closePrice: 0,
-                    highPrice: 0,
-                    lowPrice: 0,
-                    changePercent: changePercent,
-                    volume: volume,
-                    timestamp: Date.now()
-                };
-
-                console.log('[DataExtractor] ✅ 数据提取成功:', result);
-                return result;
-
-            } catch (error) {
-                console.error('[DataExtractor] ❌ 数据提取失败:', error.message);
-                console.error('[DataExtractor] 错误堆栈:', error.stack);
-                return null;
-            }
-        },
-
-
-        // 智能提取（严格模式）
-        async smartExtractStockData() {
-            // 从URL和DOM提取数据
-            let data = this.extractStockDataFromDOM();
-
-
-            // 数据验证
-            if (!data || !data.code || !data.currentPrice || data.currentPrice <= 0) {
-                throw new Error(ErrorHandler.ErrorTypes.EXTRACTION_FAILED);
-            }
-
-            return data;
-        }
-    };
-
-    // ==================== 业务逻辑层 ====================
-    const App = {
-        // 是否正在加载
-        isLoading: false,
-
-        // 刷新事件处理器
-        _refreshHandler: null,
-
-        // 移除刷新事件监听器
-        removeRefreshListener() {
-            if (this._refreshHandler) {
-                window.removeEventListener('stockwhisperer-refresh', this._refreshHandler);
-                this._refreshHandler = null;
-            }
-        },
-
-        // 初始化
-        async init() {
-            console.log('[StockWhisperer] ==================== 脚本初始化开始 ====================');
-            console.log('[StockWhisperer] 脚本已加载');
-            console.log('[StockWhisperer] Tampermonkey API 可用:', typeof GM_xmlhttpRequest !== 'undefined');
-
-            // 检查页面类型
-            const pageType = this.detectPageType();
-
-            // 只在股票详情页运行
-            if (pageType !== 'stock_detail') {
-                console.log('[StockWhisperer] 非股票详情页，跳过');
-                console.log('[StockWhisperer] 页面类型:', pageType);
-                this.showDebugInfo('当前页面不是股票详情页，脚本不会运行');
-                return;
-            }
-
-            console.log('[StockWhisperer] 确认为股票详情页，继续执行');
-
-            // 等待页面加载完成
-            console.log('[StockWhisperer] 等待页面加载完成...');
-            await this.waitForPageReady();
-            console.log('[StockWhisperer] 页面加载完成');
-
-            // 检查API配置
-            const provider = await StorageModule.config.getCurrentProvider();
-            const config = await StorageModule.config.getApiConfig(provider);
-
-            console.log('[StockWhisperer] API提供商:', provider);
-            console.log('[StockWhisperer] API配置存在:', !!config);
-            console.log('[StockWhisperer] API Key存在:', !!(config && config.apiKey));
-
-            if (!config || !config.apiKey) {
-                // 如果没有配置，显示设置对话框
-                console.log('[StockWhisperer] 未配置API Key，显示设置面板');
-                // 创建面板但不加载数据
-                UIModule.createPredictionPanel();
-                UIModule.showError('请先配置API Key才能使用AI预测功能');
-                return;
-            }
-
-            // 执行主逻辑
-            console.log('[StockWhisperer] 开始执行主逻辑');
-            await this.main();
-
-            // 修复：防止重复绑定刷新事件
-            this.removeRefreshListener();
-            const refreshHandler = Utils.debounce(() => {
-                this.main();
-            }, 1000);
-            window.addEventListener('stockwhisperer-refresh', refreshHandler);
-            this._refreshHandler = refreshHandler;
-
-            // 监听数据确认事件
-            window.addEventListener('stockwhisperer-data-confirmed', (e) => {
-                const stockData = e.detail;
-                console.log('[StockWhisperer] 用户确认数据:', stockData);
-                this.executePrediction(stockData);
-            });
-
-            console.log('[StockWhisperer] ==================== 脚本初始化完成 ====================');
-        },
-
-        // 显示调试信息
-        showDebugInfo(message) {
-            // 在页面右上角显示调试信息（10秒后自动消失）
-            const debugDiv = document.createElement('div');
-            debugDiv.style.cssText = `
-                position: fixed;
-                top: 20px;
-                left: 20px;
-                background: rgba(0,0,0,0.8);
-                color: white;
-                padding: 12px 16px;
-                border-radius: 8px;
-                font-size: 12px;
-                z-index: 99999;
-                max-width: 300px;
-                font-family: monospace;
-            `;
-            debugDiv.innerHTML = `
-                <div style="font-weight: bold; margin-bottom: 4px;">🔧 StockWhisperer Debug</div>
-                <div>${message}</div>
-                <div style="margin-top: 8px; font-size: 10px; opacity: 0.7;">URL: ${window.location.href}</div>
-            `;
-            document.body.appendChild(debugDiv);
-            setTimeout(() => debugDiv.remove(), 10000);
-        },
-
-        // 检测页面类型
-        detectPageType() {
-            const url = window.location.href;
-            console.log('[StockWhisperer] 当前URL:', url);
-
-            // 支持多种东方财富URL格式：
-            // 1. A股: quote.eastmoney.com/SZ000001.html 或 quote.eastmoney.com/SH600000.html
-            // 2. 科创板: quote.eastmoney.com/kcb/688981.html
-            // 3. 港股: quote.eastmoney.com/hk/00981.html
-            // 4. 其他: quote.eastmoney.com/******.html (只要是5位以上数字ID)
-
-            const patterns = [
-                /quote\.eastmoney\.com\/(SZ|SH)\d{6}\.html/, // A股 (SZ000001, SH600000)
-                /quote\.eastmoney\.com\/kcb\/\d+\.html/,       // 科创板 (kcb/688981)
-                /quote\.eastmoney\.com\/hk\/\d{5,}\.html/,     // 港股 (hk/00981)
-                /quote\.eastmoney\.com\/.*\/\d{5,}\.html/       // 通用格式 (其他/123456)
-            ];
-
-            for (let i = 0; i < patterns.length; i++) {
-                if (patterns[i].test(url)) {
-                    console.log(`[StockWhisperer] 检测到股票详情页 (匹配模式${i + 1})`);
-                    return 'stock_detail';
-                }
-            }
-
-            // 列表页
-            if (/quote\.eastmoney\.com\/center\/gridlist\.html/.test(url)) {
-                console.log('[StockWhisperer] 检测到股票列表页');
-                return 'stock_list';
-            }
-
-            console.log('[StockWhisperer] 未知页面类型，URL不匹配任何股票页面模式');
-            return 'unknown';
-        },
-
-        // 等待页面就绪
-        async waitForPageReady() {
-            return new Promise((resolve) => {
-                if (document.readyState === 'complete') {
-                    // 额外等待一些动态内容
-                    setTimeout(resolve, 1000);
-                } else {
-                    window.addEventListener('load', () => {
-                        setTimeout(resolve, 1000);
-                    });
-                }
-            });
-        },
-
-        // 主逻辑
-        async main() {
-            if (this.isLoading) {
-                console.log('[StockWhisperer] 正在加载中，跳过');
-                return;
-            }
-
-            this.isLoading = true;
-
-            try {
-                // 1. 创建UI面板
-                UIModule.createPredictionPanel();
-
-                // 2. 提取股票数据
-                console.log('[StockWhisperer] 提取股票数据...');
-                const stockData = await DataExtractor.smartExtractStockData();
-
-                if (!stockData) {
-                    throw new Error(ErrorHandler.ErrorTypes.EXTRACTION_FAILED);
-                }
-
-                console.log('[StockWhisperer] 股票数据:', stockData);
-
-                // 3. 显示数据确认界面，等待用户确认
-                console.log('[StockWhisperer] 显示数据确认界面');
-                UIModule.showDataConfirmation(stockData);
-
-            } catch (error) {
-                console.error('[StockWhisperer] 主流程错误:', error);
-                ErrorHandler.handle(error, { context: '主流程' });
-                UIModule.showError(error.message || '预测失败，请重试');
-                this.isLoading = false;
-            }
-        },
-
-        // 执行AI预测（在用户确认数据后调用）
-        async executePrediction(stockData) {
-            if (this.isLoading) {
-                console.log('[StockWhisperer] 正在加载中，跳过');
-                return;
-            }
-
-            this.isLoading = true;
-
-            try {
-                // 显示加载状态
-                UIModule.showLoading();
-
-                // 调用AI预测
-                console.log('[StockWhisperer] 开始AI预测...');
-                const predictionResult = await APIModule.predict(stockData);
-
-                console.log('[StockWhisperer] 预测结果:', predictionResult);
-
-                // 显示预测结果
-                UIModule.showPredictionResult(stockData, predictionResult);
-
-            } catch (error) {
-                console.error('[StockWhisperer] AI预测错误:', error);
-                ErrorHandler.handle(error, { context: 'AI预测' });
-                UIModule.showError(error.message || '预测失败，请重试');
-            } finally {
-                this.isLoading = false;
-            }
-        }
-    };
-
-    // ==================== 启动脚本 ====================
-    // 立即执行启动逻辑
-    console.log('[StockWhisperer] 开始启动脚本...');
-    console.log('[StockWhisperer] 当前页面URL:', window.location.href);
-    console.log('[StockWhisperer] 页面状态:', document.readyState);
-
-    // 立即尝试初始化
-    App.init();
-
-    // 同时也在DOMContentLoaded后尝试（防止第一次失败）
-    if (document.readyState === 'loading') {
-        document.addEventListener('DOMContentLoaded', () => {
-            console.log('[StockWhisperer] DOMContentLoaded触发，重新初始化');
-            setTimeout(() => {
-                App.init();
-            }, 1000);
-        });
-    }
-
-    console.log('[StockWhisperer] StockWhisperer v1.0.1 - 倾听股市，洞见未来');
-
-})();
Index: stockwhisperer-test.user.js
===================================================================
diff --git a/stockwhisperer-test.user.js b/stockwhisperer-test.user.js
deleted file mode 100644
--- a/stockwhisperer-test.user.js	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,90 +0,0 @@
-// ==UserScript==
-// @name         东方财富AI预测助手 (StockWhisperer) - 测试版
-// @namespace    http://tampermonkey.net/
-// @version      1.0.1-test
-// @description  AI驱动的股票走势预测和原因分析 - 测试版
-// @author       StockWhisperer
-// @match        *://quote.eastmoney.com/*
-// @match        *://emweb.eastmoney.com/*
-// @grant        GM_xmlhttpRequest
-// @grant        GM_setValue
-// @grant        GM_getValue
-// @grant        GM_deleteValue
-// @grant        GM_addStyle
-// @grant        GM_notification
-// @connect      api.deepseek.com
-// @connect      api.openai.com
-// @run-at       document-start
-// ==/UserScript==
-
-(function() {
-    'use strict';
-
-    // 🚨 立即输出测试信息（使用多种方式）
-    const testLog = '✅ StockWhisperer 脚本已加载！v1.0.1';
-
-    // 方式1: console.log
-    console.log('========================================');
-    console.log(testLog);
-    console.log('URL:', window.location.href);
-    console.log('UserAgent:', navigator.userAgent);
-    console.log('========================================');
-
-    // 方式2: 页面标题（最明显）
-    const originalTitle = document.title;
-    document.title = '🤖 ' + testLog;
-
-    // 方式3: 页面元素（即使DOM未完全加载）
-    try {
-        const testDiv = document.createElement('div');
-        testDiv.id = 'stockwhisperer-test';
-        testDiv.style.cssText = `
-            position: fixed !important;
-            top: 0 !important;
-            left: 0 !important;
-            width: 100% !important;
-            background: red !important;
-            color: white !important;
-            font-size: 20px !important;
-            padding: 10px !important;
-            z-index: 999999 !important;
-            text-align: center !important;
-            font-weight: bold !important;
-        `;
-        testDiv.textContent = '✅ StockWhisperer 脚本正在运行！';
-        document.documentElement.appendChild(testDiv);
-
-        // 3秒后移除
-        setTimeout(() => {
-            testDiv.remove();
-            document.title = originalTitle;
-        }, 3000);
-    } catch (e) {
-        console.error('[测试] 无法创建测试元素:', e);
-    }
-
-    // 方式4: GM_notification（如果可用）
-    if (typeof GM_notification !== 'undefined') {
-        GM_notification({
-            title: 'StockWhisperer',
-            text: '脚本已成功加载！',
-            timeout: 5000
-        });
-    }
-
-    // 方式5: alert（仅在首次加载时）
-    if (!window.stockwhisperer_loaded) {
-        window.stockwhisperer_loaded = true;
-        // 延迟1秒后显示，避免阻塞页面
-        setTimeout(() => {
-            alert('✅ StockWhisperer 脚本已成功加载！\n\n当前URL: ' + window.location.href);
-        }, 1000);
-    }
-
-    console.log('[StockWhisperer] 详细信息:');
-    console.log('- Tampermonkey API GM_xmlhttpRequest:', typeof GM_xmlhttpRequest);
-    console.log('- Tampermonkey API GM_setValue:', typeof GM_setValue);
-    console.log('- document.readyState:', document.readyState);
-    console.log('- location.href:', window.location.href);
-
-})();
Index: CLAUDE.md
===================================================================
diff --git a/CLAUDE.md b/CLAUDE.md
deleted file mode 100644
--- a/CLAUDE.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,380 +0,0 @@
-# CLAUDE.md
-
-This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.
-
-## 项目概述
-
-**StockWhisperer（股语者）** 是一个 AI 驱动的股票预测工具,通过油猴脚本(tampermonkey userscript)的方式在东方财富网页上展示 AI 预测分析。
-
-### 核心特点
-- **轻量级实现**: 单文件油猴脚本 <500 行代码(可选 Python 后端)
-- **AI 驱动**: 使用 LLM API(DeepSeek/GPT-4)进行股票走势预测和原因分析
-- **快速开发**: 采用 AI 辅助开发模式,开发周期 3-5 天
-- **成本低廉**: 完全免费,可选 LLM API 成本 50-200 元/月
-
-### 项目定位
-- MVP 阶段:油猴脚本快速验证
-- 生产阶段:Chrome 插件方案
-- 长期规划:独立应用
-
-## 文档结构
-
-项目包含完整的需求分析和设计文档,位于 `docs/` 目录:
-
-### 核心文档
-- `docs/初始需求.md` - 项目原始需求
-- `docs/需求分析与功能点.md` - 详细功能模块设计
-- `docs/技术方案对比分析_v2.0.md` - 6 种技术方案对比,推荐油猴脚本
-- `docs/油猴脚本方案架构设计_v1.0.md` - 油猴脚本详细架构设计
-- `docs/项目命名方案_v1.0.md` - 项目命名方案(StockWhisperer/股语者)
-
-### 文档阅读优先级
-1. 新手入门: `初始需求.md` → `技术方案对比分析_v2.0.md`
-2. 开发实施: `油猴脚本方案架构设计_v1.0.md`
-3. 功能扩展: `需求分析与功能点.md`
-
-## 技术栈
-
-### 前端(油猴脚本)
-- **语言**: JavaScript ES6+
-- **平台**: Tampermonkey / Violentmonkey
-- **API**: Tampermonkey API (GM_xmlhttpRequest, GM_setValue/getValue)
-- **目标网站**: 东方财富 (quote.eastmoney.com)
-
-### 后端(可选)
-- **语言**: Python 3.11+
-- **框架**: FastAPI
-- **数据源**: efinance / AKShare
-- **LLM**: DeepSeek API / GPT-4 API
-
-### 核心依赖
-- `efinance`: 东方财富数据获取
-- `httpx`: 异步 HTTP 客户端
-- `pydantic`: 数据验证
-
-## 架构设计
-
-### 部署模式
-
-#### 模式1: 纯前端模式(MVP 推荐)
-```
-浏览器 + 油猴脚本 → 直接调用公开 API
-```
-- 无需后端,开箱即用
-- 单文件分发
-- 功能受限(无历史数据)
-
-#### 模式2: 混合模式(生产推荐)
-```
-浏览器 + 油猴脚本 → 本地 Python 服务 → LLM API
-```
-- 功能完整
-- 支持数据缓存
-- 支持批量分析
-
-### 核心模块
-
-油猴脚本由 6 个核心模块组成:
-
-1. **页面检测与注入模块**
-   - 监听页面加载事件
-   - 检测 URL 是否匹配目标网站
-   - 触发脚本主逻辑
-
-2. **数据提取模块**
-   - 从 DOM 提取股票数据
-   - API 调用作为备用
-   - 智能容错机制
-
-3. **UI 渲染模块**
-   - 创建预测面板
-   - 显示原因分析(技术面、基本面、情绪面)
-   - 现代化 CSS 样式
-
-4. **API 调用模块**
-   - 封装 GM_xmlhttpRequest
-   - CORS 处理
-   - 超时重试
-
-5. **本地存储模块**
-   - GM_setValue/GM_getValue 封装
-   - 自选股管理
-   - 配置持久化
-
-6. **工具函数模块**
-   - 数据格式化
-   - 防抖/节流
-   - 日期时间处理
-
-## 数据流
-
-```
-用户访问页面
-  ↓
-页面检测与注入
-  ↓
-数据提取 (DOM 选择器 / API)
-  ↓
-├─ 直接调用 LLM API (纯前端模式)
-└─ 调用本地后端 (混合模式)
-      ↓
-   后端服务
-     - 数据增强
-     - LLM 调用
-     - 结果缓存
-      ↓
-   结果解析
-      ↓
-   UI 渲染
-```
-
-## LLM 集成
-
-### Prompt 工程
-
-**System Prompt**: 定义 AI 为专业股票分析师,要求客观理性、明确不确定性、风险提示
-
-**User Prompt 模板**:
-```javascript
-请分析以下股票:
-
-## 基本信息
-- 股票代码: ${stockData.code}
-- 股票名称: ${stockData.name}
-- 当前价格: ${stockData.currentPrice}元
-...
-
-请从以下维度分析:
-1. 技术面: 技术指标分析
-2. 基本面: 行业和公司分析
-3. 情绪面: 市场情绪分析
-
-请以 JSON 格式返回分析结果。
-```
-
-### 响应格式
-
-```javascript
-{
-  "predictPrice": 15.68,
-  "changePercent": 3.0,
-  "trend": "UP" | "DOWN" | "NEUTRAL",
-  "suggestion": "BUY" | "HOLD" | "SELL",
-  "confidence": 75,
-  "reason": {
-    "technical": "技术面原因",
-    "fundamental": "基本面原因",
-    "sentiment": "情绪面原因",
-    "news": ["相关新闻"]
-  }
-}
-```
-
-## 开发指南
-
-### 环境准备
-
-1. **浏览器插件**
-   - 安装 Tampermonkey 扩展
-   - Chrome/Edge/Firefox 均可
-
-2. **后端服务(可选)**
-   ```bash
-   # 安装依赖
-   pip install fastapi efinance httpx pydantic uvicorn
-
-   # 启动服务
-   uvicorn main:app --host localhost --port 8000 --reload
-   ```
-
-3. **LLM API**
-   - DeepSeek API: https://www.deepseek.com/
-   - 获取 API Key 并配置到环境变量
-
-### 开发流程
-
-采用 **AI 辅助开发模式**:
-
-1. **Day 1(4小时)**: 基础脚本 + 数据提取
-2. **Day 2(3小时)**: 后端集成 + 预测展示
-3. **Day 3(3小时)**: UI 美化 + 原因分析展示
-4. **Day 4-5(4小时)**: 测试、优化、发布
-
-AI 代码生成率: 90%
-
-### AI Prompt 技巧
-
-**优秀的 Prompt 示例**:
-```
-你是一个精通 JavaScript 和 Tampermonkey API 的前端专家。
-
-请创建一个油猴脚本的 Content Script,要求:
-1. 匹配 https://quote.eastmoney.com/*
-2. 提取股票代码、名称、当前价格
-3. 调用本地 API http://localhost:8000/predict
-4. 在页面右侧显示预测结果,包括价格、趋势、原因分析
-5. UI 要美观,使用现代 CSS
-6. 包含完整的错误处理
-
-请直接提供可运行的完整代码,不要省略任何部分。
-```
-
-## 关键技术点
-
-### DOM 数据提取
-
-```javascript
-// 股票代码从 URL 提取
-const code = window.location.href.match(/\/(SZ|SH)(\d{6})\.html/)[2];
-
-// 当前价格从 DOM 提取
-const priceEl = document.querySelector('.current-price');
-const price = parseFloat(priceEl?.textContent) || 0;
-```
-
-### API 调用
-
-```javascript
-GM_xmlhttpRequest({
-  method: 'POST',
-  url: 'http://localhost:8000/api/predict',
-  headers: { 'Content-Type': 'application/json' },
-  data: JSON.stringify(stockData),
-  onload: function(response) {
-    const result = JSON.parse(response.responseText);
-    // 处理结果
-  }
-});
-```
-
-### 本地存储
-
-```javascript
-// 保存
-GM_setValue('watchlist', JSON.stringify(list));
-
-// 读取
-const list = JSON.parse(GM_getValue('watchlist', '[]'));
-```
-
-## UI 设计
-
-### 颜色方案
-- 主色调: 渐变蓝紫 `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
-- 上涨: 红色 `#dc3545`
-- 下跌: 绿色 `#28a745`
-- 中性: 灰色 `#6c757d`
-
-### 布局
-- 固定在页面右侧
-- 宽度: 360px
-- 最大高度: 80vh
-- 渐入动画
-
-### 组件
-- 价格卡片: 当前价格 + 预测价格 + 置信区间
-- 原因分析: 技术面 + 基本面 + 情绪面
-- 投资建议: 建议类型 + 置信度 + 预测周期
-
-## 安全考虑
-
-### XSS 防护
-```javascript
-function sanitizeHTML(str) {
-  const div = document.createElement('div');
-  div.textContent = str;
-  return div.innerHTML;
-}
-```
-
-### API Key 管理
-- 不要硬编码 API Key
-- 使用 localStorage 存储用户提供的 Key
-- 提供设置界面供用户输入
-
-### 数据验证
-```javascript
-// A 股代码验证
-function validateStockCode(code) {
-  return /^\d{6}$/.test(code);
-}
-
-// 价格验证
-function validatePrice(price) {
-  return !isNaN(price) && price > 0;
-}
-```
-
-## 免责声明
-
-⚠️ **重要提示**:
-
-1. 本工具提供的预测仅供参考,不构成任何投资建议
-2. 股市有风险,投资需谨慎
-3. AI 预测并非 100% 准确,请理性对待
-4. 任何投资决策请基于自己的判断
-5. 使用本工具即表示您同意自行承担投资风险
-
-开发团队不对任何投资损失负责。
-
-## 扩展路线
-
-### 短期(1-2个月)
-- 增加更多数据源
-- 优化 Prompt 工程
-- 增加历史准确率统计
-- 支持自定义主题
-
-### 中期(3-6个月)
-- 增加新闻情感分析
-- 增加板块分析
-- 支持自选股批量分析
-- 开发移动端版本
-
-### 长期(6-12个月)
-- 升级为 Chrome 插件
-- 开发独立 Web 应用
-- 支持多市场(港股、美股)
-- 增加自动交易接口
-
-## 参考资源
-
-### 数据源
-- [efinance](https://github.com/efinance-data/efinance) - 专门针对东方财富的 Python 库
-- [AKShare](https://github.com/akfamily/akshare) - 开源财经数据接口库
-- [Tushare](https://tushare.org/) - 财经数据接口包
-
-### AI/LLM
-- [DeepSeek](https://www.deepseek.com/) - 高性价比中文大模型(推荐)
-- [OpenAI API](https://platform.openai.com/) - GPT-4 API
-- [文心一言](https://yiyan.baidu.com/) - 百度大模型
-
-### 开发工具
-- [Tampermonkey](https://www.tampermonkey.net/) - 油猴脚本管理器
-- [CRXJS](https://github.com/crxjs/chrome-extension-tools) - Chrome 插件开发框架
-
-### 参考项目
-- [chocolate](https://github.com/YYJeffrey/chocolate) - 股票基金助手插件
-- [Qbot](https://github.com/UFund-Me/Qbot) - AI 量化投研平台
-
-## 常见问题
-
-**Q: 油猴脚本和 Chrome 插件有什么区别?**
-- 油猴脚本更轻量,单文件,易于分享
-- Chrome 插件功能更强大,可以打包分发
-- 对于 MVP,油猴脚本更快;对于正式产品,Chrome 插件更好
-
-**Q: LLM API 调用成本大概是多少?**
-- DeepSeek: 约 0.14 元/1M tokens(很便宜)
-- GPT-4: 约 18 元/1M tokens(较贵)
-- 预估:每天预测 100 次,月成本 50-200 元
-
-**Q: 如何提高预测准确率?**
-- 结合技术面、基本面、情绪面综合分析
-- 持续优化 Prompt 工程
-- 收集反馈,迭代改进
-
-**Q: 可以商用吗?**
-- 数据来源:免费 API 需注明来源,不能转售
-- 预测建议:必须声明仅供参考,不构成投资建议
-- 建议添加免责声明,降低法律风险
Index: docs/设计文档/油猴脚本方案架构设计_v1.0.md
===================================================================
diff --git a/docs/设计文档/油猴脚本方案架构设计_v1.0.md b/docs/设计文档/油猴脚本方案架构设计_v1.0.md
deleted file mode 100644
--- a/docs/设计文档/油猴脚本方案架构设计_v1.0.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,2125 +0,0 @@
-# 股票AI预测工具 - 油猴脚本方案架构设计
-
----
-
-## 📚 文档信息
-
-| 项目 | 内容 |
-|------|------|
-| **文档名称** | 油猴脚本方案架构设计 |
-| **当前版本** | v1.0 |
-| **创建日期** | 2026-01-28 |
-| **最后更新** | 2026-01-28 |
-| **作者** | AI辅助开发 |
-| **状态** | ✅ 最终版 |
-| **方案类型** | 油猴脚本（Tampermonkey Userscript） |
-
----
-
-## 📝 版本历史
-
-| 版本 | 日期 | 变更内容 | 变更原因 |
-|-----|------|---------|---------|
-| v1.0 | 2026-01-28 | 初始版本创建 | 基于技术方案对比v2.0，设计油猴脚本详细架构 |
-
----
-
-## 目录
-
-1. [架构概述](#1-架构概述)
-2. [系统架构设计](#2-系统架构设计)
-3. [模块详细设计](#3-模块详细设计)
-4. [数据流设计](#4-数据流设计)
-5. [LLM集成架构](#5-llm集成架构)
-6. [UI/UX设计](#6-uiux设计)
-7. [技术架构](#7-技术架构)
-8. [部署架构](#8-部署架构)
-9. [安全架构](#9-安全架构)
-10. [扩展架构](#10-扩展架构)
-
----
-
-## 1. 架构概述
-
-### 1.1 方案定位
-
-**油猴脚本方案**是最轻量、最快速的实现方式：
-- **开发周期**：3-5天（AI辅助）
-- **代码规模**：<500行JavaScript（可选Python后端）
-- **部署方式**：单文件脚本，一键安装
-- **目标用户**：个人使用或小范围分享
-
-### 1.2 核心特点
-
-```
-轻量级 + 高效率 + AI驱动
-```
-
-| 特点 | 说明 |
-|-----|------|
-| 🚀 **极简架构** | 前端脚本 + 可选后端，无中间层 |
-| ⚡ **秒级启动** | 打开页面即运行，无需加载 |
-| 🤖 **AI优先** | 90%代码由AI生成 |
-| 💰 **零成本** | 完全免费（可选LLM API 50-200元/月） |
-| 🔄 **易更新** | 修改即生效，无需重装 |
-
-### 1.3 架构原则
-
-1. **KISS原则**（Keep It Simple, Stupid）：最简实现
-2. **YAGNI原则**（You Aren't Gonna Need It）：不做过度设计
-3. **渐进增强**：核心功能优先，可选功能后置
-4. **AI驱动**：充分利用AI生成代码
-
----
-
-## 2. 系统架构设计
-
-### 2.1 整体架构图
-
-```
-┌─────────────────────────────────────────────────────────┐
-│                    用户浏览器层                          │
-├─────────────────────────────────────────────────────────┤
-│                                                          │
-│  ┌─────────────────────────────────────────────────┐   │
-│  │   Tampermonkey 油猴插件管理器                   │   │
-│  │                                                 │   │
-│  │  ┌───────────────────────────────────────────┐ │   │
-│  │  │  油猴脚本（stock-ai-predictor.user.js）    │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 1. 页面检测与注入模块               │  │ │   │
-│  │  │  │    - 匹配URL                        │  │ │   │
-│  │  │  │    - DOM监听                        │  │ │   │
-│  │  │  │    - 延迟加载                        │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 2. 数据提取模块                     │  │ │   │
-│  │  │  │    - 股票代码                       │  │ │   │
-│  │  │  │    - 实时价格                       │  │ │   │
-│  │  │  │    - K线数据                        │  │ │   │
-│  │  │  │    - 技术指标                       │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 3. UI渲染模块                       │  │ │   │
-│  │  │  │    - 预测面板                       │  │ │   │
-│  │  │  │    - 悬浮按钮                       │  │ │   │
-│  │  │  │    - 加载动画                       │  │ │   │
-│  │  │  │    - 错误提示                       │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 4. API调用模块                      │  │ │   │
-│  │  │  │    - GM_xmlhttpRequest              │  │ │   │
-│  │  │  │    - CORS处理                       │  │ │   │
-│  │  │  │    - 超时重试                       │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 5. 本地存储模块                     │  │ │   │
-│  │  │  │    - GM_setValue/GM_getValue        │  │ │   │
-│  │  │  │    - 自选股管理                     │  │ │   │
-│  │  │  │    - 配置持久化                     │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  │  ┌─────────────────────────────────────┐  │ │   │
-│  │  │  │ 6. 工具函数模块                     │  │ │   │
-│  │  │  │    - 数据格式化                     │  │ │   │
-│  │  │  │    - 日期时间                       │  │ │   │
-│  │  │  │    - 字符串处理                     │  │ │   │
-│  │  │  └─────────────────────────────────────┘  │ │   │
-│  │  │                                           │ │   │
-│  │  └───────────────────────────────────────────┘ │   │
-│  └─────────────────────────────────────────────────┘   │
-│                                                      │
-└──────────────────────────────────────────────────────┘
-                          ↕ HTTP/WebSocket
-┌─────────────────────────────────────────────────────────┐
-│                   后端服务层（可选）                     │
-├─────────────────────────────────────────────────────────┤
-│                                                          │
-│  ┌─────────────────────────────────────────────────┐   │
-│  │  本地Python服务（FastAPI）                      │   │
-│  │                                                  │   │
-│  │  ├── RESTful API                                │   │
-│  │  │   ├── POST /api/predict                      │   │
-│  │  │   ├── GET  /api/stock/{code}/info            │   │
-│  │  │   └── GET  /api/stock/{code}/history         │   │
-│  │  │                                              │   │
-│  │  ├── 数据获取服务                                │   │
-│  │  │   └── efinance / AKShare                     │   │
-│  │  │                                              │   │
-│  │  ├── LLM集成服务                                 │   │
-│  │  │   ├── DeepSeek API                           │   │
-│  │  │   ├── GPT-4 API                              │   │
-│  │  │   └── Prompt工程                             │   │
-│  │  │                                              │   │
-│  │  └── 缓存服务                                    │   │
-│  │      └── 内存缓存 / 文件缓存                     │   │
-│  └─────────────────────────────────────────────────┘   │
-│                                                      │
-└──────────────────────────────────────────────────────┘
-                          ↕ HTTPS
-┌─────────────────────────────────────────────────────────┐
-│                      外部服务层                          │
-├─────────────────────────────────────────────────────────┤
-│                                                          │
-│  ┌─────────────┐  ┌──────────────┐  ┌──────────────┐  │
-│  │ 东方财富API │  │ LLM API服务  │  │（可选）数据  │  │
-│  │             │  │              │  │   备份源     │  │
-│  │ - 实时行情  │  │ - DeepSeek   │  │ - AKShare    │  │
-│  │ - K线数据   │  │ - GPT-4      │  │ - Tushare    │  │
-│  │ - 财务数据  │  │ - 文心一言   │  │              │  │
-│  └─────────────┘  └──────────────┘  └──────────────┘  │
-│                                                      │
-└──────────────────────────────────────────────────────┘
-```
-
-### 2.2 部署模式
-
-#### 模式1：纯前端模式（推荐 MVP）
-
-```
-浏览器 + 油猴脚本 → 直接调用公开API
-```
-
-**优势**：
-- ✅ 无需后端，开箱即用
-- ✅ 完全免费，零维护
-- ✅ 单文件分发
-
-**限制**：
-- ⚠️ 无法获取历史数据（API限制）
-- ⚠️ LLM调用可能受限（CORS）
-
-#### 模式2：混合模式（推荐生产）
-
-```
-浏览器 + 油猴脚本 → 本地Python服务 → LLM API
-```
-
-**优势**：
-- ✅ 功能完整，无限制
-- ✅ 数据可缓存
-- ✅ 支持批量分析
-
-**要求**：
-- 需要本地运行Python服务
-
-### 2.3 技术栈
-
-#### 前端（油猴脚本）
-
-| 技术 | 版本 | 用途 |
-|-----|------|------|
-| JavaScript | ES6+ | 主要开发语言 |
-| Tampermonkey API | latest | 脚本管理API |
-| DOM API | HTML5 | 页面操作 |
-| CSS3 | latest | 样式设计 |
-| Fetch API | latest | HTTP请求 |
-
-#### 后端（可选）
-
-| 技术 | 版本 | 用途 |
-|-----|------|------|
-| Python | 3.11+ | 开发语言 |
-| FastAPI | 0.100+ | Web框架 |
-| efinance | latest | 数据获取 |
-| httpx | latest | 异步HTTP |
-| pydantic | latest | 数据验证 |
-
-#### LLM服务
-
-| 服务 | 定价 | 推荐度 |
-|-----|------|--------|
-| DeepSeek | ¥0.14/1M tokens | ⭐⭐⭐⭐⭐ |
-| GPT-4 | ¥18/1M tokens | ⭐⭐⭐⭐ |
-| 文心一言 | ¥0.012/1K tokens | ⭐⭐⭐ |
-
----
-
-## 3. 模块详细设计
-
-### 3.1 模块1：页面检测与注入
-
-#### 功能职责
-
-- 监听页面加载事件
-- 检测当前URL是否匹配目标网站
-- 触发脚本主逻辑
-
-#### 代码结构
-
-```javascript
-// ==UserScript==
-// @name         东方财富AI预测助手
-// @namespace    http://tampermonkey.net/
-// @version      1.0.0
-// @description  AI驱动的股票走势预测和原因分析
-// @author       AI Generated
-// @match        https://quote.eastmoney.com/*
-// @match        https://emweb.eastmoney.com/*
-// @grant        GM_xmlhttpRequest
-// @grant        GM_setValue
-// @grant        GM_getValue
-// @grant        GM_addStyle
-// @connect      localhost
-// @connect      api.deepseek.com
-// @connect      api.openai.com
-// @run-at       document-idle
-// ==/UserScript==
-
-(function() {
-    'use strict';
-
-    // 主入口
-    function main() {
-        // 等待页面完全加载
-        if (document.readyState === 'loading') {
-            document.addEventListener('DOMContentLoaded', init);
-        } else {
-            init();
-        }
-    }
-
-    // 初始化
-    function init() {
-        console.log('[AI Predictor] 脚本已加载');
-
-        // 检测页面类型
-        const pageType = detectPageType();
-
-        // 根据页面类型执行不同逻辑
-        switch (pageType) {
-            case 'stock_detail':
-                handleStockDetailPage();
-                break;
-            case 'stock_list':
-                handleStockListPage();
-                break;
-            default:
-                console.log('[AI Predictor] 未匹配的页面类型');
-        }
-    }
-
-    // 检测页面类型
-    function detectPageType() {
-        const url = window.location.href;
-
-        if (/quote\.eastmoney\.com\/.*\/\.html/.test(url)) {
-            return 'stock_detail';
-        } else if (/quote\.eastmoney\.com\/center\/gridlist\.html/.test(url)) {
-            return 'stock_list';
-        }
-
-        return 'unknown';
-    }
-
-    // 启动
-    main();
-})();
-```
-
-#### 技术要点
-
-1. **@run-at 时机选择**
-   - `document-start`：最早注入，但DOM未就绪
-   - `document-end`：DOM就绪，资源可能未加载
-   - `document-idle`：完全加载（推荐）
-
-2. **URL匹配模式**
-   ```javascript
-   // 精确匹配
-   @match https://quote.eastmoney.com/SZ000001.html
-
-   // 通配符匹配
-   @match https://quote.eastmoney.com/*
-
-   // 正则匹配（使用@include）
-   // @include /^https:\/\/quote\.eastmoney\.com\/.*\.html$/
-   ```
-
-3. **权限声明**
-   ```javascript
-   // 允许跨域请求
-   @grant        GM_xmlhttpRequest
-
-   // 允许本地存储
-   @grant        GM_setValue
-   @grant        GM_getValue
-
-   // 允许注入样式
-   @grant        GM_addStyle
-
-   // 允许连接到指定域名
-   @connect      localhost
-   @connect      api.deepseek.com
-   ```
-
-### 3.2 模块2：数据提取
-
-#### 功能职责
-
-从东方财富页面提取股票数据
-
-#### 数据模型
-
-```javascript
-// 提取的数据结构
-const StockData = {
-    // 基础信息
-    code: '000001',           // 股票代码
-    name: '平安银行',          // 股票名称
-    market: 'SZ',             // 市场（SZ/SH）
-
-    // 实时行情
-    currentPrice: 15.23,      // 当前价
-    openPrice: 15.10,         // 今开
-    closePrice: 15.05,        // 昨收
-    highPrice: 15.30,         // 最高
-    lowPrice: 15.00,          // 最低
-    volume: 1234567,          // 成交量（手）
-    amount: 1234567890,       // 成交额（元）
-
-    // 涨跌信息
-    change: 0.18,             // 涨跌额
-    changePercent: 1.19,      // 涨跌幅%
-
-    // 时间戳
-    timestamp: Date.now(),
-
-    // 扩展数据（可选）
-    klineData: [],            // K线数据
-    technicalIndicators: {},  // 技术指标
-};
-```
-
-#### 提取策略
-
-**策略1：DOM选择器（主要）**
-
-```javascript
-function extractStockDataFromDOM() {
-    try {
-        // 股票代码
-        const code = window.location.href.match(/\/(SZ|SH)(\d{6})\.html/)[2];
-
-        // 股票名称
-        const nameEl = document.querySelector('.stock-name');
-        const name = nameEl?.textContent?.trim() || '';
-
-        // 当前价格
-        const priceEl = document.querySelector('.current-price');
-        const currentPrice = parseFloat(priceEl?.textContent) || 0;
-
-        // 涨跌幅
-        const changeEl = document.querySelector('.price-change');
-        const changePercent = parseFloat(changeEl?.textContent) || 0;
-
-        // 成交量
-        const volumeEl = document.querySelector('.volume');
-        const volume = parseInt(volumeEl?.textContent?.replace(/,/g, '')) || 0;
-
-        return {
-            code,
-            name,
-            currentPrice,
-            changePercent,
-            volume,
-            timestamp: Date.now()
-        };
-    } catch (error) {
-        console.error('[AI Predictor] 数据提取失败:', error);
-        return null;
-    }
-}
-```
-
-**策略2：API调用（备用）**
-
-```javascript
-async function extractStockDataFromAPI(code) {
-    return new Promise((resolve, reject) => {
-        GM_xmlhttpRequest({
-            method: 'GET',
-            url: `https://push2.eastmoney.com/api/qt/stock/get?secid=${code}`,
-            onload: function(response) {
-                try {
-                    const data = JSON.parse(response.responseText);
-                    resolve(parseAPIResponse(data));
-                } catch (error) {
-                    reject(error);
-                }
-            },
-            onerror: reject
-        });
-    });
-}
-```
-
-#### 容错机制
-
-```javascript
-// 智能提取（多策略回退）
-async function smartExtractStockData() {
-    // 策略1：DOM提取（最快）
-    let data = extractStockDataFromDOM();
-
-    if (!data || !data.currentPrice) {
-        console.log('[AI Predictor] DOM提取失败，尝试API');
-
-        // 策略2：API调用
-        const code = extractStockCodeFromURL();
-        data = await extractStockDataFromAPI(code);
-    }
-
-    if (!data) {
-        throw new Error('无法提取股票数据');
-    }
-
-    // 数据验证
-    if (!validateStockData(data)) {
-        throw new Error('股票数据无效');
-    }
-
-    return data;
-}
-
-// 数据验证
-function validateStockData(data) {
-    return (
-        data &&
-        data.code &&
-        data.currentPrice &&
-        data.currentPrice > 0 &&
-        data.timestamp
-    );
-}
-```
-
-### 3.3 模块3：UI渲染
-
-#### UI组件架构
-
-```
-预测面板（PredictionPanel）
-├── 标题栏（Header）
-│   ├── 标题
-│   ├── 关闭按钮
-│   └── 刷新按钮
-├── 内容区（Content）
-│   ├── 价格卡片（PriceCard）
-│   │   ├── 当前价格
-│   │   ├── 预测价格
-│   │   └── 涨跌幅
-│   ├── 原因分析（ReasonAnalysis）⭐核心
-│   │   ├── 技术面
-│   │   ├── 基本面
-│   │   └── 情绪面
-│   └── 投资建议（Suggestion）
-│       ├── 建议类型
-│       ├── 置信度
-│       └── 风险提示
-└── 底部栏（Footer）
-    ├── 更新时间
-    └── 免责声明
-```
-
-#### 完整UI代码
-
-```javascript
-// UI渲染模块
-const UIModule = {
-    // 创建预测面板
-    createPredictionPanel(data) {
-        const panel = document.createElement('div');
-        panel.id = 'ai-prediction-panel';
-        panel.className = 'ai-prediction-panel';
-
-        panel.innerHTML = `
-            <div class="panel-header">
-                <div class="panel-title">
-                    <span class="icon">🤖</span>
-                    <span class="text">AI预测分析</span>
-                    <span class="version">v1.0</span>
-                </div>
-                <div class="panel-controls">
-                    <button class="btn-refresh" title="刷新">🔄</button>
-                    <button class="btn-close" title="关闭">×</button>
-                </div>
-            </div>
-
-            <div class="panel-content">
-                ${this.renderPriceCard(data)}
-                ${this.renderReasonAnalysis(data)}
-                ${this.renderSuggestion(data)}
-            </div>
-
-            <div class="panel-footer">
-                <span class="update-time">更新于：${new Date().toLocaleString()}</span>
-                <span class="disclaimer">⚠️ 仅供参考，不构成投资建议</span>
-            </div>
-        `;
-
-        // 注入样式
-        this.injectStyles();
-
-        // 绑定事件
-        this.bindEvents(panel);
-
-        return panel;
-    },
-
-    // 渲染价格卡片
-    renderPriceCard(data) {
-        const trendClass = data.trend === 'UP' ? 'trend-up' : 'trend-down';
-        const trendIcon = data.trend === 'UP' ? '📈' : '📉';
-
-        return `
-            <div class="price-card">
-                <div class="price-row">
-                    <span class="label">当前价格</span>
-                    <span class="value">¥${data.currentPrice.toFixed(2)}</span>
-                </div>
-                <div class="price-row ${trendClass}">
-                    <span class="label">预测价格</span>
-                    <span class="value">
-                        ${trendIcon} ¥${data.predictPrice.toFixed(2)}
-                        <span class="change">(${data.changePercent > 0 ? '+' : ''}${data.changePercent.toFixed(2)}%)</span>
-                    </span>
-                </div>
-                <div class="price-row">
-                    <span class="label">置信区间</span>
-                    <span class="value range">
-                        ¥${data.lowerBound.toFixed(2)} - ¥${data.upperBound.toFixed(2)}
-                    </span>
-                </div>
-            </div>
-        `;
-    },
-
-    // 渲染原因分析 ⭐核心功能
-    renderReasonAnalysis(data) {
-        return `
-            <div class="reason-analysis">
-                <div class="analysis-title">
-                    <span class="icon">📊</span>
-                    <span class="text">走势原因分析</span>
-                </div>
-
-                <div class="analysis-item">
-                    <div class="item-header">
-                        <span class="badge technical">技术面</span>
-                    </div>
-                    <div class="item-content">
-                        ${data.reason.technical}
-                    </div>
-                </div>
-
-                <div class="analysis-item">
-                    <div class="item-header">
-                        <span class="badge fundamental">基本面</span>
-                    </div>
-                    <div class="item-content">
-                        ${data.reason.fundamental}
-                    </div>
-                </div>
-
-                <div class="analysis-item">
-                    <div class="item-header">
-                        <span class="badge sentiment">情绪面</span>
-                    </div>
-                    <div class="item-content">
-                        ${data.reason.sentiment}
-                    </div>
-                </div>
-
-                ${data.reason.news && data.reason.news.length > 0 ? `
-                    <div class="analysis-item">
-                        <div class="item-header">
-                            <span class="badge news">相关新闻</span>
-                        </div>
-                        <div class="item-content">
-                            <ul class="news-list">
-                                ${data.reason.news.map(news => `
-                                    <li><a href="${news.url}" target="_blank">${news.title}</a></li>
-                                `).join('')}
-                            </ul>
-                        </div>
-                    </div>
-                ` : ''}
-            </div>
-        `;
-    },
-
-    // 渲染投资建议
-    renderSuggestion(data) {
-        const suggestionConfig = {
-            'BUY': { text: '买入', class: 'suggestion-buy', icon: '🟢' },
-            'HOLD': { text: '持有', class: 'suggestion-hold', icon: '🟡' },
-            'SELL': { text: '卖出', class: 'suggestion-sell', icon: '🔴' }
-        };
-
-        const config = suggestionConfig[data.suggestion] || suggestionConfig['HOLD'];
-
-        return `
-            <div class="suggestion-card">
-                <div class="suggestion-header ${config.class}">
-                    <span class="icon">${config.icon}</span>
-                    <span class="text">投资建议：${config.text}</span>
-                </div>
-                <div class="suggestion-details">
-                    <div class="detail-row">
-                        <span class="label">置信度</span>
-                        <div class="confidence-bar">
-                            <div class="confidence-fill" style="width: ${data.confidence}%"></div>
-                            <span class="confidence-text">${data.confidence}%</span>
-                        </div>
-                    </div>
-                    <div class="detail-row">
-                        <span class="label">预测周期</span>
-                        <span class="value">${data.timeframe === '1d' ? '1-3天' : '3-7天'}</span>
-                    </div>
-                </div>
-            </div>
-        `;
-    },
-
-    // 注入样式
-    injectStyles() {
-        if (document.getElementById('ai-predictor-styles')) return;
-
-        const styles = `
-            <style id="ai-predictor-styles">
-                /* 主面板样式 */
-                .ai-prediction-panel {
-                    position: fixed;
-                    top: 100px;
-                    right: 20px;
-                    width: 360px;
-                    max-height: 80vh;
-                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-                    border-radius: 12px;
-                    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
-                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
-                    z-index: 10000;
-                    overflow: hidden;
-                    animation: slideIn 0.3s ease-out;
-                }
-
-                @keyframes slideIn {
-                    from {
-                        transform: translateX(400px);
-                        opacity: 0;
-                    }
-                    to {
-                        transform: translateX(0);
-                        opacity: 1;
-                    }
-                }
-
-                /* 标题栏 */
-                .panel-header {
-                    background: rgba(255,255,255,0.1);
-                    backdrop-filter: blur(10px);
-                    padding: 12px 16px;
-                    display: flex;
-                    justify-content: space-between;
-                    align-items: center;
-                    border-bottom: 1px solid rgba(255,255,255,0.1);
-                }
-
-                .panel-title {
-                    display: flex;
-                    align-items: center;
-                    gap: 8px;
-                    color: white;
-                    font-weight: 600;
-                }
-
-                .panel-controls {
-                    display: flex;
-                    gap: 8px;
-                }
-
-                .panel-controls button {
-                    background: rgba(255,255,255,0.2);
-                    border: none;
-                    width: 28px;
-                    height: 28px;
-                    border-radius: 6px;
-                    cursor: pointer;
-                    font-size: 16px;
-                    transition: all 0.2s;
-                }
-
-                .panel-controls button:hover {
-                    background: rgba(255,255,255,0.3);
-                    transform: scale(1.1);
-                }
-
-                /* 内容区 */
-                .panel-content {
-                    background: white;
-                    padding: 16px;
-                    max-height: calc(80vh - 120px);
-                    overflow-y: auto;
-                }
-
-                /* 价格卡片 */
-                .price-card {
-                    margin-bottom: 16px;
-                    padding: 12px;
-                    background: #f8f9fa;
-                    border-radius: 8px;
-                }
-
-                .price-row {
-                    display: flex;
-                    justify-content: space-between;
-                    align-items: center;
-                    padding: 8px 0;
-                }
-
-                .price-row .label {
-                    color: #6c757d;
-                    font-size: 14px;
-                }
-
-                .price-row .value {
-                    font-weight: 600;
-                    font-size: 16px;
-                }
-
-                .trend-up .value {
-                    color: #dc3545;
-                }
-
-                .trend-down .value {
-                    color: #28a745;
-                }
-
-                /* 原因分析 */
-                .reason-analysis {
-                    margin-bottom: 16px;
-                }
-
-                .analysis-title {
-                    display: flex;
-                    align-items: center;
-                    gap: 6px;
-                    font-weight: 600;
-                    margin-bottom: 12px;
-                    color: #212529;
-                }
-
-                .analysis-item {
-                    margin-bottom: 12px;
-                    padding: 10px;
-                    background: #f8f9fa;
-                    border-radius: 6px;
-                }
-
-                .badge {
-                    display: inline-block;
-                    padding: 2px 8px;
-                    border-radius: 4px;
-                    font-size: 12px;
-                    font-weight: 500;
-                }
-
-                .badge.technical {
-                    background: #e7f3ff;
-                    color: #0066cc;
-                }
-
-                .badge.fundamental {
-                    background: #fff4e6;
-                    color: #ff6600;
-                }
-
-                .badge.sentiment {
-                    background: #e8f5e9;
-                    color: #2e7d32;
-                }
-
-                .badge.news {
-                    background: #f3e5f5;
-                    color: #7b1fa2;
-                }
-
-                .item-content {
-                    margin-top: 8px;
-                    font-size: 13px;
-                    line-height: 1.6;
-                    color: #495057;
-                }
-
-                .news-list {
-                    list-style: none;
-                    padding: 0;
-                    margin: 0;
-                }
-
-                .news-list li {
-                    padding: 6px 0;
-                }
-
-                .news-list a {
-                    color: #0066cc;
-                    text-decoration: none;
-                }
-
-                .news-list a:hover {
-                    text-decoration: underline;
-                }
-
-                /* 投资建议 */
-                .suggestion-card {
-                    background: #f8f9fa;
-                    border-radius: 8px;
-                    padding: 12px;
-                }
-
-                .suggestion-header {
-                    display: flex;
-                    align-items: center;
-                    gap: 8px;
-                    font-weight: 600;
-                    margin-bottom: 12px;
-                    padding: 8px;
-                    border-radius: 6px;
-                }
-
-                .suggestion-buy {
-                    background: #d4edda;
-                    color: #155724;
-                }
-
-                .suggestion-hold {
-                    background: #fff3cd;
-                    color: #856404;
-                }
-
-                .suggestion-sell {
-                    background: #f8d7da;
-                    color: #721c24;
-                }
-
-                .confidence-bar {
-                    display: flex;
-                    align-items: center;
-                    gap: 8px;
-                    flex: 1;
-                }
-
-                .confidence-fill {
-                    height: 8px;
-                    background: linear-gradient(90deg, #ffc107, #28a745);
-                    border-radius: 4px;
-                    transition: width 0.5s ease;
-                }
-
-                /* 底部栏 */
-                .panel-footer {
-                    background: rgba(255,255,255,0.1);
-                    backdrop-filter: blur(10px);
-                    padding: 10px 16px;
-                    display: flex;
-                    justify-content: space-between;
-                    align-items: center;
-                    font-size: 11px;
-                    color: rgba(255,255,255,0.8);
-                }
-
-                /* 滚动条美化 */
-                .panel-content::-webkit-scrollbar {
-                    width: 6px;
-                }
-
-                .panel-content::-webkit-scrollbar-track {
-                    background: #f1f1f1;
-                    border-radius: 3px;
-                }
-
-                .panel-content::-webkit-scrollbar-thumb {
-                    background: #888;
-                    border-radius: 3px;
-                }
-
-                .panel-content::-webkit-scrollbar-thumb:hover {
-                    background: #555;
-                }
-
-                /* 加载动画 */
-                .loading-spinner {
-                    border: 3px solid #f3f3f3;
-                    border-top: 3px solid #667eea;
-                    border-radius: 50%;
-                    width: 30px;
-                    height: 30px;
-                    animation: spin 1s linear infinite;
-                    margin: 20px auto;
-                }
-
-                @keyframes spin {
-                    0% { transform: rotate(0deg); }
-                    100% { transform: rotate(360deg); }
-                }
-            </style>
-        `;
-
-        document.head.insertAdjacentHTML('beforeend', styles);
-    },
-
-    // 绑定事件
-    bindEvents(panel) {
-        // 关闭按钮
-        const closeBtn = panel.querySelector('.btn-close');
-        closeBtn?.addEventListener('click', () => {
-            panel.remove();
-        });
-
-        // 刷新按钮
-        const refreshBtn = panel.querySelector('.btn-refresh');
-        refreshBtn?.addEventListener('click', () => {
-            // 重新加载预测
-            window.dispatchEvent(new CustomEvent('ai-predictor-refresh'));
-        });
-    }
-};
-```
-
-### 3.4 模块4：API调用
-
-#### HTTP客户端封装
-
-```javascript
-// API调用模块
-const APIModule = {
-    // 通用请求方法
-    request(config) {
-        return new Promise((resolve, reject) => {
-            GM_xmlhttpRequest({
-                method: config.method || 'GET',
-                url: config.url,
-                data: config.data ? JSON.stringify(config.data) : undefined,
-                headers: {
-                    'Content-Type': 'application/json',
-                    ...config.headers
-                },
-                timeout: config.timeout || 10000,
-                onload: function(response) {
-                    try {
-                        const data = JSON.parse(response.responseText);
-                        if (response.status >= 200 && response.status < 300) {
-                            resolve(data);
-                        } else {
-                            reject(new Error(`HTTP ${response.status}: ${data.message || '请求失败'}`));
-                        }
-                    } catch (error) {
-                        resolve(response.responseText);
-                    }
-                },
-                onerror: function(error) {
-                    reject(new Error('网络请求失败'));
-                },
-                ontimeout: function() {
-                    reject(new Error('请求超时'));
-                }
-            });
-        });
-    },
-
-    // 调用后端预测API
-    async predict(stockData) {
-        try {
-            const response = await this.request({
-                method: 'POST',
-                url: 'http://localhost:8000/api/predict',
-                data: stockData
-            });
-            return response;
-        } catch (error) {
-            console.error('[AI Predictor] 预测失败:', error);
-            throw error;
-        }
-    },
-
-    // 获取股票历史数据
-    async getHistory(code) {
-        try {
-            const response = await this.request({
-                method: 'GET',
-                url: `http://localhost:8000/api/stock/${code}/history`
-            });
-            return response;
-        } catch (error) {
-            console.error('[AI Predictor] 获取历史数据失败:', error);
-            throw error;
-        }
-    }
-};
-```
-
-### 3.5 模块5：本地存储
-
-#### 存储API封装
-
-```javascript
-// 存储模块
-const StorageModule = {
-    // 保存数据
-    set(key, value) {
-        return new Promise((resolve) => {
-            GM_setValue(key, JSON.stringify(value));
-            resolve();
-        });
-    },
-
-    // 获取数据
-    get(key, defaultValue = null) {
-        return new Promise((resolve) => {
-            const value = GM_getValue(key);
-            resolve(value ? JSON.parse(value) : defaultValue);
-        });
-    },
-
-    // 删除数据
-    remove(key) {
-        return new Promise((resolve) => {
-            GM_deleteValue(key);
-            resolve();
-        });
-    },
-
-    // 自选股管理
-    watchlist: {
-        // 添加自选股
-        async add(stock) {
-            const list = await StorageModule.get('watchlist', []);
-            if (!list.find(item => item.code === stock.code)) {
-                list.push({
-                    ...stock,
-                    addTime: Date.now()
-                });
-                await StorageModule.set('watchlist', list);
-            }
-        },
-
-        // 删除自选股
-        async remove(code) {
-            const list = await StorageModule.get('watchlist', []);
-            const filtered = list.filter(item => item.code !== code);
-            await StorageModule.set('watchlist', filtered);
-        },
-
-        // 获取自选股列表
-        async getAll() {
-            return await StorageModule.get('watchlist', []);
-        }
-    }
-};
-```
-
-### 3.6 模块6：工具函数
-
-```javascript
-// 工具函数模块
-const Utils = {
-    // 格式化数字
-    formatNumber(num, decimals = 2) {
-        if (num === null || num === undefined) return '-';
-        return num.toFixed(decimals);
-    },
-
-    // 格式化百分比
-    formatPercent(num) {
-        if (num === null || num === undefined) return '-';
-        const sign = num >= 0 ? '+' : '';
-        return `${sign}${num.toFixed(2)}%`;
-    },
-
-    // 格式化时间
-    formatTime(timestamp) {
-        return new Date(timestamp).toLocaleString('zh-CN');
-    },
-
-    // 防抖
-    debounce(func, wait) {
-        let timeout;
-        return function executedFunction(...args) {
-            const later = () => {
-                clearTimeout(timeout);
-                func(...args);
-            };
-            clearTimeout(timeout);
-            timeout = setTimeout(later, wait);
-        };
-    },
-
-    // 节流
-    throttle(func, limit) {
-        let inThrottle;
-        return function(...args) {
-            if (!inThrottle) {
-                func.apply(this, args);
-                inThrottle = true;
-                setTimeout(() => inThrottle = false, limit);
-            }
-        };
-    }
-};
-```
-
----
-
-## 4. 数据流设计
-
-### 4.1 数据流图
-
-```
-┌──────────────┐
-│ 用户访问页面 │
-└──────┬───────┘
-       │
-       ▼
-┌──────────────────────┐
-│ 页面检测与注入        │
-│ - 检测URL             │
-│ - 监听DOM变化         │
-└──────┬───────────────┘
-       │
-       ▼
-┌──────────────────────┐
-│ 数据提取              │
-│ - DOM选择器           │
-│ - API调用（备用）     │
-└──────┬───────────────┘
-       │
-       ├──────────────────────┐
-       │                      │
-       ▼                      ▼
-┌──────────────────┐   ┌──────────────────┐
-│ 直接调用LLM API  │   │ 调用本地后端     │
-│ (纯前端模式)     │   │ (混合模式)       │
-└──────┬───────────┘   └──────┬───────────┘
-       │                      │
-       │                      ▼
-       │              ┌──────────────────┐
-       │              │ 后端服务          │
-       │              │ - 数据增强        │
-       │              │ - LLM调用         │
-       │              │ - 结果缓存        │
-       │              └──────┬───────────┘
-       │                      │
-       └──────────┬───────────┘
-                  │
-                  ▼
-        ┌─────────────────┐
-        │ 结果解析         │
-        │ - JSON解析       │
-        │ - 数据验证       │
-        └────────┬────────┘
-                 │
-                 ▼
-        ┌─────────────────┐
-        │ UI渲染           │
-        │ - 创建面板       │
-        │ - 显示预测       │
-        │ - 展示原因       │
-        └─────────────────┘
-```
-
-### 4.2 时序图
-
-```mermaid
-sequenceDiagram
-    participant User as 用户
-    participant Page as 东方财富页面
-    participant Script as 油猴脚本
-    participant API as 后端API（可选）
-    participant LLM as LLM服务
-
-    User->>Page: 访问股票详情页
-    Script->>Script: 页面检测
-    Script->>Page: 提取股票数据
-    Page-->>Script: 返回数据
-
-    alt 纯前端模式
-        Script->>LLM: 直接调用API
-        LLM-->>Script: 返回预测结果
-    else 混合模式
-        Script->>API: POST /api/predict
-        API->>API: 数据增强
-        API->>LLM: 调用预测
-        LLM-->>API: 返回分析
-        API-->>Script: 返回结果
-    end
-
-    Script->>Script: 解析结果
-    Script->>Page: 注入UI面板
-    Page-->>User: 显示预测
-```
-
-### 4.3 错误处理流程
-
-```javascript
-// 错误处理模块
-const ErrorHandler = {
-    // 错误类型
-    ErrorTypes: {
-        EXTRACTION_FAILED: '数据提取失败',
-        API_CALL_FAILED: 'API调用失败',
-        INVALID_DATA: '数据无效',
-        NETWORK_ERROR: '网络错误',
-        TIMEOUT: '请求超时'
-    },
-
-    // 处理错误
-    handle(error, context = {}) {
-        console.error('[AI Predictor Error]', context, error);
-
-        // 用户友好提示
-        const message = this.getUserMessage(error);
-        this.showErrorNotification(message);
-
-        // 错误上报（可选）
-        this.report(error, context);
-    },
-
-    // 获取用户友好的错误信息
-    getUserMessage(error) {
-        const errorMap = {
-            [this.ErrorTypes.EXTRACTION_FAILED]: '无法获取股票数据，请刷新页面重试',
-            [this.ErrorTypes.API_CALL_FAILED]: '预测服务暂时不可用，请稍后重试',
-            [this.ErrorTypes.INVALID_DATA]: '股票数据异常',
-            [this.ErrorTypes.NETWORK_ERROR]: '网络连接失败',
-            [this.ErrorTypes.TIMEOUT]: '请求超时，请稍后重试'
-        };
-
-        return errorMap[error.message] || '发生未知错误';
-    },
-
-    // 显示错误通知
-    showErrorNotification(message) {
-        const notification = document.createElement('div');
-        notification.className = 'ai-error-notification';
-        notification.innerHTML = `
-            <span class="error-icon">⚠️</span>
-            <span class="error-message">${message}</span>
-        `;
-
-        document.body.appendChild(notification);
-
-        // 3秒后自动消失
-        setTimeout(() => {
-            notification.classList.add('fade-out');
-            setTimeout(() => notification.remove(), 300);
-        }, 3000);
-    },
-
-    // 错误上报
-    report(error, context) {
-        // 可以发送到日志服务
-        console.log('[Error Report]', { error, context });
-    }
-};
-```
-
----
-
-## 5. LLM集成架构
-
-### 5.1 LLM调用策略
-
-#### 策略1：直接调用（纯前端）
-
-```javascript
-// 直接调用DeepSeek API
-async function callDeepSeekDirectly(stockData) {
-    const prompt = `
-    你是专业的股票分析师。请分析以下股票：
-
-    股票代码：${stockData.code}
-    股票名称：${stockData.name}
-    当前价格：${stockData.currentPrice}元
-    涨跌幅：${stockData.changePercent}%
-
-    请从以下维度分析：
-    1. 技术面：技术指标分析
-    2. 基本面：行业和公司分析
-    3. 情绪面：市场情绪分析
-
-    请以JSON格式返回：
-    {
-        "predictPrice": 预测价格,
-        "changePercent": 预测涨跌幅,
-        "trend": "UP"|"DOWN"|"NEUTRAL",
-        "suggestion": "BUY"|"HOLD"|"SELL",
-        "confidence": 置信度0-100,
-        "reason": {
-            "technical": "技术面原因",
-            "fundamental": "基本面原因",
-            "sentiment": "情绪面原因"
-        }
-    }
-    `;
-
-    try {
-        const response = await APIModule.request({
-            method: 'POST',
-            url: 'https://api.deepseek.com/v1/chat/completions',
-            headers: {
-                'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
-            },
-            data: {
-                model: 'deepseek-chat',
-                messages: [
-                    { role: 'system', content: '你是专业的股票分析师。' },
-                    { role: 'user', content: prompt }
-                ],
-                temperature: 0.7,
-                max_tokens: 1000
-            }
-        });
-
-        const content = response.choices[0].message.content;
-        return JSON.parse(content);
-    } catch (error) {
-        ErrorHandler.handle(error, { context: 'LLM直接调用' });
-        throw error;
-    }
-}
-```
-
-#### 策略2：通过后端调用（推荐）
-
-```javascript
-// 通过后端调用LLM
-async function callDeepSeekViaBackend(stockData) {
-    try {
-        const response = await APIModule.request({
-            method: 'POST',
-            url: 'http://localhost:8000/api/predict',
-            data: stockData
-        });
-        return response;
-    } catch (error) {
-        ErrorHandler.handle(error, { context: '后端LLM调用' });
-        throw error;
-    }
-}
-```
-
-### 5.2 Prompt工程
-
-#### System Prompt
-
-```javascript
-const SYSTEM_PROMPT = `
-你是一位专业的股票分析师，拥有10年以上的A股市场分析经验。
-
-你的任务是：
-1. 分析股票的技术面、基本面、情绪面
-2. 预测未来1-3天的价格走势
-3. 给出明确的投资建议（买入/持有/卖出）
-4. 解释预测的原因和依据
-
-分析原则：
-- 客观理性，基于数据和事实
-- 明确不确定性，不夸大预测准确性
-- 风险提示，强调投资有风险
-- 多维度分析，综合考虑各种因素
-
-输出要求：
-- 以JSON格式返回结果
-- 原因分析简洁明了，每条不超过50字
-- 预测价格基于当前价格合理波动范围内
-`;
-```
-
-#### User Prompt模板
-
-```javascript
-function generateUserPrompt(stockData, historyData) {
-    return `
-请分析以下股票：
-
-## 基本信息
-- 股票代码：${stockData.code}
-- 股票名称：${stockData.name}
-- 所属市场：${stockData.market === 'SZ' ? '深圳' : '上海'}
-
-## 实时行情
-- 当前价格：${stockData.currentPrice}元
-- 今开：${stockData.openPrice}元
-- 昨收：${stockData.closePrice}元
-- 最高：${stockData.highPrice}元
-- 最低：${stockData.lowPrice}元
-- 涨跌幅：${stockData.changePercent}%
-- 成交量：${(stockData.volume / 10000).toFixed(2)}万手
-- 成交额：${(stockData.amount / 100000000).toFixed(2)}亿元
-
-## 历史数据（最近5天）
-${historyData.map((day, i) => `
-第${i + 1}天：${day.close}元，涨跌${day.changePercent}%
-`).join('')}
-
-## 技术指标
-- 5日均线：${stockData.indicators?.MA5 || '暂无'}
-- 10日均线：${stockData.indicators?.MA10 || '暂无'}
-- 20日均线：${stockData.indicators?.MA20 || '暂无'}
-- MACD：${stockData.indicators?.MACD || '暂无'}
-- RSI：${stockData.indicators?.RSI || '暂无'}
-
-请以JSON格式返回分析结果。
-`;
-}
-```
-
-### 5.3 响应解析
-
-```javascript
-// LLM响应解析
-function parseLLMResponse(llmResponse) {
-    try {
-        // 尝试直接解析JSON
-        let result = llmResponse;
-
-        // 如果是字符串，尝试提取JSON
-        if (typeof result === 'string') {
-            // 提取JSON部分
-            const jsonMatch = result.match(/\{[\s\S]*\}/);
-            if (jsonMatch) {
-                result = JSON.parse(jsonMatch[0]);
-            } else {
-                throw new Error('无法提取JSON');
-            }
-        }
-
-        // 验证必需字段
-        const requiredFields = [
-            'predictPrice',
-            'changePercent',
-            'trend',
-            'suggestion',
-            'confidence',
-            'reason'
-        ];
-
-        const missingFields = requiredFields.filter(field => !(field in result));
-        if (missingFields.length > 0) {
-            throw new Error(`缺少必需字段：${missingFields.join(', ')}`);
-        }
-
-        // 数据类型转换
-        result.predictPrice = parseFloat(result.predictPrice);
-        result.changePercent = parseFloat(result.changePercent);
-        result.confidence = parseInt(result.confidence);
-
-        // 趋势归一化
-        result.trend = result.trend.toUpperCase();
-        if (!['UP', 'DOWN', 'NEUTRAL'].includes(result.trend)) {
-            result.trend = 'NEUTRAL';
-        }
-
-        // 建议归一化
-        result.suggestion = result.suggestion.toUpperCase();
-        if (!['BUY', 'HOLD', 'SELL'].includes(result.suggestion)) {
-            result.suggestion = 'HOLD';
-        }
-
-        // 计算预测区间
-        const volatility = Math.abs(result.changePercent) * 0.5;
-        result.lowerBound = result.predictPrice * (1 - volatility / 100);
-        result.upperBound = result.predictPrice * (1 + volatility / 100);
-
-        return result;
-    } catch (error) {
-        console.error('[LLM Parser] 解析失败:', error);
-        throw new Error('LLM响应解析失败');
-    }
-}
-```
-
----
-
-## 6. UI/UX设计
-
-### 6.1 设计原则
-
-1. **简洁优先**：信息密度适中，不拥挤
-2. **视觉层次**：重要信息突出显示
-3. **交互反馈**：操作有明确反馈
-4. **响应式**：适配不同屏幕
-
-### 6.2 颜色方案
-
-```css
-/* 主色调 */
---primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-
-/* 语义色 */
---color-up: #dc3545;      /* 上涨（红） */
---color-down: #28a745;    /* 下跌（绿） */
---color-neutral: #6c757d; /* 中性 */
-
-/* 功能色 */
---color-buy: #28a745;     /* 买入 */
---color-hold: #ffc107;    /* 持有 */
---color-sell: #dc3545;    /* 卖出 */
-
-/* 背景色 */
---bg-primary: #ffffff;
---bg-secondary: #f8f9fa;
---bg-tertiary: #e9ecef;
-```
-
-### 6.3 交互设计
-
-#### 加载状态
-
-```javascript
-function showLoading(panel) {
-    const loading = document.createElement('div');
-    loading.className = 'loading-container';
-    loading.innerHTML = `
-        <div class="loading-spinner"></div>
-        <div class="loading-text">AI正在分析中...</div>
-    `;
-    panel.querySelector('.panel-content').innerHTML = '';
-    panel.querySelector('.panel-content').appendChild(loading);
-}
-
-function hideLoading(panel) {
-    const loading = panel.querySelector('.loading-container');
-    if (loading) {
-        loading.remove();
-    }
-}
-```
-
-#### 错误状态
-
-```javascript
-function showError(panel, message) {
-    const errorDiv = document.createElement('div');
-    errorDiv.className = 'error-container';
-    errorDiv.innerHTML = `
-        <div class="error-icon">❌</div>
-        <div class="error-message">${message}</div>
-        <button class="error-retry">重试</button>
-    `;
-
-    panel.querySelector('.panel-content').innerHTML = '';
-    panel.querySelector('.panel-content').appendChild(errorDiv);
-
-    // 绑定重试事件
-    errorDiv.querySelector('.error-retry').addEventListener('click', () => {
-        window.dispatchEvent(new CustomEvent('ai-predictor-refresh'));
-    });
-}
-```
-
-#### 成功状态
-
-```javascript
-function showSuccess(panel, data) {
-    hideLoading(panel);
-
-    const content = panel.querySelector('.panel-content');
-    content.innerHTML = `
-        ${UIModule.renderPriceCard(data)}
-        ${UIModule.renderReasonAnalysis(data)}
-        ${UIModule.renderSuggestion(data)}
-    `;
-
-    // 添加成功动画
-    content.classList.add('success-animation');
-    setTimeout(() => {
-        content.classList.remove('success-animation');
-    }, 500);
-}
-```
-
-### 6.4 响应式设计
-
-```css
-/* 移动端适配 */
-@media (max-width: 768px) {
-    .ai-prediction-panel {
-        width: calc(100vw - 40px) !important;
-        right: 20px !important;
-        left: 20px !important;
-    }
-
-    .price-card,
-    .reason-analysis,
-    .suggestion-card {
-        padding: 10px !important;
-    }
-}
-
-/* 小屏幕适配 */
-@media (max-width: 480px) {
-    .ai-prediction-panel {
-        top: 60px !important;
-        width: calc(100vw - 20px) !important;
-        right: 10px !important;
-        left: 10px !important;
-    }
-
-    .panel-title .text {
-        font-size: 14px !important;
-    }
-}
-```
-
----
-
-## 7. 技术架构
-
-### 7.1 代码组织
-
-```javascript
-// 主文件结构（stock-ai-predictor.user.js）
-// ==UserScript==
-// @name         东方财富AI预测助手
-// ...
-// ==/UserScript==
-
-(function() {
-    'use strict';
-
-    // ==================== 常量配置 ====================
-    const CONFIG = {
-        API_BASE_URL: 'http://localhost:8000',
-        DEFAULT_TIMEOUT: 10000,
-        CACHE_DURATION: 5 * 60 * 1000, // 5分钟
-        VERSION: '1.0.0'
-    };
-
-    // ==================== 工具模块 ====================
-    const Utils = { /* ... */ };
-
-    // ==================== 错误处理 ====================
-    const ErrorHandler = { /* ... */ };
-
-    // ==================== 存储模块 ====================
-    const StorageModule = { /* ... */ };
-
-    // ==================== API模块 ====================
-    const APIModule = { /* ... */ };
-
-    // ==================== UI模块 ====================
-    const UIModule = { /* ... */ };
-
-    // ==================== 业务逻辑 ====================
-    const App = {
-        // 主入口
-        async main() {
-            // 1. 页面检测
-            // 2. 数据提取
-            // 3. AI预测
-            // 4. UI展示
-        }
-    };
-
-    // ==================== 启动 ====================
-    App.main();
-})();
-```
-
-### 7.2 模块通信
-
-```javascript
-// 事件总线
-const EventBus = {
-    events: {},
-
-    on(event, callback) {
-        if (!this.events[event]) {
-            this.events[event] = [];
-        }
-        this.events[event].push(callback);
-    },
-
-    emit(event, data) {
-        if (this.events[event]) {
-            this.events[event].forEach(callback => callback(data));
-        }
-    }
-};
-
-// 使用示例
-EventBus.on('stockDataUpdated', (data) => {
-    console.log('股票数据已更新:', data);
-});
-
-EventBus.emit('stockDataUpdated', stockData);
-```
-
-### 7.3 性能优化
-
-```javascript
-// 缓存管理
-const CacheManager = {
-    cache: new Map(),
-
-    set(key, value, duration = CONFIG.CACHE_DURATION) {
-        this.cache.set(key, {
-            value,
-            expiry: Date.now() + duration
-        });
-    },
-
-    get(key) {
-        const item = this.cache.get(key);
-        if (!item) return null;
-
-        if (Date.now() > item.expiry) {
-            this.cache.delete(key);
-            return null;
-        }
-
-        return item.value;
-    },
-
-    clear() {
-        this.cache.clear();
-    }
-};
-
-// 防抖请求
-const debouncedPredict = Utils.debounce(async (stockData) => {
-    const cacheKey = `predict_${stockData.code}_${stockData.timestamp}`;
-
-    let result = CacheManager.get(cacheKey);
-    if (!result) {
-        result = await APIModule.predict(stockData);
-        CacheManager.set(cacheKey, result);
-    }
-
-    return result;
-}, 1000);
-```
-
----
-
-## 8. 部署架构
-
-### 8.1 部署模式对比
-
-| 部署模式 | 复杂度 | 适用场景 |
-|---------|--------|---------|
-| **单文件部署** | ⭐ | 个人使用、快速分享 |
-| **后端+前端** | ⭐⭐⭐ | 生产环境、功能完整 |
-| **云端部署** | ⭐⭐⭐⭐ | 多用户、商业产品 |
-
-### 8.2 单文件部署（推荐MVP）
-
-#### 步骤
-
-1. **打包脚本**
-   - 将所有代码合并到一个文件
-   - 移除console.log
-   - 压缩代码（可选）
-
-2. **发布方式**
-   - GitHub Releases
-   - GreasyFork
-   - 直接分享文件
-
-3. **用户安装**
-   ```
-   1. 安装Tampermonkey插件
-   2. 点击脚本文件或链接
-   3. 确认安装
-   4. 访问东方财富页面
-   5. 自动显示预测面板
-   ```
-
-### 8.3 后端部署（生产环境）
-
-#### 目录结构
-
-```
-stock-predictor-backend/
-├── app/
-│   ├── main.py              # FastAPI入口
-│   ├── api/
-│   │   └── routes.py        # API路由
-│   ├── services/
-│   │   ├── llm_service.py   # LLM服务
-│   │   └── data_service.py  # 数据服务
-│   └── models/
-│       └── schemas.py       # 数据模型
-├── requirements.txt         # 依赖
-├── .env                     # 配置
-└── README.md               # 说明
-```
-
-#### 启动脚本
-
-```bash
-#!/bin/bash
-# start.sh
-
-echo "启动股票AI预测服务..."
-
-# 激活虚拟环境
-source venv/bin/activate
-
-# 安装依赖
-pip install -r requirements.txt
-
-# 启动服务
-uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
-```
-
----
-
-## 9. 安全架构
-
-### 9.1 安全考虑
-
-#### 前端安全
-
-```javascript
-// XSS防护
-function sanitizeHTML(str) {
-    const div = document.createElement('div');
-    div.textContent = str;
-    return div.innerHTML;
-}
-
-// 使用示例
-const safeHTML = sanitizeHTML(userInput);
-element.innerHTML = safeHTML;
-```
-
-#### API安全
-
-```javascript
-// API Key管理（不要硬编码）
-const API_KEYS = {
-    deepseek: localStorage.getItem('DEEPSEEK_API_KEY') || '',
-    openai: localStorage.getItem('OPENAI_API_KEY') || ''
-};
-
-// 设置界面提供API Key输入
-function showSettings() {
-    const key = prompt('请输入DeepSeek API Key:');
-    if (key) {
-        localStorage.setItem('DEEPSEEK_API_KEY', key);
-    }
-}
-```
-
-#### 数据验证
-
-```javascript
-// 输入验证
-function validateStockCode(code) {
-    // A股代码格式：6位数字
-    return /^\d{6}$/.test(code);
-}
-
-function validatePrice(price) {
-    // 价格必须为正数
-    return !isNaN(price) && price > 0;
-}
-
-// 使用
-if (!validateStockCode(stockData.code)) {
-    throw new Error('无效的股票代码');
-}
-```
-
-### 9.2 隐私保护
-
-```javascript
-// 不收集用户数据
-// 所有数据存储在本地
-// 可选的匿名统计（需用户同意）
-```
-
-### 9.3 免责声明
-
-```javascript
-const DISCLAIMER = `
-⚠️ 重要提示：
-
-1. 本工具提供的预测仅供参考，不构成任何投资建议
-2. 股市有风险，投资需谨慎
-3. AI预测并非100%准确，请理性对待
-4. 任何投资决策请基于自己的判断
-5. 使用本工具即表示您同意自行承担投资风险
-
-开发团队不对任何投资损失负责。
-`;
-```
-
----
-
-## 10. 扩展架构
-
-### 10.1 可扩展点
-
-#### 1. 数据源扩展
-
-```javascript
-// 数据源抽象
-const DataSource = {
-    sources: {
-        eastmoney: { /* ... */ },
-        akshare: { /* ... */ },
-        tushare: { /* ... */ }
-    },
-
-    async getData(code, source = 'eastmoney') {
-        return await this.sources[source].get(code);
-    }
-};
-```
-
-#### 2. LLM扩展
-
-```javascript
-// LLM抽象
-const LLMProvider = {
-    providers: {
-        deepseek: { /* ... */ },
-        openai: { /* ... */ },
-        wenxin: { /* ... */ }
-    },
-
-    async predict(data, provider = 'deepseek') {
-        return await this.providers[provider].predict(data);
-    }
-};
-```
-
-#### 3. UI主题扩展
-
-```javascript
-// 主题系统
-const ThemeManager = {
-    themes: {
-        default: { /* ... */ },
-        dark: { /* ... */ },
-        light: { /* ... */ }
-    },
-
-    setTheme(themeName) {
-        const theme = this.themes[themeName];
-        // 应用主题
-    }
-};
-```
-
-### 10.2 插件化架构
-
-```javascript
-// 插件系统
-const PluginSystem = {
-    plugins: [],
-
-    register(plugin) {
-        this.plugins.push(plugin);
-        plugin.init();
-    },
-
-    unregister(pluginName) {
-        const index = this.plugins.findIndex(p => p.name === pluginName);
-        if (index > -1) {
-            this.plugins[index].destroy();
-            this.plugins.splice(index, 1);
-        }
-    }
-};
-
-// 插件示例
-const NewsPlugin = {
-    name: 'news',
-    init() {
-        console.log('新闻插件已加载');
-    },
-    destroy() {
-        console.log('新闻插件已卸载');
-    }
-};
-
-PluginSystem.register(NewsPlugin);
-```
-
-### 10.3 后期扩展路线图
-
-**短期（1-2个月）**：
-- [ ] 增加更多数据源
-- [ ] 优化Prompt工程
-- [ ] 增加历史准确率统计
-- [ ] 支持自定义主题
-
-**中期（3-6个月）**：
-- [ ] 增加新闻情感分析
-- [ ] 增加板块分析
-- [ ] 支持自选股批量分析
-- [ ] 开发移动端版本
-
-**长期（6-12个月）**：
-- [ ] 升级为Chrome插件
-- [ ] 开发独立Web应用
-- [ ] 支持多市场（港股、美股）
-- [ ] 增加自动交易接口
-
----
-
-## 11. 总结
-
-### 11.1 架构优势
-
-1. **极简设计**：单文件脚本，无依赖
-2. **快速迭代**：修改即生效，无需重新安装
-3. **易于分享**：一个文件即可分发
-4. **AI驱动**：90%代码由AI生成
-5. **成本低廉**：完全免费，可选LLM API
-
-### 11.2 技术亮点
-
-1. **模块化设计**：代码清晰，易于维护
-2. **容错机制**：多层备份，稳定可靠
-3. **性能优化**：缓存、防抖、节流
-4. **UI/UX优秀**：现代化设计，用户体验好
-5. **安全可靠**：输入验证、XSS防护
-
-### 11.3 开发时间线（AI辅助）
-
-| 阶段 | 时间 | AI贡献度 |
-|-----|------|---------|
-| Day 1 | 4小时 | 基础脚本（90%） |
-| Day 2 | 3小时 | 后端集成（85%） |
-| Day 3 | 3小时 | UI优化（80%） |
-| Day 4-5 | 4小时 | 测试发布（60%） |
-| **总计** | **14小时** | **83%** |
-
-### 11.4 后续步骤
-
-1. ✅ 确认架构设计
-2. ✅ 开始AI辅助开发
-3. ✅ 测试与优化
-4. ✅ 发布与分享
-
----
-
-**文档结束**
-
-**相关文档**：
-- [初始需求.md](./初始需求.md)
-- [需求分析与功能点.md](./需求分析与功能点.md)
-- [技术方案对比分析_v2.0.md](./技术方案对比分析_v2.0.md)
-
-**下一步**：开始实施开发，详见 [油猴脚本开发指南](./开发指南_油猴脚本_v1.0.md)（待创建）
Index: docs/设计文档/技术方案对比分析_v2.0.md
===================================================================
diff --git a/docs/设计文档/技术方案对比分析_v2.0.md b/docs/设计文档/技术方案对比分析_v2.0.md
deleted file mode 100644
--- a/docs/设计文档/技术方案对比分析_v2.0.md	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
+++ /dev/null	(revision edc89ae2f9eb6f2bdf6bd9dafc0cf02afd975dbe)
@@ -1,1106 +0,0 @@
-# 股票AI预测工具 - 技术方案全面对比分析
-
----
-
-## 📚 文档信息
-
-| 项目 | 内容 |
-|------|------|
-| **文档名称** | 技术方案对比分析 |
-| **当前版本** | v2.0 |
-| **创建日期** | 2026-01-28 |
-| **最后更新** | 2026-01-28 |
-| **作者** | AI辅助开发 |
-| **状态** | ✅ 最终版 |
-
----
-
-## 📝 版本历史
-
-| 版本 | 日期 | 变更内容 | 变更原因 |
-|-----|------|---------|---------|
-| v1.0 | 2026-01-28 | 初始版本 | 基于初始需求创建独立应用方案 |
-| v1.1 | 2026-01-28 | 新增插件方案 | 用户提出插件先行策略 |
-| v2.0 | 2026-01-28 | 全面升级6种方案+AI辅助分析 | 新需求：使用LLM API、增加原因分析、AI辅助开发 |
-
----
-
-## 目录
-
-1. [初始需求回顾](#1-初始需求回顾)
-2. [方案演化历程](#2-方案演化历程)
-3. [6种技术方案详解](#3-6种技术方案详解)
-4. [AI辅助开发效率分析](#4-ai辅助开发效率分析)
-5. [综合对比矩阵](#5-综合对比矩阵)
-6. [推荐方案与决策树](#6-推荐方案与决策树)
-7. [实施路线图](#7-实施路线图)
-
----
-
-## 1. 初始需求回顾
-
-### 1.1 核心需求
-
-根据[初始需求文档](./初始需求.md)，项目包含四大核心功能：
-
-1. **实时股票信息查看**（A股市场）
-2. **金融市场和国内外大事件提醒**
-3. **根据股票价格和消息，实时预测走势，绘制预测图，给出投资建议**
-4. **自动化决策和投资（长期目标）**
-
-### 1.2 需求演化
-
-| 阶段 | 需求调整 | 影响 |
-|-----|---------|------|
-| **初始** | 完整独立应用 | 开发周期9-12个月 |
-| **第一次调整** | 插件先行，后期扩展 | 开发周期缩短至3-4个月 |
-| **第二次调整** | 使用LLM API而非自训练模型 | 开发周期缩短至2-3个月，成本降低 |
-| **第三次调整** | 增加"股价走势原因分析"功能 | 需要大模型理解能力 |
-| **第四次调整** | 采用AI辅助全流程开发 | 开发周期缩短至3-5天（油猴）或2-3周（插件） |
-
----
-
-## 2. 方案演化历程
-
-```
-初始方案（独立应用）
-    ↓ 性价比分析
-插件方案（Chrome Extension）
-    ↓ 功能优化（LLM API + 原因分析）
-混合方案（插件 + 本地Python + LLM）
-    ↓ 开发模式优化（AI辅助）
-    ├─ 油猴脚本方案（最快：3-5天）
-    ├─ Chrome插件方案（平衡：2-3周）
-    └─ 其他备选方案...
-```
-
-### 2.1 关键决策点
-
-**决策1：插件 vs 独立应用**
-- 理由：开发周期缩短65%（12周→6-8周）
-- 结论：✅ 插件先行
-
-**决策2：自训练模型 vs LLM API**
-- 理由：避免5-8周模型训练时间，降低技术复杂度
-- 结论：✅ 使用DeepSeek/GPT-4 API
-
-**决策3：传统开发 vs AI辅助开发**
-- 理由：开发效率提升3-8倍
-- 结论：✅ 采用AI辅助全流程开发
-
----
-
-## 3. 6种技术方案详解
-
-### 方案对比速览表
-
-| 方案 | 开发周期（AI辅助）| 开发周期（传统）| 难度 | 成本/月 | 推荐度 |
-|-----|-----------------|----------------|------|---------|--------|
-| **1. Chrome插件** | 2-3周 | 6-8周 | ⭐⭐⭐ | 50-200元 | ⭐⭐⭐⭐⭐ |
-| **2. 油猴脚本** | 3-5天 | 2周 | ⭐⭐⭐⭐⭐ | 50-200元 | ⭐⭐⭐⭐⭐ |
-| **3. 浏览器自动化** | 1-1.5周 | 3-4周 | ⭐⭐⭐⭐ | 50-500元 | ⭐⭐⭐⭐ |
-| **4. 屏幕截图OCR** | 1-2周 | 4-5周 | ⭐⭐⭐ | 50-200元 | ⭐⭐⭐ |
-| **5. 独立应用** | 6-10周 | 16-26周 | ⭐⭐ | 50-700元 | ⭐⭐⭐ |
-| **6. 混合代理** | 1.5-2周 | 5周 | ⭐⭐ | 50-200元 | ⭐⭐ |
-
----
-
-### 方案1：Chrome插件方案 ⭐推荐
-
-#### 架构图
-
-```
-┌─────────────────────────────────────┐
-│     Chrome Extension (插件)          │
-│  ├── Content Script                 │
-│  ├── Background Service Worker      │
-│  └── Popup/UI                       │
-└─────────┬───────────────────────────┘
-          ↓ WebSocket
-┌─────────────────────────────────────┐
-│  本地Python服务                      │
-│  ├── FastAPI                        │
-│  ├── LLM API (DeepSeek/OpenAI)      │
-│  └── efinance数据获取                │
-└─────────────────────────────────────┘
-```
-
-#### 技术栈
-
-| 层级 | 技术选型 | 说明 |
-|-----|---------|------|
-| 前端 | React 18 + TypeScript + Vite + CRXJS | 现代化开发体验 |
-| 后端 | Python 3.11+ + FastAPI | 轻量级API框架 |
-| 数据源 | efinance / AKShare | 免费开源 |
-| AI模型 | DeepSeek API / GPT-4 API | 按量付费 |
-| 存储 | Chrome Storage + SQLite | 本地存储 |
-
-#### 核心功能
-
-```typescript
-// AI预测结果接口（v2.0新增原因分析）
-interface PredictionResult {
-  stockCode: string;
-  stockName: string;
-  currentPrice: number;
-  predictPrice: number;
-  changePercent: number;
-  confidence: number;
-
-  // ⭐ v2.0 新增
-  reasonAnalysis: {
-    technical: string;      // 技术面原因
-    fundamental: string;    // 基本面原因
-    sentiment: string;      // 情绪面原因
-    news: string[];         // 相关新闻
-  };
-
-  trend: 'UP' | 'DOWN' | 'NEUTRAL';
-  suggestion: 'BUY' | 'HOLD' | 'SELL';
-  timeframe: '1d' | '3d';
-  timestamp: number;
-}
-```
-
-#### 优势
-
-✅ **开发效率高**：AI辅助2-3周完成
-✅ **用户体验最佳**：集成在浏览器
-✅ **成本极低**：50-200元/月
-✅ **可扩展**：后期可升级为独立应用
-✅ **维护简单**：模块化设计
-
-#### 劣势
-
-❌ 依赖浏览器（必须在Chrome中使用）
-❌ 无法自动交易（只能提供建议）
-❌ 单市场限制（主要依赖东方财富）
-
-#### 开发工作量（AI辅助）
-
-| 阶段 | 时间 | AI加速倍数 |
-|-----|------|-----------|
-| 插件框架 | 2-3天 | 5x |
-| 后端服务 | 2-3天 | 4x |
-| LLM集成 | 2-3天 | 3x |
-| 页面注入 | 1-2天 | 4x |
-| 测试优化 | 2-3天 | 3x |
-| **总计** | **2-3周** | **3-4x** |
-
-#### 适用场景
-
-- ✅ 需要平衡速度和质量
-- ✅ 习惯使用东方财富网页版
-- ✅ 打算长期使用和分享
-- ✅ 后期可能扩展为独立应用
-
----
-
-### 方案2：油猴脚本方案 🚀最快
-
-#### 架构图
-
-```
-┌─────────────────────────────────────┐
-│   浏览器 + Tampermonkey             │
-│  └── 油猴脚本（<500行代码）         │
-│      ├── 页面注入                   │
-│      ├── 数据提取                   │
-│      ├── UI覆盖层                  │
-│      └── API调用                   │
-└─────────┬───────────────────────────┘
-          ↓ (可选)
-┌─────────────────────────────────────┐
-│  本地Python服务（可选）             │
-│  └── LLM API调用                    │
-└─────────────────────────────────────┘
-```
-
-#### 脚本示例（90%代码由AI生成）
-
-```javascript
-// ==UserScript==
-// @name         东方财富AI预测
-// @namespace    http://tampermonkey.net/
-// @version      1.0
-// @description  AI预测股票走势 + 原因分析
-// @author       AI Generated
-// @match        https://quote.eastmoney.com/*
-// @grant        GM_xmlhttpRequest
-// ==/UserScript==
-
-(function() {
-    'use strict';
-
-    // 等待页面加载
-    window.addEventListener('load', () => {
-        // AI生成：提取股票数据
-        const stockData = extractStockData();
-
-        // AI生成：调用后端分析
-        analyzeStock(stockData).then(result => {
-            // AI生成：展示预测结果
-            showPrediction(result);
-        });
-    });
-
-    // AI生成：数据提取函数
-    function extractStockData() {
-        const price = document.querySelector('.price')?.textContent;
-        const code = window.location.href.match(/(\d{6})/)?.[1];
-        const name = document.querySelector('.name')?.textContent;
-        return { code, name, price };
-    }
-
-    // AI生成：调用LLM API
-    async function analyzeStock(data) {
-        const response = await GM_xmlhttpRequest({
-            method: 'POST',
-            url: 'http://localhost:8000/predict',
-            data: JSON.stringify(data),
-            headers: { 'Content-Type': 'application/json' }
-        });
-        return JSON.parse(response.responseText);
-    }
-
-    // AI生成：展示结果（包含原因分析）
-    function showPrediction(data) {
-        const panel = document.createElement('div');
-        panel.style.cssText = `
-            position: fixed;
-            top: 100px;
-            right: 20px;
-            width: 320px;
-            background: white;
-            border: 2px solid #1890ff;
-            border-radius: 8px;
-            padding: 16px;
-            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
-            z-index: 10000;
-        `;
-
-        panel.innerHTML = `
-            <div style="font-size: 16px; font-weight: bold; margin-bottom: 12px;">
-                🤖 AI预测分析
-            </div>
-            <div style="margin-bottom: 8px;">
-                <strong>当前价格：</strong>${data.currentPrice}
-            </div>
-            <div style="margin-bottom: 8px;">
-                <strong>预测价格：</strong>
-                <span style="color: ${data.trend === 'UP' ? 'red' : 'green'}">
-                    ${data.predictPrice} (${data.changePercent}%)
-                </span>
-            </div>
-            <div style="margin-bottom: 8px;">
-                <strong>投资建议：</strong>${data.suggestion}
-            </div>
-            <div style="margin-bottom: 8px;">
-                <strong>趋势分析：</strong>
-                <ul style="margin: 4px 0; padding-left: 20px;">
-                    <li>技术面：${data.reason.technical}</li>
-                    <li>基本面：${data.reason.fundamental}</li>
-                    <li>情绪面：${data.reason.sentiment}</li>
-                </ul>
-            </div>
-            <div style="font-size: 12px; color: #999;">
-                ⚠️ 仅供参考，不构成投资建议
-            </div>
-        `;
-
-        document.body.appendChild(panel);
-
-        // AI生成：添加关闭按钮
-        const closeBtn = document.createElement('button');
-        closeBtn.textContent = '×';
-        closeBtn.style.cssText = `
-            position: absolute;
-            top: 8px;
-            right: 8px;
-            border: none;
-            background: none;
-            font-size: 20px;
-            cursor: pointer;
-        `;
-        closeBtn.onclick = () => panel.remove();
-        panel.appendChild(closeBtn);
-    }
-})();
-```
-
-#### 后端服务（可选，100% AI生成）
-
-```python
-from fastapi import FastAPI
-from pydantic import BaseModel
-import httpx
-
-app = FastAPI()
-
-class StockRequest(BaseModel):
-    code: str
-    name: str
-    price: float
-
-# AI生成：调用DeepSeek API
-async def call_deepseek_api(prompt: str):
-    async with httpx.AsyncClient() as client:
-        response = await client.post(
-            "https://api.deepseek.com/v1/chat/completions",
-            headers={"Authorization": f"Bearer {API_KEY}"},
-            json={
-                "model": "deepseek-chat",
-                "messages": [{"role": "user", "content": prompt}]
-            }
-        )
-        return response.json()
-
-# AI生成：预测分析
-@app.post("/predict")
-async def predict(request: StockRequest):
-    # AI生成的Prompt工程
-    prompt = f"""
-    你是专业的股票分析师。请分析股票{request.name}({request.code})，当前价格{request.price}元。
-
-    请从以下维度分析：
-    1. 技术面：MA、MACD、RSI等指标分析
-    2. 基本面：行业前景、公司基本面
-    3. 情绪面：市场情绪、资金流向
-
-    请给出：
-    - 预测价格（1-3天）
-    - 趋势判断（UP/DOWN/NEUTRAL）
-    - 投资建议（BUY/HOLD/SELL）
-    - 置信度（0-100）
-    - 原因分析（技术面、基本面、情绪面）
-
-    以JSON格式返回。
-    """
-
-    result = await call_deepseek_api(prompt)
-
-    # AI生成：解析LLM返回
-    return parse_llm_response(result)
-
-def parse_llm_response(llm_response):
-    # AI生成：解析和验证返回数据
-    # ...省略解析代码...
-    return {
-        "currentPrice": 15.23,
-        "predictPrice": 15.68,
-        "changePercent": 3.0,
-        "trend": "UP",
-        "suggestion": "BUY",
-        "confidence": 75,
-        "reason": {
-            "technical": "MACD金叉，RSI处于合理区间",
-            "fundamental": "行业景气度提升，公司业绩稳定",
-            "sentiment": "北向资金持续流入，市场情绪偏多"
-        }
-    }
-```
-
-#### 优势
-
-✅ **开发最快**：AI辅助3-5天完成
-✅ **最轻量**：单文件脚本，<500行
-✅ **易于分发**：一个文件即可分享
-✅ **零学习成本**：安装即用
-✅ **更新方便**：修改即时生效
-
-#### 劣势
-
-❌ 功能受限（浏览器沙箱）
-❌ 本地存储有限
-❌ 后台任务困难
-❌ 权限受限
-
-#### 开发时间线（AI辅助）
-
-```
-Day 1 (4小时): AI生成基础脚本 + 数据提取
-Day 2 (3小时): 集成后端API + 预测展示
-Day 3 (3小时): UI美化 + 原因分析展示
-Day 4-5 (4小时): 测试、优化、发布
-```
-
-#### 适用场景
-
-- ✅ 快速验证想法（<1周）
-- ✅ 个人使用或小范围分享
-- ✅ 不需要复杂后台功能
-- ✅ 用户懂技术，能安装油猴
-
----
-
-### 方案3：浏览器自动化方案
-
-#### 架构
-
-```
-┌─────────────────────────────────────┐
-│   Playwright/Selenium 控制器        │
-│  ├── 无头浏览器（Headless）         │
-│  ├── 自动化脚本                     │
-│  ├── DOM数据提取                    │
-│  └── AI预测模块                     │
-└─────────────────────────────────────┘
-```
-
-#### 技术选型
-
-| 指标 | Playwright | Selenium |
-|-----|-----------|----------|
-| 启动速度 | 快（1-2秒） | 慢（3-5秒） |
-| 内存占用 | 200-300MB | 300-500MB |
-| 稳定性 | 高 | 中 |
-| API设计 | 现代、易用 | 传统、复杂 |
-| **推荐** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
-
-#### 代码示例（AI生成）
-
-```python
-from playwright.sync_api import sync_playwright
-
-def analyze_stock(stock_code):
-    with sync_playwright() as p:
-        # 启动无头浏览器
-        browser = p.chromium.launch(headless=True)
-        page = browser.new_page()
-
-        # 访问东方财富
-        page.goto(f'https://quote.eastmoney.com/{stock_code}.html')
-
-        # AI生成：提取数据
-        price = page.locator('.price').text_content()
-        volume = page.locator('.volume').text_content()
-
-        # AI生成：调用LLM分析
-        analysis = call_llm_api(price, volume, stock_code)
-
-        browser.close()
-        return analysis
-
-# 定时执行
-while True:
-    result = analyze_stock('000001')
-    print(result)
-    time.sleep(60)  # 每分钟
-```
-
-#### 优劣势
-
-✅ 数据准确（100%）
-✅ 实时性好（1-2秒）
-✅ 可后台运行
-✅ 绕过反爬虫
-
-❌ 资源消耗大（200-500MB内存）
-❌ 稳定性问题（页面改版失效）
-❌ 维护成本高
-❌ 并发受限
-
-#### 开发周期
-
-- **AI辅助**：1-1.5周
-- **传统**：3-4周
-
----
-
-### 方案4：屏幕截图OCR方案
-
-#### 架构
-
-```
-┌─────────────────────────────────────┐
-│   用户电脑                           │
-│  ├── 东方财富客户端/网页            │
-│  └── Python监控程序                 │
-│      ├── PyAutoGUI截图              │
-│      ├── PaddleOCR识别              │
-│      ├── 数据解析                   │
-│      └── AI预测                     │
-└─────────────────────────────────────┘
-```
-
-#### OCR准确率对比
-
-| 场景 | PaddleOCR | Tesseract |
-|-----|-----------|-----------|
-| 清晰数字 | 99% | 95% |
-| 股票代码 | 98% | 90% |
-| 中文文字 | 97% | 85% |
-| 小字体 | 95% | 80% |
-| 复杂背景 | 92% | 75% |
-
-**结论**：PaddleOCR中文识别效果远优于Tesseract
-
-#### 核心代码（AI生成）
-
-```python
-import pyautogui
-from paddleocr import PaddleOCR
-import numpy as np
-
-# 初始化OCR
-ocr = PaddleOCR(use_angle_cls=True, lang='ch')
-
-def capture_and_analyze():
-    # 1. 截图（AI生成：自动定位股票窗口）
-    screenshot = pyautogui.screenshot(region=(x, y, width, height))
-
-    # 2. OCR识别
-    result = ocr.ocr(np.array(screenshot), cls=True)
-
-    # 3. 提取股票数据
-    stock_data = {
-        'code': extract_value(result, '股票代码'),
-        'price': extract_value(result, '当前价'),
-        'volume': extract_value(result, '成交量')
-    }
-
-    # 4. AI分析
-    analysis = call_llm_api(stock_data)
-
-    return analysis
-
-def extract_value(ocr_result, keyword):
-    # AI生成：从OCR结果中提取特定字段
-    for line in ocr_result:
-        if keyword in line[1][0]:
-            return line[1][0].replace(keyword, '').strip()
-    return None
-```
-
-#### 优劣势
-
-✅ 通用性强（不限特定网站）
-✅ 无需API
-✅ 可离线运行
-
-❌ 准确率问题（90-95%）
-❌ 实时性差（1-3秒延迟）
-❌ 依赖屏幕可见
-❌ 资源消耗大
-❌ 脆弱性（界面变化失效）
-
-#### 开发周期
-
-- **AI辅助**：1-2周
-- **传统**：4-5周
-
----
-
-### 方案5：独立应用方案
-
-#### 架构
-
-```
-┌─────────────────────────────────────┐
-│   桌面应用（Electron/Tauri/PyQt）  │
-│  ├── UI层（原生体验）               │
-│  ├── 业务逻辑层                     │
-│  ├── 数据获取层（多源聚合）          │
-│  ├── AI预测层（LLM API）            │
-│  └── 本地数据库                     │
-└─────────────────────────────────────┘
-```
-
-#### 桌面框架对比
-
-| 框架 | 优势 | 劣势 |
-|-----|------|------|
-| Electron | 跨平台、生态丰富 | 体积大（100MB+） |
-| Tauri | 体积小（<10MB）、性能好 | 生态相对较小 |
-| PyQt | Python原生、快速开发 | UI较丑 |
-| Flutter Desktop | 高性能、现代化 | 学习曲线陡 |
-
-#### 优劣势
-
-✅ 完全独立（不依赖浏览器）
-✅ 功能完整（可自动交易）
-✅ 用户体验最佳（原生体验）
-✅ 多市场支持
-✅ 商业化潜力
-
-❌ 开发周期长（6-10周，AI辅助）
-❌ 维护成本高（跨平台适配）
-❌ 分发复杂（安装包管理）
-❌ 更新麻烦（用户手动更新）
-
-#### 开发周期
-
-- **AI辅助**：6-10周
-- **传统**：16-26周
-
----
-
-### 方案6：混合代理方案（MITM）
-
-#### 架构
-
-```
-┌─────────────────────────────────────┐
-│   用户浏览器                        │
-│      ↕ HTTPS                       │
-┌─────────────────────────────────────┐
-│   本地代理服务器（mitmproxy）       │
-│  ├── 拦截请求                      │
-│  ├── 注入JavaScript                │
-│  ├── 修改响应                      │
-│  └── 数据收集                      │
-└─────────────────────────────────────┘
-```
-
-#### 实现原理（AI生成）
-
-```python
-from mitmproxy import http
-
-def response(flow: http.HTTPFlow) -> None:
-    """拦截响应"""
-    if 'quote.eastmoney.com' in flow.request.pretty_host:
-        # 1. 提取数据
-        data = extract_data(flow.response.text)
-
-        # 2. 调用AI分析
-        analysis = call_llm_api(data)
-
-        # 3. 注入到页面
-        script = f'''
-            <script>
-                window.AI_PREDICTION = {analysis};
-                // AI生成：显示预测结果
-                showPrediction(analysis);
-            </script>
-        '''
-        flow.response.text += script
-```
-
-#### 优劣势
-
-✅ 透明拦截（用户无感知）
-✅ 可处理加密流量（HTTPS）
-✅ 灵活性高（可修改任何请求/响应）
-
-❌ 证书警告（浏览器提示不可信）
-❌ 配置复杂（用户需安装证书）
-❌ 安全风险（拦截所有流量）
-❌ 维护困难（HTTPS更新失效）
-❌ 用户门槛高（普通用户难上手）
-
-#### 开发周期
-
-- **AI辅助**：1.5-2周
-- **传统**：5周
-
----
-
-## 4. AI辅助开发效率分析
-
-### 4.1 AI加速倍数
-
-| 开发任务类型 | 传统开发 | AI辅助开发 | 加速倍数 | AI贡献度 |
-|------------|---------|-----------|---------|---------|
-| 样板代码生成 | 1天 | 1-2小时 | 8-12x | 95% |
-| CRUD业务逻辑 | 3天 | 0.5-1天 | 3-6x | 80% |
-| UI组件开发 | 2天 | 0.5-1天 | 2-4x | 70% |
-| API集成 | 1天 | 2-4小时 | 3-5x | 85% |
-| 调试/错误修复 | 2小时 | 30分钟 | 4x | 60% |
-| 架构设计 | 1天 | 半天 | 2x | 50% |
-| 复杂算法 | 3天 | 1-2天 | 1.5-3x | 40% |
-
-### 4.2 各方案AI辅助周期对比
-
-| 方案 | 传统周期 | AI辅助周期 | 节省时间 | AI贡献度 |
-|-----|---------|-----------|---------|---------|
-| 1. Chrome插件 | 6-8周 | 2-3周 | **4-5周** | 70% |
-| 2. 油猴脚本 ⭐ | 2周 | 3-5天 | **9-11天** | 90% |
-| 3. 浏览器自动化 | 3-4周 | 1-1.5周 | **2-3周** | 75% |
-| 4. 屏幕截图OCR | 4-5周 | 1-2周 | **2-3周** | 70% |
-| 5. 独立应用 | 16-26周 | 6-10周 | **10-16周** | 60% |
-| 6. 混合代理 | 5周 | 1.5-2周 | **3-3.5周** | 70% |
-
-### 4.3 成本对比（AI辅助 vs 传统）
-
-| 方案 | 传统工时 | AI辅助工时 | 节省工时 | 节省比例 |
-|-----|---------|-----------|---------|---------|
-| 油猴脚本 | 80-120小时 | 16-24小时 | 64-96小时 | **75-80%** |
-| Chrome插件 | 240-320小时 | 80-120小时 | 160-200小时 | **67%** |
-| 独立应用 | 640-1040小时 | 240-400小时 | 400-640小时 | **63%** |
-
-### 4.4 AI开发模式关键成功因素
-
-#### 1. Prompt工程能力 ⭐⭐⭐⭐⭐
-
-**优秀Prompt示例**：
-```
-你是一个精通React和TypeScript的前端专家。
-
-请创建一个Chrome Extension的Content Script，要求：
-1. 使用TypeScript编写
-2. 在东方财富股票页面(quote.eastmoney.com)注入
-3. 提取股票代码、名称、当前价格
-4. 调用本地API http://localhost:8000/predict
-5. 在页面右侧显示预测结果，包括价格、趋势、原因分析
-6. UI要美观，使用现代CSS
-7. 包含完整的错误处理
-
-请直接提供可运行的完整代码，不要省略任何部分。
-```
-
-#### 2. 代码审查能力 ⭐⭐⭐⭐
-
-- AI生成的代码需要理解
-- 安全性检查（XSS、注入等）
-- 性能优化
-- 最佳实践遵循
-
-#### 3. 调试能力 ⭐⭐⭐⭐
-
-- 快速定位问题
-- 给AI准确的错误信息
-- 验证AI的修复方案
-
-#### 4. 架构设计能力 ⭐⭐⭐
-
-- 给AI明确的技术方向
-- 模块化设计
-- 可扩展性考虑
-
-### 4.5 AI开发工作流
-
-```
-1. 明确需求 → 2. 编写Prompt → 3. AI生成代码 → 4. 代码审查
-                                              ↓
-                              5. 测试调试 → 6. 迭代优化
-                                              ↓
-                              7. 完成（或返回2）
-```
-
----
-
-## 5. 综合对比矩阵
-
-### 5.1 详细评分表
-
-| 评估维度 | 权重 | Chrome插件 | 油猴脚本 | 浏览器自动化 | 截图OCR | 独立应用 | 混合代理 |
-|---------|------|-----------|---------|-------------|--------|---------|---------|
-| **开发难度**（越高越好） | 20% | 4/5 ⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ | 3/5 ⭐⭐⭐ | 2/5 ⭐⭐ | 2/5 ⭐⭐ |
-| **开发周期**（越短越好） | 20% | 4/5 ⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ | 2/5 ⭐⭐ | 4/5 ⭐⭐⭐⭐ |
-| **维护成本**（越低越好） | 15% | 5/5 ⭐⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 3/5 ⭐⭐⭐ | 2/5 ⭐⭐ | 2/5 ⭐⭐ | 2/5 ⭐⭐ |
-| **用户体验**（越高越好） | 15% | 5/5 ⭐⭐⭐⭐⭐ | 3/5 ⭐⭐⭐ | 3/5 ⭐⭐⭐ | 3/5 ⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 1/5 ⭐ |
-| **数据准确性**（越高越好） | 10% | 5/5 ⭐⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ |
-| **实时性**（越快越好） | 10% | 4/5 ⭐⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ | 3/5 ⭐⭐⭐ | 5/5 ⭐⭐⭐⭐⭐ | 4/5 ⭐⭐⭐⭐ |
-| **扩展性**（越强越好） | 10% | 3/5 ⭐⭐⭐ | 2/5 ⭐⭐ | 3/5 ⭐⭐⭐ | 1/5 ⭐ | 5/5 ⭐⭐⭐⭐⭐ | 3/5 ⭐⭐⭐ |
-| **加权总分** | 100% | **4.23/5** | **4.05/5** | **3.72/5** | **3.10/5** | **3.68/5** | **2.85/5** |
-| **推荐度** | - | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ |
-
-### 5.2 成本对比（首年）
-
-| 方案 | 开发成本 | 运营成本/月 | LLM API | 总成本（首年） | 性价比 |
-|-----|---------|-----------|---------|--------------|--------|
-| 1. Chrome插件 | 0元 | 0元 | 50-200元 | 600-2400元 | ⭐⭐⭐⭐⭐ |
-| 2. 油猴脚本 | 0元 | 0元 | 50-200元 | 600-2400元 | ⭐⭐⭐⭐⭐ |
-| 3. 浏览器自动化 | 0元 | 0-300元 | 50-200元 | 600-7200元 | ⭐⭐⭐⭐ |
-| 4. 截图OCR | 0元 | 0元 | 50-200元 | 600-2400元 | ⭐⭐⭐ |
-| 5. 独立应用 | 0元 | 0元 | 50-200元 | 600-2400元 | ⭐⭐⭐ |
-| 6. 混合代理 | 0元 | 0元 | 50-200元 | 600-2400元 | ⭐⭐⭐ |
-
-### 5.3 技术栈对比
-
-| 方案 | 前端技术 | 后端技术 | 学习曲线 | AI友好度 |
-|-----|---------|---------|---------|---------|
-| Chrome插件 | React+TS | Python+FastAPI | 中等 | 高 |
-| 油猴脚本 | JavaScript | Python（可选） | 较低 | 最高 |
-| 浏览器自动化 | 可选 | Python+Playwright | 较低 | 高 |
-| 截图OCR | 可选 | Python+PaddleOCR | 中等 | 高 |
-| 独立应用 | React/Electron | Python | 较高 | 中等 |
-| 混合代理 | 无 | Python+mitmproxy | 较高 | 中等 |
-
----
-
-## 6. 推荐方案与决策树
-
-### 6.1 最终推荐
-
-#### 🥇 个人开发者 - 快速验证：油猴脚本方案
-
-**推荐理由**：
-- ⚡ 最快：3-5天完成
-- 💰 最省：600-2400元/年
-- 📦 最轻：单文件脚本
-- 🎯 最佳：AI生成率90%+
-
-**适合场景**：
-- 快速验证想法
-- 个人使用或小范围分享
-- 可以容忍功能限制
-
-#### 🥈 正式项目 - 平衡方案：Chrome插件方案
-
-**推荐理由**：
-- ⏱️ 快速：2-3周完成
-- 💰 低成本：600-2400元/年
-- 🎨 体验好：集成在浏览器
-- 🔄 可扩展：后期可升级为独立应用
-
-**适合场景**：
-- 长期使用
-- 打算分享给其他人
-- 需要更好的用户体验
-
-#### 🥉 长期规划：独立应用方案
-
-**推荐理由**：
-- 💪 功能完整（可自动交易）
-- 🚀 商业化潜力
-- 🌍 多市场支持
-- ⭐ 最佳用户体验
-
-**适合场景**：
-- 打算商业化
-- 需要自动交易功能
-- 有充足的开发时间
-
-### 6.2 方案选择决策树
-
-```
-是否需要快速验证（<1周）？
-├─ 是 → 🌟 油猴脚本方案（3-5天）
-└─ 否
-    ├─ 是否需要商业化和自动交易？
-    │   ├─ 是 → 🏢 独立应用方案（6-10周）
-    │   └─ 否
-    │       ├─ 是否习惯使用东方财富网页？
-    │       ├─ 是 → ⭐ Chrome插件方案（2-3周）推荐
-    │       └─ 否
-    │           ├─ 网站是否有反爬/复杂交互？
-    │           ├─ 是 → 🔧 浏览器自动化方案（1-1.5周）
-    │           └─ 否 → 📸 截图OCR方案（1-2周，不推荐）
-```
-
-### 6.3 快速选择表
-
-| 你的情况 | 推荐方案 | 开发周期 |
-|---------|---------|---------|
-| 我想最快验证想法 | 油猴脚本 | 3-5天 |
-| 我需要平衡速度和质量 | Chrome插件 | 2-3周 |
-| 网站有反爬，难以抓取 | 浏览器自动化 | 1-1.5周 |
-| 我打算商业化 | 独立应用 | 6-10周 |
-| 我是技术爱好者，喜欢折腾 | 混合代理 | 1.5-2周 |
-| 其他方案都无法获取数据 | 截图OCR | 1-2周 |
-
----
-
-## 7. 实施路线图
-
-### 7.1 推荐：油猴脚本方案（3-5天）
-
-#### Day 1：基础脚本（4小时）
-
-**任务清单**：
-- [x] AI生成Tampermonkey脚本框架
-- [x] 实现数据提取逻辑
-- [x] 基础UI展示
-- [x] 测试注入功能
-
-**AI Prompt示例**：
-```
-创建一个Tampermonkey油猴脚本：
-1. 匹配 https://quote.eastmoney.com/*
-2. 提取股票代码、名称、当前价格
-3. 在页面右上角显示浮动面板
-4. 包含关闭按钮
-使用原生JavaScript，完整可运行。
-```
-
-#### Day 2：后端集成（3小时）
-
-**任务清单**：
-- [x] AI生成Python FastAPI后端
-- [x] 集成DeepSeek/GPT-4 API
-- [x] 实现数据获取（efinance）
-- [x] 测试API调用
-
-**AI Prompt示例**：
-```
-创建FastAPI后端服务：
-1. POST /predict 接口接收股票数据
-2. 调用DeepSeek API分析
-3. 返回预测结果：价格、趋势、建议、原因分析
-4. 使用efinance获取历史数据
-完整可运行的Python代码。
-```
-
-#### Day 3：UI优化与原因分析（3小时）
-
-**任务清单**：
-- [x] 优化预测面板样式
-- [x] 展示原因分析（技术面、基本面、情绪面）
-- [x] 添加加载状态
-- [x] 错误处理
-
-**AI Prompt示例**：
-```
-优化以下HTML/CSS，使预测面板更美观：
-[现有代码]
-
-要求：
-1. 现代化设计风格
-2. 使用渐变色和阴影
-3. 响应式布局
-4. 颜色搭配专业
-5. 添加动画效果
-```
-
-#### Day 4-5：测试与发布（4小时）
-
-**任务清单**：
-- [x] 功能测试
-- [x] 兼容性测试（Chrome/Firefox/Edge）
-- [x] 性能优化
-- [x] 编写使用文档
-- [x] 打包发布（GitHub/GreasyFork）
-
-### 7.2 推荐：Chrome插件方案（2-3周）
-
-#### Week 1：插件框架（AI辅助2-3天）
-
-- [x] AI生成项目结构（Vite + React + TS）
-- [x] 配置CRXJS构建
-- [x] AI生成基础组件（Popup、Options、Background）
-- [x] 实现自选股管理
-
-**关键AI Prompts**：
-```
-1. "创建Chrome Extension项目结构，使用Vite+React+TS"
-2. "实现自选股管理组件，支持增删改查，使用Chrome Storage API"
-3. "编写manifest.json配置文件，支持东方财富页面注入"
-```
-
-#### Week 2：后端服务（AI辅助2-3天）
-
-- [x] AI生成FastAPI项目
-- [x] 集成efinance数据获取
-- [x] 实现WebSocket服务
-- [x] 集成LLM API
-
-**关键AI Prompts**：
-```
-1. "创建FastAPI项目，实现股票数据获取和WebSocket推送"
-2. "使用efinance获取股票实时行情和历史K线数据"
-3. "集成DeepSeek API，实现股票预测和原因分析"
-```
-
-#### Week 3：集成与优化（AI辅助2-3天）
-
-- [x] 前后端WebSocket集成
-- [x] 东方财富页面注入
-- [x] UI美化
-- [x] 测试与打包
-
----
-
-## 8. 附录
-
-### 8.1 关键技术资源
-
-#### 数据获取
-- [efinance](https://github.com/efinance-data/efinance) - 专门针对东方财富的Python库
-- [AKShare](https://github.com/akfamily/akshare) - 开源财经数据接口库
-- [Tushare](https://tushare.org/) - 财经数据接口包
-
-#### AI/LLM
-- [DeepSeek](https://www.deepseek.com/) - 高性价比中文大模型（推荐）
-- [OpenAI API](https://platform.openai.com/) - GPT-4 API
-- [文心一言](https://yiyan.baidu.com/) - 百度大模型
-
-#### 开发工具
-- [Tampermonkey](https://www.tampermonkey.net/) - 油猴脚本管理器
-- [CRXJS](https://github.com/crxjs/chrome-extension-tools) - Chrome插件开发框架
-- [Playwright](https://playwright.dev/) - 浏览器自动化工具
-- [PaddleOCR](https://github.com/PaddlePaddle/PaddleOCR) - OCR识别库
-
-#### 参考项目
-- [chocolate](https://github.com/YYJeffrey/chocolate) - 股票基金助手插件
-- [Qbot](https://github.com/UFund-Me/Qbot) - AI量化投研平台
-
-### 8.2 常见问题FAQ
-
-**Q1: 油猴脚本和Chrome插件有什么区别？**
-- 油猴脚本更轻量，单文件，易于分享
-- Chrome插件功能更强大，可以打包分发
-- 对于MVP，油猴脚本更快；对于正式产品，Chrome插件更好
-
-**Q2: LLM API调用成本大概是多少？**
-- DeepSeek：约0.14元/1M tokens（很便宜）
-- GPT-4：约18元/1M tokens（较贵）
-- 预估：每天预测100次，月成本50-200元
-
-**Q3: 如何提高预测准确率？**
-- 结合技术面、基本面、情绪面综合分析
-- 持续优化Prompt工程
-- 收集反馈，迭代改进
-
-**Q4: 数据来源会失效吗？**
-- 使用efinance等封装库，会及时更新
-- 建议多数据源备份（efinance + AKShare）
-- 监控API变化，及时适配
-
-**Q5: 可以商用吗？**
-- 数据来源：免费API需注明来源，不能转售
-- 预测建议：必须声明仅供参考，不构成投资建议
-- 建议添加免责声明，降低法律风险
-
-### 8.3 风险提示
-
-⚠️ **法律风险**
-- 必须添加免责声明："预测仅供参考，不构成投资建议"
-- 不能用于商业用途（除非获得数据源授权）
-- 不能承诺收益
-
-⚠️ **技术风险**
-- API可能变更，需要持续维护
-- 模型准确率无法保证
-- 系统稳定性需要测试
-
-⚠️ **市场风险**
-- 股市有风险，投资需谨慎
-- AI预测不是100%准确
-- 建议只作为参考工具
-
----
-
-## 9. 总结
-
-### 9.1 核心建议
-
-1. **个人快速验证**：选择油猴脚本方案，3-5天完成
-2. **正式项目开发**：选择Chrome插件方案，2-3周完成
-3. **长期商业化**：选择独立应用方案，6-10周完成
-
-### 9.2 关键成功因素
-
-1. ✅ **使用AI辅助开发**：开发效率提升3-8倍
-2. ✅ **使用LLM API**：避免模型训练，降低复杂度
-3. ✅ **聚焦核心功能**：不做全功能，快速迭代
-4. ✅ **明确免责声明**：降低法律风险
-5. ✅ **持续优化**：收集反馈，不断改进
-
-### 9.3 下一步行动
-
-1. **确认方案**：根据需求选择合适方案
-2. **准备环境**：安装开发工具
-3. **AI辅助开发**：使用AI工具加速开发
-4. **测试优化**：确保功能稳定
-5. **发布使用**：开始实际使用和收集反馈
-
----
-
-**文档结束**
-
-**相关文档**：
-- [初始需求.md](./初始需求.md) - 项目原始需求
-- [需求分析与功能点.md](./需求分析与功能点.md) - v1.0版本需求分析
-- [实施计划](C:\Users\pc\.claude\plans\snoopy-dancing-chipmunk.md) - 详细实施计划
